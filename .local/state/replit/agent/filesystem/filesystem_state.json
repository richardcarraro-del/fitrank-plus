{"file_contents":{"replit.md":{"content":"# FitRank+ - Fitness Tracking & Gamification App\n\n## Overview\n\nFitRank+ is a React Native mobile application built with Expo that gamifies fitness through workout tracking, AI-generated personalized training programs, and academy-based competitive rankings. The app combines fitness coaching with social competition, allowing users to earn points, maintain streaks, and compete with other members of their gym/academy on monthly leaderboards.\n\nThe application is designed for iOS, Android, and Web platforms, with a focus on dark mode aesthetics and smooth, animated user experiences. It implements a freemium model where free users get 2 AI-generated workouts per week, while premium subscribers ($29.90/month) receive unlimited workout generation.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework & Platform**\n- Built on React Native 0.81.5 with Expo 54\n- Supports iOS, Android, and Web through Expo's cross-platform APIs\n- Uses React 19.1.0 with experimental React Compiler enabled\n- Implements the new React Native architecture (`newArchEnabled: true`)\n\n**Navigation Structure**\n- React Navigation v7 with native-stack and bottom-tabs navigators\n- 5-tab bottom navigation: Home, Workout, Start Workout (FAB), Ranking, Profile\n- Modal-based flows for Onboarding, Login, Profile Setup, and Active Workouts\n- Type-safe navigation with TypeScript parameter lists for each stack\n\n**UI/UX Architecture**\n- Dark-mode-first design with dynamic theming system\n- Animated components using Reanimated 4.1.1 for 60fps interactions\n- Custom spring-based press animations on buttons and cards\n- Glass morphism effects using expo-blur and expo-glass-effect\n- Gradient backgrounds via expo-linear-gradient\n- Three-tier elevation system for cards (backgroundDefault, backgroundSecondary, backgroundTertiary)\n\n**State Management**\n- Context API for global authentication state (AuthProvider/AuthContext)\n- Local component state with React hooks\n- AsyncStorage for persistent data (workouts, user stats, rankings)\n- No external state management libraries (Redux, MobX, etc.)\n\n**Component Architecture**\n- Themed component system (ThemedText, ThemedView) that adapts to light/dark modes\n- Reusable layout components (ScreenScrollView, ScreenKeyboardAwareScrollView, ScreenFlatList)\n- Safe area handling with react-native-safe-area-context\n- Custom hooks for common patterns (useTheme, useAuth, useScreenInsets)\n\n### Authentication & User Flow\n\n**Authentication Strategy**\n- Planned SSO integration with Apple Sign-In (iOS) and Google Sign-In\n- Currently mocked with local AsyncStorage for prototype phase\n- Email/password fallback authentication\n- User session persistence via AsyncStorage\n\n**Onboarding Flow**\n1. Welcome screen with app features and value proposition\n2. Login/Signup with SSO or email\n3. 6-step profile setup wizard (Objetivo → Nível → Dados físicos → Tempo → Frequência → Local/Equipamentos)\n4. Main app interface\n\n**User Profile Data Model**\n- Demographics: name, email, age, weight, height\n- Fitness: goal (muscle/lose_weight/endurance/health), level (beginner/intermediate/advanced)\n- Preferences: timeAvailable, weeklyFrequency, location (home/gym), equipment array\n- Academy affiliation for ranking system\n- Premium subscription status\n\n### Data Layer\n\n**Storage Architecture**\n- AsyncStorage as the primary data persistence layer\n- No backend or database integration in current implementation\n- Structured storage utilities in `utils/storage.ts` with typed interfaces\n- Data models: User, Workout, Exercise, Achievement, UserStats, Academy, RankingUser\n\n**Key Data Structures**\n- Workouts: exercise list, duration, points, calories, completion status\n- Exercises: name, sets, reps, rest intervals, muscle groups\n- User Stats: streaks, total workouts/points, weekly/monthly aggregates\n- Rankings: academy-based leaderboards with position and point totals\n- Achievements: unlockable badges with earning criteria\n\n**Workout Generation Logic**\n- AI-simulated workout generator in `utils/workoutGenerator.ts`\n- Exercise database categorized by user level (beginner/intermediate/advanced) and goal\n- Generates 6-10 exercises based on user profile, time available, and equipment\n- Calculates points based on duration, intensity, and completion\n- Calorie estimation based on exercise type and user metrics\n\n### Business Logic\n\n**Gamification System**\n- Points awarded per completed workout based on duration and intensity\n- Daily streak tracking with visual indicators (flame icon with glow effect for 7+ days)\n- Weekly and monthly point aggregation for rankings\n- Achievement system with unlockable badges\n- Academy-based competitive leaderboards\n\n**Freemium Model**\n- Free tier: 2 AI-generated workouts per week\n- Premium tier: Unlimited workout generation, advanced features\n- Weekly workout generation counter with reset logic\n- Premium upgrade prompts when free limit reached\n\n### Platform-Specific Considerations\n\n**iOS**\n- Tab bar uses BlurView for translucent background\n- Supports edge-to-edge design with safe area handling\n- Apple Sign-In integration (planned)\n\n**Android**\n- Adaptive icons with foreground, background, and monochrome variants\n- Edge-to-edge enabled with gesture navigation support\n- Predictive back gesture disabled for custom navigation control\n- Google Sign-In integration (planned)\n\n**Web**\n- Single-page application output\n- ColorScheme hydration handling to prevent flash of unstyled content\n- Keyboard-aware scroll view falls back to standard ScrollView on web\n- Tab bar uses solid background instead of blur effect\n\n### Code Quality & Tooling\n\n**Development Tools**\n- TypeScript with strict mode for type safety\n- ESLint with Expo config and Prettier integration\n- Babel module resolver for clean `@/` imports\n- Path aliases configured in tsconfig.json\n\n**Error Handling**\n- React Error Boundary component wrapping entire app\n- Custom ErrorFallback component with dev-mode error details modal\n- App restart capability via expo's reloadAppAsync\n\n## Recent Changes\n\n### November 24, 2025 - Google OAuth Stability & Error Handling Improvements\n\n**Supabase Client 406 Error Fix**\n- **Problem:** Supabase client returning 406 (Not Acceptable) errors on profile fetches\n- **Root Cause:** Missing HTTP headers in global Supabase client configuration\n- **Solution:** Added explicit `Accept: application/json` and `Content-Type: application/json` headers to Supabase client global config\n- **Result:** All API calls now work reliably without 406 errors\n- **Files Changed:** `lib/supabase.ts`\n\n**Race Condition Protection for Profile Loading**\n- **Problem:** Concurrent `loadUserProfile` calls during OAuth flow causing duplicate API requests and state conflicts\n- **Root Cause:** Multiple auth state changes triggering simultaneous profile fetch operations\n- **Solution:** Implemented `loadingProfileRef` guard to prevent concurrent profile loading calls\n- **Result:** Profile loading now executes only once per auth state change, eliminating race conditions\n- **Files Changed:** `hooks/useSupabaseAuth.ts`\n\n**Enhanced OAuth Flow Logging**\n- Added comprehensive logging throughout OAuth flow for better debugging\n- Logs cover: LoginScreen initiation, web/mobile platform detection, OAuth URL generation, browser callback handling, profile loading, and navigation decisions\n- Helps diagnose OAuth issues quickly with clear console output\n- **Files Changed:** `screens/LoginScreen.tsx`, `navigation/RootNavigator.tsx`, `hooks/useSupabaseAuth.ts`\n\n**OAuth Flow Validation**\n- Verified complete Google OAuth flow: authentication → automatic profile creation → ProfileSetup redirect → onboarding completion → main app\n- Confirmed expected behavior: After first authorization, Google auto-closes OAuth window (no consent screen on subsequent logins)\n- Tested both web and mobile OAuth paths successfully\n\n### November 24, 2025 - Google OAuth Mobile Implementation\n\n**Google OAuth for Mobile Devices (Expo + Supabase)**\n- **Implemented:** Full Google OAuth flow for iOS/Android using Expo + Supabase with PKCE\n- **Features:**\n  - Deep linking with custom scheme `fitrankplus://auth/callback`\n  - PKCE authorization code flow (primary) with `exchangeCodeForSession()`\n  - Fallback to implicit flow (direct tokens) for compatibility\n  - Automatic profile creation for new Google sign-in users\n  - Proper onboarding navigation after OAuth completion\n- **Technical Details:**\n  - Uses `expo-web-browser` to open OAuth browser session\n  - `expo-linking` for deep link handling and callbacks\n  - `expo-auth-session` for redirect URI generation\n  - Global deep link listener with deduplication guard\n  - Handles both query params and URL fragments (#access_token)\n- **Configuration Required:** User must add redirect URL `fitrankplus://auth/callback` to Supabase Dashboard\n- **Testing:** Requires physical device (Expo Go) or native build for validation\n- **Files Changed:** `hooks/useSupabaseAuth.ts`, `screens/LoginScreen.tsx`\n- **Documentation:** See `GOOGLE_OAUTH_MOBILE_SETUP.md` for complete setup instructions\n\n**Post-Signup Navigation Fix**\n- **Problem:** After successful signup, user stayed on login screen instead of navigating to onboarding (ProfileSetupModal)\n- **Root Cause:** RootNavigator used `initialRouteName` which only applies on first render\n- **Solution:** Refactored RootNavigator to render **completely different Navigator instances** based on auth state\n- **Result:** Signup → 6-step onboarding → main screen flow works correctly\n- **Files Changed:** `navigation/RootNavigator.tsx`\n\n### November 2025 - Supabase Migration & Authentication\n\n**Authentication Gating (RootNavigator)**\n- Implemented user authentication verification in RootNavigator\n- App now shows LoginModal when no user exists, Main after authentication\n- Added loading state during initial user data fetch to prevent flash\n\n**Modal Screen Crashes Fixed**\n- Fixed LoginScreen crash: replaced ScreenKeyboardAwareScrollView with ScrollView + KeyboardAvoidingView + useSafeAreaInsets\n- Fixed ProfileSetupScreen crash: replaced ScreenScrollView with standard ScrollView + safe area insets\n- Both screens now work correctly when shown as modals outside TabNavigator context\n- Root cause: ScreenScrollView and ScreenKeyboardAwareScrollView depend on useBottomTabBarHeight which only works inside TabNavigator\n\n**Workout Generation Improvements**\n- Added default values (weeklyFrequency=3, goal='beginner') to generateWorkout function to prevent crashes on undefined user fields\n- Added same defaults in ProfileScreen update handlers\n- All navigation entry points (HomeScreen, WorkoutScreen, MainTabNavigator FAB) now call generateWorkout before navigating to StartWorkoutModal\n\n**UI/UX Fixes**\n- Replaced invalid \"flame\" icon with \"trending-up\" in HomeScreen streak card\n- Removed all debug console.log statements (kept console.error for production error logging)\n- Verified complete signup → profile setup → main → start workout flow works end-to-end\n\n**Color Palette**\n- Changed app color scheme from orange (#FF6B35) to green (#4CAF50) throughout entire application\n- Updated gradients, buttons, badges, and accent colors to use green tones\n\n## External Dependencies\n\n### Core Framework Dependencies\n- **expo** (^54.0.23) - Primary development platform and build toolchain\n- **react-native** (0.81.5) - Mobile application framework\n- **react** (19.1.0) / **react-dom** (19.1.0) - UI rendering\n\n### Navigation\n- **@react-navigation/native** (^7.1.8) - Navigation state management\n- **@react-navigation/native-stack** (^7.3.16) - Native stack navigator\n- **@react-navigation/bottom-tabs** (^7.4.0) - Bottom tab navigation\n- **react-native-screens** (~4.16.0) - Native screen optimization\n- **react-native-safe-area-context** (~5.6.0) - Safe area handling\n\n### UI & Animation\n- **react-native-reanimated** (~4.1.1) - High-performance animations\n- **react-native-gesture-handler** (~2.28.0) - Native gesture support\n- **expo-linear-gradient** (^15.0.7) - Gradient backgrounds\n- **expo-blur** (~15.0.7) - Blur effects for iOS/Android\n- **expo-glass-effect** (~0.1.6) - Glass morphism effects\n- **expo-haptics** (~15.0.7) - Haptic feedback\n- **@expo/vector-icons** (^15.0.2) - Icon library (includes Feather icons)\n\n### Storage & State\n- **@react-native-async-storage/async-storage** (^2.2.0) - Local data persistence\n- No external state management library (uses React Context)\n\n### Platform APIs\n- **expo-web-browser** (~15.0.9) - In-app browser for OAuth flows\n- **expo-linking** (~8.0.8) - Deep linking support\n- **expo-image** (~3.0.10) - Optimized image component\n- **expo-status-bar** (~3.0.8) - Status bar configuration\n- **expo-splash-screen** (~31.0.10) - Splash screen management\n- **expo-system-ui** (~6.0.8) - System UI controls\n\n### Keyboard & Input\n- **react-native-keyboard-controller** (1.18.5) - Keyboard-aware components\n- **react-native-worklets** (0.5.1) - JavaScript worklet support\n\n### Planned Integrations\n- Apple Sign-In (iOS SSO)\n- Google Sign-In (Android SSO)\n- Backend API for workout generation, rankings sync, and user management (currently mocked with AsyncStorage)\n- Payment processing for premium subscriptions\n- Push notifications for workout reminders and streak maintenance","size_bytes":13332},"design_guidelines.md":{"content":"# FitRank+ Design Guidelines\n\n## Core Architecture\n\n### Authentication\n**Required:** SSO with Apple Sign-In (iOS) and Google Sign-In. Mock in prototype with local state.\n\n**Screens:**\n- Login/Signup: SSO buttons (primary), email/password fallback, privacy/terms links\n- Profile Setup (6 steps post-auth): Objetivo → Nível → Dados físicos → Tempo → Frequência → Local/Equipamentos\n  - Progress indicator (X/6), \"Próximo\"/\"Voltar\" buttons\n- Account: Logout (confirmation), Delete Account (double confirmation), avatar selection\n\n### Navigation\n**5-Tab Structure** with center FAB:\n1. **Home** - Daily overview, streak, points\n2. **Workout** - Generation & history\n3. **Start Workout** (FAB) - Active session\n4. **Ranking** - Academy leaderboards\n5. **Profile** - Settings, achievements, subscription\n\n**Tab Bar:** 65px height, FAB elevated 8px, Portuguese labels\n\n---\n\n## Screen Specifications\n\n### 1. Onboarding (Modal Stack)\n- **Welcome:** Full gradient, logo, \"Treine. Compita. Evolua.\", swipeable feature cards\n- **Profile Setup:** Multi-step form with progress dots, ScrollView, fixed submit button\n\n### 2. Home Tab (Default)\n**Header:** Avatar (left) → Profile, \"FitRank+\" (center), Bell icon (right)\n\n**Content (ScrollView):**\n- Streak Card: Flame icon, \"X dias seguidos\", glow if >7\n- Daily Workout Card: Exercise count, time, difficulty, \"Ver Treino\" button\n- Points Summary: Weekly/monthly points, progress to achievement\n- Quick Stats: Total workouts, points, academy rank (3 columns)\n- Upcoming Achievement preview\n\n### 3. Workout Tab\n**Header:** \"Treinos\" (center), Filter icon (right)\n\n**Content:**\n- Generate Section: Gradient card, \"Gerar Novo Treino\", free limit indicator (X/3), \"Upgrade para Premium\" if locked\n- History: Past workouts list (date, exercises, points, duration) → Detail modal\n\n### 4. Start Workout (Full-Screen Modal)\n**Header:** Close (left, confirms if started), \"Treino em Andamento\" (center), Timer (right)\n\n**Content:**\n- Exercise cards: Name, sets×reps, rest time, checkbox\n- Visual progress (X/Y completed)\n- Fixed \"Finalizar Treino\" button (enabled when all checked)\n- **Completion Modal:** Points breakdown (duration × intensity + exercises × value + streak multiplier), confetti, CTAs\n\n### 5. Ranking Tab\n**Header:** Academy name (center, touchable → selector), Search (right)\n\n**Content:**\n- Period Selector: \"Semana\" | \"Mês\" | \"Geral\"\n- Top 3 Podium: 2nd-1st-3rd layout with medals\n- Leaderboard: Rank #, avatar, name, points (highlight current user)\n- Fixed Position Card (if not top 10): \"Sua Posição: #X\", gap to next\n\n### 6. Profile Tab\n**Header:** \"Perfil\" (center), Settings gear (right)\n\n**Content:**\n- User Header: Avatar (editable), name, age, academy\n- Subscription Card: \"Plano Grátis\" + \"Upgrade\" OR \"Premium\" + renewal date\n- Achievements: 3-column badge grid (color = earned, gray = locked)\n- Stats: Total workouts, points, best streak\n- Settings List: Edit profile, Notificações, Privacidade, Ajuda, Sair (red)\n\n### 7. Modals\n**Workout Detail:** Summary, exercise list, points (if completed), \"Iniciar Este Treino\"\n**Academy Selector:** Search bar, academy list (name, city, members, Join), \"Criar Nova Academia\"\n**Premium Comparison:** Feature table (Grátis vs Premium), \"R$ 29,90/mês\", \"Assinar Agora\"\n\n---\n\n## Design System\n\n### Colors\n**Primary:**\n- Primary: `#00C853` (CTAs, active states)\n- Primary Dark: `#00A844` (pressed)\n- Secondary: `#00E676` (success, secondary actions)\n\n**Neutral:**\n- Background: `#0A0A0A` | Surface: `#161616` | Surface Light: `#202020` | Border: `#2C2C2C`\n\n**Text:**\n- Primary: `#FFFFFF` | Secondary: `#A0A0A0` | Tertiary: `#707070`\n\n**Semantic:**\n- Success: `#00E676` | Warning: `#FFD93D` | Error: `#FF5252` | Premium: `#FFD700`\n\n**Gradients:**\n- Primary: `135deg, #00C853 → #00E676`\n- Dark: `180deg, #0A0A0A → #161616`\n- Premium: `135deg, #FFD700 → #FFA500`\n\n### Typography\n**System Default** (SF Pro iOS / Roboto Android)\n\n| Style | Size | Weight | Line Height | Usage |\n|-------|------|--------|-------------|-------|\n| H1 | 32px | Bold | 40px | Screen titles |\n| H2 | 24px | Bold | 32px | Sections |\n| H3 | 20px | Semibold | 28px | Cards |\n| Body Large | 16px | Regular | 24px | Primary text |\n| Body | 14px | Regular | 20px | Secondary text |\n| Caption | 12px | Medium | 16px | Labels |\n| Button | 16px | Semibold | - | Buttons (0.5px spacing) |\n\n### Spacing\n`xs:4px | sm:8px | md:16px | lg:24px | xl:32px | xxl:48px`\n\n### Components\n\n**Cards:** Surface color, 16px radius, md padding, scale 0.98 on press\n\n**Buttons:**\n- Primary: Gradient bg, white text, 52px height, 26px radius (pill), opacity 0.8 pressed\n- Secondary: Surface Light bg, Primary text, 48px height, 24px radius\n- Text: No bg, Primary text, underline on press\n\n**FAB:** 64px circle, Primary gradient, white icon (28px), shadow (0,2,0.10,2), 8px above tab bar\n\n**Input:** Surface Light bg, 1px Border, 12px radius, 48px height, md padding, Primary border when focused\n\n**Progress:** 6px height, Surface Light bg, Primary gradient fill, 3px radius\n\n**Badges:** 48px circle, gradient bg (by type), white icon (24px), locked = gray 50% opacity\n\n### Visual Feedback\n- Touchables: Scale 0.98 OR opacity 0.8\n- Tabs: 200ms fade\n- Modals: Slide up + fade\n- Selection: 10% Primary overlay\n- Loading: Skeleton with shimmer\n- Haptics: Workout complete, achievements\n\n### Accessibility\n- Min touch target: 44×44px\n- Contrast: 4.5:1 (body), 3:1 (large text)\n- Dynamic font sizes\n- VoiceOver/TalkBack labels\n- Semantic HTML/native controls\n\n### Safe Area Insets\n**Screens with tab bar:**\n- Top: `headerHeight + xl`\n- Bottom: `tabBarHeight + xl` (add 60px if position card on Ranking)\n\n**Modals:**\n- Top: `xl` (non-transparent header) OR `headerHeight + xl` (transparent)\n- Bottom: `insets.bottom + xl`\n\n---\n\n## Critical Assets\n\n**Generate:**\n1. **Avatars (8):** Fitness-themed, diverse body types, vibrant, geometric/minimal, 256×256px transparent\n2. **Badges (10):** 7-day streak (flame), 30 workouts (dumbbell), Top 3 (trophy), First workout (star), 5000 points (medal), 100 workouts (mountain), 30-day (fire), Perfect week (check), Champion (crown), Premium (diamond) — 512×512px gradient backgrounds\n3. **App Icon:** Dumbbell + upward arrow/ranking, Primary gradient, 1024×1024px\n\n**System Icons:** Navigation, actions, UI elements (SF Symbols iOS, Material Android)\n\n### Platform Notes\n- iOS: SF Symbols, HIG navigation\n- Android: Material icons, bottom sheets for modals\n- Tab bar: Respect safe areas\n- Premium: Native subscription UI","size_bytes":6534},"providers/AuthProvider.tsx":{"content":"import React from \"react\";\nimport { AuthContext, useAuthState } from \"@/hooks/useSupabaseAuth\";\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const auth = useAuthState();\n  \n  return <AuthContext.Provider value={auth}>{children}</AuthContext.Provider>;\n}\n","size_bytes":288},"hooks/useColorScheme.web.ts":{"content":"import { useEffect, useState } from \"react\";\nimport { useColorScheme as useRNColorScheme } from \"react-native\";\n\n/**\n * To support static rendering, this value needs to be re-calculated on the client side for web\n */\nexport function useColorScheme() {\n  const [hasHydrated, setHasHydrated] = useState(false);\n\n  useEffect(() => {\n    setHasHydrated(true);\n  }, []);\n\n  const colorScheme = useRNColorScheme();\n\n  if (hasHydrated) {\n    return colorScheme;\n  }\n\n  return \"light\";\n}\n","size_bytes":480},"App.tsx":{"content":"import React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { KeyboardProvider } from \"react-native-keyboard-controller\";\nimport { SafeAreaProvider } from \"react-native-safe-area-context\";\nimport { StatusBar } from \"expo-status-bar\";\n\nimport RootNavigator from \"@/navigation/RootNavigator\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\nimport { AuthProvider } from \"@/providers/AuthProvider\";\n\nexport default function App() {\n  return (\n  <ErrorBoundary>\n    <SafeAreaProvider>\n      <AuthProvider>\n        <GestureHandlerRootView style={styles.root}>\n          <KeyboardProvider>\n            <NavigationContainer>\n              <RootNavigator />\n            </NavigationContainer>\n            <StatusBar style=\"light\" />\n          </KeyboardProvider>\n        </GestureHandlerRootView>\n      </AuthProvider>\n      </SafeAreaProvider>\n  </ErrorBoundary>\n  );\n}\n\nconst styles = StyleSheet.create({\n  root: {\n    flex: 1,\n  },\n});\n","size_bytes":1095},"screens/WorkoutScreen.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { View, StyleSheet, Pressable, Alert } from \"react-native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { storage, Workout } from \"@/utils/storage\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { useNavigation, useFocusEffect } from \"@react-navigation/native\";\nimport type { NavigationProp } from \"@react-navigation/native\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { generateWorkout } from \"@/utils/workoutGenerator\";\nimport type { RootStackParamList } from \"@/navigation/RootNavigator\";\nimport { AdBanner } from \"@/components/AdBanner\";\n\nexport default function WorkoutScreen() {\n  const { user } = useAuth();\n  const navigation = useNavigation<NavigationProp<RootStackParamList>>();\n  const [workouts, setWorkouts] = useState<Workout[]>([]);\n  const [canGenerate, setCanGenerate] = useState(true);\n  const [remaining, setRemaining] = useState(2);\n  const FREE_WEEKLY_LIMIT = 2;\n\n  useFocusEffect(\n    useCallback(() => {\n      let isMounted = true;\n\n      const loadDataSafely = async () => {\n        if (!user?.id) return;\n        \n        const allWorkouts = await storage.getWorkouts(user.id);\n        const limit = await storage.canGenerateWorkout(user?.isPremium || false, user.id);\n\n        if (isMounted) {\n          setWorkouts(allWorkouts);\n          setCanGenerate(limit.canGenerate);\n          setRemaining(limit.remaining);\n        }\n      };\n\n      loadDataSafely();\n\n      return () => {\n        isMounted = false;\n      };\n    }, [user?.id, user?.isPremium])\n  );\n\n  const handleGenerateWorkout = async () => {\n    if (!canGenerate && !user?.isPremium) {\n      Alert.alert(\n        \"Limite Semanal Atingido\",\n        \"Você atingiu o limite de 2 treinos semanais gratuitos. Assine o Premium por R$ 29,90/mês para treinos ilimitados!\",\n        [\n          { text: \"Cancelar\", style: \"cancel\" },\n          { text: \"Ver Premium\", onPress: () => navigation.navigate(\"ProfileTab\" as never) },\n        ]\n      );\n      return;\n    }\n\n    if (!user) {\n      return;\n    }\n\n    const exercises = generateWorkout(user);\n    \n    navigation.navigate(\"StartWorkoutModal\" as never, {\n      exercises,\n      isNewWorkout: true,\n    } as never);\n  };\n\n  return (\n    <ScreenScrollView contentContainerStyle={styles.content}>\n      <View style={styles.generateCard}>\n        <LinearGradient\n          colors={[\"#00C853\", \"#00E676\"]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.generateGradient}\n        >\n          <View style={styles.generateHeader}>\n            <View style={styles.generateIconContainer}>\n              <Feather name=\"plus-circle\" size={32} color={Colors.dark.text} />\n            </View>\n            <View style={styles.generateInfo}>\n              <ThemedText style={styles.generateTitle}>Gerar Novo Treino</ThemedText>\n              {!user?.isPremium ? (\n                <View style={styles.limitBadge}>\n                  <Feather name=\"zap\" size={14} color={Colors.dark.text} />\n                  <ThemedText style={styles.generateLimit}>\n                    {remaining} de {FREE_WEEKLY_LIMIT} restantes\n                  </ThemedText>\n                </View>\n              ) : (\n                <View style={styles.premiumBadge}>\n                  <Feather name=\"award\" size={14} color={Colors.dark.premium} />\n                  <ThemedText style={styles.premiumText}>Ilimitado</ThemedText>\n                </View>\n              )}\n            </View>\n          </View>\n          <Pressable\n            style={({ pressed }) => [\n              styles.generateButton,\n              pressed && styles.buttonPressed,\n              !canGenerate && !user?.isPremium && styles.buttonDisabled,\n            ]}\n            onPress={handleGenerateWorkout}\n            disabled={!canGenerate && !user?.isPremium}\n          >\n            <Feather \n              name={!canGenerate && !user?.isPremium ? \"lock\" : \"play\"} \n              size={18} \n              color={Colors.dark.buttonText} \n              style={{ marginRight: Spacing.sm }} \n            />\n            <ThemedText style={styles.generateButtonText}>\n              {!canGenerate && !user?.isPremium\n                ? \"Upgrade para Premium\"\n                : \"Gerar Treino Personalizado\"}\n            </ThemedText>\n          </Pressable>\n        </LinearGradient>\n      </View>\n\n      <View style={styles.sectionHeader}>\n        <Feather name=\"clock\" size={20} color={Colors.dark.primary} />\n        <ThemedText style={styles.sectionTitle}>Histórico de Treinos</ThemedText>\n      </View>\n\n      {workouts.length === 0 ? (\n        <View style={styles.emptyState}>\n          <View style={styles.emptyIconContainer}>\n            <Feather name=\"activity\" size={40} color={Colors.dark.textTertiary} />\n          </View>\n          <ThemedText style={styles.emptyText}>Nenhum treino realizado ainda</ThemedText>\n          <ThemedText style={styles.emptySubtext}>\n            Gere e complete seu primeiro treino para começar!\n          </ThemedText>\n        </View>\n      ) : (\n        <View style={styles.workoutsList}>\n          {workouts.map((workout) => (\n            <WorkoutCard key={workout.id} workout={workout} />\n          ))}\n        </View>\n      )}\n\n      <AdBanner style={styles.adBanner} />\n    </ScreenScrollView>\n  );\n}\n\nfunction WorkoutCard({ workout }: { workout: Workout }) {\n  const [expanded, setExpanded] = useState(false);\n  const date = new Date(workout.date);\n  const formattedDate = date.toLocaleDateString(\"pt-BR\", {\n    day: \"2-digit\",\n    month: \"short\",\n    year: \"numeric\",\n    weekday: \"short\",\n  });\n\n  return (\n    <Pressable\n      style={styles.workoutCard}\n      onPress={() => setExpanded(!expanded)}\n    >\n      <View style={styles.workoutHeader}>\n        <View style={{ flex: 1 }}>\n          <ThemedText style={styles.workoutDate}>{formattedDate}</ThemedText>\n          <ThemedText style={styles.workoutDetails}>\n            {workout.exercises.length} exercícios • {workout.duration} min • {workout.calories} cal\n          </ThemedText>\n        </View>\n        {workout.completed && (\n          <View style={styles.pointsBadge}>\n            <Feather name=\"zap\" size={16} color={Colors.dark.primary} />\n            <ThemedText style={styles.pointsText}>{workout.points} pts</ThemedText>\n          </View>\n        )}\n      </View>\n      \n      {expanded && (\n        <View style={styles.exercisesExpanded}>\n          <ThemedText style={styles.expandedTitle}>Exercícios:</ThemedText>\n          {workout.exercises.map((exercise, index) => (\n            <View key={exercise.id} style={styles.exerciseItem}>\n              <ThemedText style={styles.exerciseNumber}>{index + 1}.</ThemedText>\n              <View style={{ flex: 1 }}>\n                <ThemedText style={styles.exerciseItemName}>{exercise.name}</ThemedText>\n                <ThemedText style={styles.exerciseItemDetails}>\n                  {exercise.sets} × {exercise.reps} reps • {exercise.rest}s descanso\n                </ThemedText>\n              </View>\n              {exercise.completed && (\n                <Feather name=\"check\" size={16} color={Colors.dark.success} />\n              )}\n            </View>\n          ))}\n        </View>\n      )}\n      \n      <View style={styles.expandIndicator}>\n        <Feather\n          name={expanded ? \"chevron-up\" : \"chevron-down\"}\n          size={20}\n          color={Colors.dark.textSecondary}\n        />\n      </View>\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  generateCard: {\n    marginBottom: Spacing.xl,\n    borderRadius: BorderRadius.lg,\n    overflow: \"hidden\",\n    elevation: 4,\n  },\n  generateGradient: {\n    padding: Spacing.xl,\n  },\n  generateHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.lg,\n    marginBottom: Spacing.lg,\n  },\n  generateIconContainer: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: \"rgba(255, 255, 255, 0.2)\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  generateInfo: {\n    flex: 1,\n  },\n  generateTitle: {\n    ...Typography.h2,\n    color: Colors.dark.text,\n    marginBottom: Spacing.xs,\n  },\n  limitBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n    backgroundColor: \"rgba(255, 255, 255, 0.15)\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 4,\n    borderRadius: BorderRadius.xs,\n    alignSelf: \"flex-start\",\n  },\n  generateLimit: {\n    ...Typography.caption,\n    color: Colors.dark.text,\n    fontWeight: \"600\",\n  },\n  premiumBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n    backgroundColor: \"rgba(255, 215, 0, 0.2)\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 4,\n    borderRadius: BorderRadius.xs,\n    alignSelf: \"flex-start\",\n  },\n  premiumText: {\n    ...Typography.caption,\n    color: Colors.dark.premium,\n    fontWeight: \"600\",\n  },\n  generateButton: {\n    backgroundColor: \"rgba(255, 255, 255, 0.25)\",\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderWidth: 1,\n    borderColor: \"rgba(255, 255, 255, 0.3)\",\n  },\n  generateButtonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonDisabled: {\n    opacity: 0.6,\n  },\n  sectionHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  sectionTitle: {\n    ...Typography.h3,\n  },\n  emptyState: {\n    alignItems: \"center\",\n    backgroundColor: Colors.dark.backgroundDefault,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xxl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    gap: Spacing.lg,\n  },\n  emptyIconContainer: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  emptyText: {\n    ...Typography.h3,\n    textAlign: \"center\",\n  },\n  emptySubtext: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    textAlign: \"center\",\n  },\n  workoutsList: {\n    gap: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  workoutCard: {\n    backgroundColor: Colors.dark.backgroundDefault,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  workoutHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.md,\n  },\n  workoutDate: {\n    ...Typography.h3,\n    fontSize: 18,\n    marginBottom: Spacing.xs,\n  },\n  workoutDetails: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  pointsBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    backgroundColor: Colors.dark.backgroundSecondary,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.xs,\n  },\n  pointsText: {\n    ...Typography.caption,\n    fontWeight: \"600\",\n    color: Colors.dark.primary,\n  },\n  completedBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n    marginTop: Spacing.sm,\n  },\n  completedText: {\n    ...Typography.caption,\n    color: Colors.dark.success,\n  },\n  exercisesExpanded: {\n    marginTop: Spacing.lg,\n    paddingTop: Spacing.lg,\n    borderTopWidth: 1,\n    borderTopColor: Colors.dark.border,\n  },\n  expandedTitle: {\n    ...Typography.caption,\n    fontWeight: \"600\",\n    color: Colors.dark.textSecondary,\n    marginBottom: Spacing.md,\n    textTransform: \"uppercase\",\n    letterSpacing: 1,\n  },\n  exerciseItem: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n    paddingVertical: Spacing.sm,\n    alignItems: \"flex-start\",\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.sm,\n  },\n  exerciseNumber: {\n    ...Typography.body,\n    color: Colors.dark.primary,\n    fontWeight: \"600\",\n    width: 24,\n  },\n  exerciseItemName: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    marginBottom: 4,\n  },\n  exerciseItemDetails: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  expandIndicator: {\n    alignItems: \"center\",\n    marginTop: Spacing.md,\n    paddingTop: Spacing.md,\n    borderTopWidth: 1,\n    borderTopColor: Colors.dark.border,\n  },\n  adBanner: {\n    marginTop: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n});\n","size_bytes":12763},"screens/LoginScreen.tsx":{"content":"import { useState } from \"react\";\nimport { View, StyleSheet, Pressable, TextInput, Alert, ScrollView, KeyboardAvoidingView, Platform } from \"react-native\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Image } from \"expo-image\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { Feather } from \"@expo/vector-icons\";\n\nexport default function LoginScreen() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [isLogin, setIsLogin] = useState(true);\n  const [name, setName] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const { login, signup, loginWithGoogle, user } = useAuth();\n  const navigation = useNavigation();\n  const insets = useSafeAreaInsets();\n\n  const validateEmail = (email: string): boolean => {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  };\n\n  const handleSubmit = async () => {\n    if (!email || !password || (!isLogin && (!name || !confirmPassword))) {\n      Alert.alert(\"Erro\", \"Por favor, preencha todos os campos\");\n      return;\n    }\n\n    if (!validateEmail(email)) {\n      Alert.alert(\"Erro\", \"Por favor, insira um email válido\");\n      return;\n    }\n\n    if (password.length < 6) {\n      Alert.alert(\"Erro\", \"A senha deve ter no mínimo 6 caracteres\");\n      return;\n    }\n\n    if (!isLogin && password !== confirmPassword) {\n      Alert.alert(\"Erro\", \"As senhas não coincidem\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      if (isLogin) {\n        await login(email, password);\n      } else {\n        await signup(email, password, name);\n      }\n    } catch (error: any) {\n      const errorMessage = error?.message || \"Falha ao autenticar\";\n      Alert.alert(\"Erro\", errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleGoogleSignIn = async () => {\n    setLoading(true);\n    try {\n      await loginWithGoogle();\n    } catch (error: any) {\n      console.error('[LoginScreen] Google login error:', error);\n      const errorMessage = error?.message || \"Falha ao fazer login com Google\";\n      Alert.alert(\"Erro no Login\", errorMessage);\n      setLoading(false);\n    }\n  };\n\n  return (\n    <LinearGradient\n      colors={[Colors.dark.backgroundRoot, Colors.dark.backgroundDefault]}\n      style={styles.container}\n    >\n      <KeyboardAvoidingView\n        behavior={Platform.OS === \"ios\" ? \"padding\" : \"height\"}\n        style={styles.container}\n      >\n        <ScrollView\n          contentContainerStyle={[styles.content, { paddingTop: insets.top + Spacing.xl, paddingBottom: insets.bottom + Spacing.xl }]}\n          keyboardShouldPersistTaps=\"handled\"\n        >\n          <View style={styles.header}>\n          <Image\n            source={require(\"@/assets/images/icon.png\")}\n            style={styles.logo}\n            contentFit=\"contain\"\n          />\n          <ThemedText style={styles.title}>FitRank+</ThemedText>\n          <ThemedText style={styles.subtitle}>\n            {isLogin ? \"Bem-vindo de volta!\" : \"Crie sua conta\"}\n          </ThemedText>\n        </View>\n\n        <View style={styles.form}>\n          {!isLogin && (\n            <View style={styles.inputContainer}>\n              <ThemedText style={styles.label}>Nome</ThemedText>\n              <TextInput\n                style={styles.input}\n                placeholder=\"Seu nome\"\n                placeholderTextColor={Colors.dark.textTertiary}\n                value={name}\n                onChangeText={setName}\n                autoCapitalize=\"words\"\n              />\n            </View>\n          )}\n\n          <View style={styles.inputContainer}>\n            <ThemedText style={styles.label}>Email</ThemedText>\n            <TextInput\n              style={styles.input}\n              placeholder=\"seu@email.com\"\n              placeholderTextColor={Colors.dark.textTertiary}\n              value={email}\n              onChangeText={setEmail}\n              keyboardType=\"email-address\"\n              autoCapitalize=\"none\"\n            />\n          </View>\n\n          <View style={styles.inputContainer}>\n            <ThemedText style={styles.label}>Senha</ThemedText>\n            <TextInput\n              style={styles.input}\n              placeholder=\"••••••••\"\n              placeholderTextColor={Colors.dark.textTertiary}\n              value={password}\n              onChangeText={setPassword}\n              secureTextEntry\n            />\n          </View>\n\n          {!isLogin && (\n            <View style={styles.inputContainer}>\n              <ThemedText style={styles.label}>Confirmar Senha</ThemedText>\n              <TextInput\n                style={styles.input}\n                placeholder=\"••••••••\"\n                placeholderTextColor={Colors.dark.textTertiary}\n                value={confirmPassword}\n                onChangeText={setConfirmPassword}\n                secureTextEntry\n              />\n            </View>\n          )}\n\n          <Pressable\n            style={({ pressed }) => [\n              styles.button,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={handleSubmit}\n            disabled={loading}\n          >\n            <LinearGradient\n              colors={[\"#00C853\", \"#00E676\"]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.buttonGradient}\n            >\n              <ThemedText style={styles.buttonText}>\n                {loading ? \"Carregando...\" : isLogin ? \"Entrar\" : \"Criar Conta\"}\n              </ThemedText>\n            </LinearGradient>\n          </Pressable>\n\n          {isLogin && (\n            <>\n              <View style={styles.divider}>\n                <View style={styles.dividerLine} />\n                <ThemedText style={styles.dividerText}>ou</ThemedText>\n                <View style={styles.dividerLine} />\n              </View>\n\n              <Pressable\n                style={({ pressed }) => [\n                  styles.googleButton,\n                  pressed && styles.buttonPressed,\n                ]}\n                onPress={handleGoogleSignIn}\n                disabled={loading}\n              >\n                <Feather name=\"chrome\" size={20} color={Colors.dark.text} />\n                <ThemedText style={styles.googleButtonText}>\n                  Continuar com Google\n                </ThemedText>\n              </Pressable>\n            </>\n          )}\n\n          <Pressable onPress={() => setIsLogin(!isLogin)}>\n            <ThemedText style={styles.switchText}>\n              {isLogin ? \"Não tem uma conta? Criar conta\" : \"Já tem uma conta? Entrar\"}\n            </ThemedText>\n          </Pressable>\n        </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </LinearGradient>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  header: {\n    alignItems: \"center\",\n    marginTop: Spacing.xxl,\n    marginBottom: Spacing.xl,\n  },\n  logo: {\n    width: 80,\n    height: 80,\n    marginBottom: Spacing.md,\n  },\n  title: {\n    ...Typography.h1,\n    marginBottom: Spacing.sm,\n  },\n  subtitle: {\n    ...Typography.bodyLarge,\n    color: Colors.dark.textSecondary,\n  },\n  form: {\n    width: \"100%\",\n  },\n  inputContainer: {\n    marginBottom: Spacing.lg,\n  },\n  label: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginBottom: Spacing.sm,\n  },\n  input: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderRadius: BorderRadius.sm,\n    height: Spacing.inputHeight,\n    paddingHorizontal: Spacing.md,\n    color: Colors.dark.text,\n    ...Typography.bodyLarge,\n  },\n  button: {\n    width: \"100%\",\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    overflow: \"hidden\",\n    marginTop: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonGradient: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n  switchText: {\n    ...Typography.body,\n    color: Colors.dark.primary,\n    textAlign: \"center\",\n  },\n  divider: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginVertical: Spacing.lg,\n  },\n  dividerLine: {\n    flex: 1,\n    height: 1,\n    backgroundColor: Colors.dark.border,\n  },\n  dividerText: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginHorizontal: Spacing.md,\n  },\n  googleButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderRadius: BorderRadius.xl,\n    height: Spacing.buttonHeight,\n    marginBottom: Spacing.lg,\n    gap: Spacing.sm,\n  },\n  googleButtonText: {\n    ...Typography.button,\n    color: Colors.dark.text,\n  },\n});\n","size_bytes":9267},"screens/StartWorkoutScreen.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { View, StyleSheet, Pressable, Alert, ScrollView } from \"react-native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { storage, Exercise, Workout } from \"@/utils/storage\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { useNavigation, useRoute } from \"@react-navigation/native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { generateWorkout, calculateWorkoutPoints, estimateCalories } from \"@/utils/workoutGenerator\";\n\nexport default function StartWorkoutScreen() {\n  const { user } = useAuth();\n  const navigation = useNavigation();\n  const route = useRoute();\n  const params = route.params as any;\n  const insets = useSafeAreaInsets();\n\n  const [exercises, setExercises] = useState<Exercise[]>([]);\n  const [startTime, setStartTime] = useState<Date | null>(null);\n  const [elapsedTime, setElapsedTime] = useState(0);\n\n  useEffect(() => {\n    console.log(\"[StartWorkoutScreen] Received params:\", params);\n    console.log(\"[StartWorkoutScreen] Exercises from params:\", params?.exercises?.length, params?.exercises);\n    if (params?.exercises) {\n      setExercises(params.exercises);\n    } else if (user) {\n      console.log(\"[StartWorkoutScreen] No exercises in params, generating new workout\");\n      const generatedExercises = generateWorkout(user);\n      setExercises(generatedExercises);\n    }\n  }, [params, user]);\n\n  useEffect(() => {\n    if (exercises.length > 0 && !startTime) {\n      setStartTime(new Date());\n    }\n  }, [exercises]);\n\n  useEffect(() => {\n    if (!startTime) return;\n\n    const interval = setInterval(() => {\n      const now = new Date();\n      const diff = Math.floor((now.getTime() - startTime.getTime()) / 1000);\n      setElapsedTime(diff);\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [startTime]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins.toString().padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n  };\n\n  const toggleExercise = (id: string) => {\n    setExercises(prev =>\n      prev.map(ex => (ex.id === id ? { ...ex, completed: !ex.completed } : ex))\n    );\n  };\n\n  const allCompleted = exercises.every(ex => ex.completed);\n  const completedCount = exercises.filter(ex => ex.completed).length;\n\n  const handleFinish = async () => {\n    if (!allCompleted) {\n      Alert.alert(\n        \"Treino Incompleto\",\n        \"Complete todos os exercícios antes de finalizar o treino.\",\n        [{ text: \"OK\" }]\n      );\n      return;\n    }\n\n    if (!user || !startTime) return;\n\n    const duration = Math.floor(elapsedTime / 60);\n    const stats = await storage.getUserStats(user.id);\n    const points = calculateWorkoutPoints(\n      duration,\n      exercises.length,\n      stats.currentStreak,\n      user.level\n    );\n    const calories = estimateCalories(duration, user.level, user.weight);\n\n    const workout: Workout = {\n      id: Date.now().toString(),\n      date: new Date().toISOString(),\n      startTime: startTime.toISOString(),\n      endTime: new Date().toISOString(),\n      exercises,\n      duration,\n      points,\n      completed: true,\n      calories,\n    };\n\n    await storage.completeWorkout(workout, user.id);\n    \n    const updatedStats = await storage.getUserStats(user.id);\n    const newlyUnlocked = await storage.checkAndUnlockAchievements(updatedStats, user.id);\n\n    let message = `Treino completo!\\n\\nVocê ganhou ${points} pontos\\nQueimou ~${calories} calorias\\nSequência: ${updatedStats.currentStreak} dias`;\n    \n    if (newlyUnlocked.length > 0) {\n      message += `\\n\\nNova conquista desbloqueada:\\n${newlyUnlocked[0].name}`;\n    }\n\n    Alert.alert(\n      \"Parabéns!\",\n      message,\n      [{ text: \"OK\", onPress: () => navigation.goBack() }]\n    );\n  };\n\n  const handleClose = () => {\n    if (completedCount > 0) {\n      Alert.alert(\n        \"Sair do Treino\",\n        \"Você tem exercícios completados. Tem certeza que deseja sair sem finalizar?\",\n        [\n          { text: \"Cancelar\", style: \"cancel\" },\n          { text: \"Sair\", style: \"destructive\", onPress: () => navigation.goBack() },\n        ]\n      );\n    } else {\n      navigation.goBack();\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.header}>\n        <Pressable onPress={handleClose} style={styles.closeButton}>\n          <Feather name=\"x\" size={24} color={Colors.dark.text} />\n        </Pressable>\n        <ThemedText style={styles.headerTitle}>Treino em Andamento</ThemedText>\n        <View style={styles.timer}>\n          <Feather name=\"clock\" size={16} color={Colors.dark.primary} />\n          <ThemedText style={styles.timerText}>{formatTime(elapsedTime)}</ThemedText>\n        </View>\n      </View>\n\n      <ScrollView contentContainerStyle={[styles.content, { paddingBottom: insets.bottom + Spacing.xl }]}>\n        <View style={styles.progressCard}>\n          <View style={styles.progressHeader}>\n            <Feather name=\"target\" size={20} color={Colors.dark.primary} />\n            <ThemedText style={styles.progressTitle}>Progresso do Treino</ThemedText>\n          </View>\n          <View style={styles.progressBar}>\n            <View\n              style={[\n                styles.progressFill,\n                { width: `${(completedCount / exercises.length) * 100}%` },\n              ]}\n            />\n          </View>\n          <View style={styles.progressStats}>\n            <View style={styles.progressStat}>\n              <Feather name=\"check-circle\" size={16} color={Colors.dark.success} />\n              <ThemedText style={styles.progressText}>\n                {completedCount}/{exercises.length} exercícios\n              </ThemedText>\n            </View>\n            <ThemedText style={styles.progressPercentage}>\n              {Math.round((completedCount / exercises.length) * 100)}%\n            </ThemedText>\n          </View>\n        </View>\n\n        <View style={styles.exercisesHeader}>\n          <Feather name=\"list\" size={20} color={Colors.dark.primary} />\n          <ThemedText style={styles.exercisesTitle}>Exercícios</ThemedText>\n        </View>\n\n        <View style={styles.exercisesList}>\n          {exercises.map((exercise, index) => (\n            <ExerciseCard\n              key={exercise.id}\n              exercise={exercise}\n              index={index + 1}\n              onToggle={toggleExercise}\n            />\n          ))}\n        </View>\n\n        <Pressable\n          style={({ pressed }) => [\n            styles.finishButton,\n            pressed && styles.buttonPressed,\n            !allCompleted && styles.buttonDisabled,\n          ]}\n          onPress={handleFinish}\n          disabled={!allCompleted}\n        >\n          <LinearGradient\n            colors={allCompleted ? [\"#00C853\", \"#00E676\"] : [Colors.dark.backgroundSecondary, Colors.dark.backgroundSecondary]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.buttonGradient}\n          >\n            <Feather \n              name={allCompleted ? \"check-circle\" : \"lock\"} \n              size={20} \n              color={allCompleted ? Colors.dark.buttonText : Colors.dark.textTertiary} \n              style={{ marginRight: Spacing.sm }} \n            />\n            <ThemedText style={[styles.buttonText, !allCompleted && styles.buttonTextDisabled]}>\n              {allCompleted ? \"Finalizar Treino\" : \"Complete todos os exercícios\"}\n            </ThemedText>\n          </LinearGradient>\n        </Pressable>\n      </ScrollView>\n    </View>\n  );\n}\n\nfunction ExerciseCard({\n  exercise,\n  index,\n  onToggle,\n}: {\n  exercise: Exercise;\n  index: number;\n  onToggle: (id: string) => void;\n}) {\n  return (\n    <Pressable\n      style={[styles.exerciseCard, exercise.completed && styles.exerciseCardCompleted]}\n      onPress={() => onToggle(exercise.id)}\n    >\n      <View style={styles.exerciseHeader}>\n        <View style={[styles.checkbox, exercise.completed && styles.checkboxCompleted]}>\n          {exercise.completed ? (\n            <Feather name=\"check\" size={20} color={Colors.dark.success} />\n          ) : (\n            <ThemedText style={styles.exerciseNumber}>{index}</ThemedText>\n          )}\n        </View>\n        <View style={styles.exerciseInfo}>\n          <ThemedText\n            style={[\n              styles.exerciseName,\n              exercise.completed && styles.exerciseNameCompleted,\n            ]}\n          >\n            {exercise.name}\n          </ThemedText>\n          <View style={styles.exerciseDetailsRow}>\n            <View style={styles.exerciseDetailItem}>\n              <Feather name=\"repeat\" size={14} color={Colors.dark.textSecondary} />\n              <ThemedText style={styles.exerciseDetails}>\n                {exercise.sets} × {exercise.reps}\n              </ThemedText>\n            </View>\n            <View style={styles.exerciseDetailItem}>\n              <Feather name=\"clock\" size={14} color={Colors.dark.textSecondary} />\n              <ThemedText style={styles.exerciseDetails}>\n                {exercise.rest}s\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n      </View>\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: Colors.dark.backgroundRoot,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.xxl,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: Colors.dark.border,\n  },\n  closeButton: {\n    width: 40,\n    height: 40,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  headerTitle: {\n    ...Typography.h3,\n  },\n  timer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  timerText: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    color: Colors.dark.primary,\n  },\n  content: {\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n  },\n  progressCard: {\n    backgroundColor: Colors.dark.backgroundDefault,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    marginBottom: Spacing.xl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  progressHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  progressTitle: {\n    ...Typography.h3,\n  },\n  progressBar: {\n    height: 12,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderRadius: 6,\n    overflow: \"hidden\",\n    marginBottom: Spacing.md,\n  },\n  progressFill: {\n    height: \"100%\",\n    backgroundColor: Colors.dark.primary,\n  },\n  progressStats: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  progressStat: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  progressText: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    fontWeight: \"500\",\n  },\n  progressPercentage: {\n    ...Typography.h3,\n    color: Colors.dark.primary,\n    fontWeight: \"700\",\n  },\n  exercisesHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  exercisesTitle: {\n    ...Typography.h3,\n  },\n  exercisesList: {\n    gap: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  exerciseCard: {\n    backgroundColor: Colors.dark.backgroundDefault,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    borderWidth: 2,\n    borderColor: Colors.dark.border,\n  },\n  exerciseCardCompleted: {\n    borderColor: Colors.dark.success,\n    backgroundColor: Colors.dark.backgroundSecondary,\n  },\n  exerciseHeader: {\n    flexDirection: \"row\",\n    gap: Spacing.lg,\n    alignItems: \"flex-start\",\n  },\n  checkbox: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    borderWidth: 2,\n    borderColor: Colors.dark.border,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  checkboxCompleted: {\n    borderColor: Colors.dark.success,\n    backgroundColor: \"rgba(78, 205, 196, 0.15)\",\n  },\n  exerciseNumber: {\n    ...Typography.bodyLarge,\n    fontWeight: \"700\",\n    color: Colors.dark.textSecondary,\n  },\n  exerciseInfo: {\n    flex: 1,\n  },\n  exerciseName: {\n    ...Typography.h3,\n    fontSize: 18,\n    marginBottom: Spacing.md,\n  },\n  exerciseNameCompleted: {\n    color: Colors.dark.textSecondary,\n    textDecorationLine: \"line-through\",\n  },\n  exerciseDetailsRow: {\n    flexDirection: \"row\",\n    gap: Spacing.lg,\n  },\n  exerciseDetailItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  exerciseDetails: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  finishButton: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    overflow: \"hidden\",\n    marginBottom: Spacing.xl,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonDisabled: {\n    opacity: 0.5,\n  },\n  buttonGradient: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n  buttonTextDisabled: {\n    color: Colors.dark.textTertiary,\n  },\n});\n","size_bytes":13413},"components/Spacer.tsx":{"content":"import { View } from \"react-native\";\n\ntype Props = {\n  width?: number;\n  height?: number;\n};\n\nexport default function Spacer(props: Props) {\n  const width: number = props.width ?? 1;\n  const height: number = props.height ?? 1;\n\n  return (\n    <View\n      style={{\n        width,\n        height,\n      }}\n    />\n  );\n}\n","size_bytes":318},"navigation/ProfileStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\n\nimport ProfileScreen from \"@/screens/ProfileScreen\";\nimport PremiumScreen from \"@/screens/PremiumScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type ProfileStackParamList = {\n  Profile: undefined;\n  Premium: undefined;\n};\n\nconst Stack = createNativeStackNavigator<ProfileStackParamList>();\n\nexport default function ProfileStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions({ theme, isDark })}>\n      <Stack.Screen\n        name=\"Profile\"\n        component={ProfileScreen}\n        options={{\n          title: \"Perfil\",\n        }}\n      />\n      <Stack.Screen\n        name=\"Premium\"\n        component={PremiumScreen}\n        options={{\n          title: \"Premium\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","size_bytes":979},"babel.config.js":{"content":"module.exports = function (api) {\n  api.cache(true);\n  return {\n    presets: [\"babel-preset-expo\"],\n    plugins: [\n      [\n        \"module-resolver\",\n        {\n          root: [\"./\"],\n          alias: {\n            \"@\": \"./\",\n          },\n          extensions: [\".ios.js\", \".android.js\", \".js\", \".ts\", \".tsx\", \".json\"],\n        },\n      ],\n      \"react-native-reanimated/plugin\",\n    ],\n  };\n};\n","size_bytes":395},"screens/RankingScreen.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { storage, RankingUser } from \"@/utils/storage\";\nimport { useFocusEffect } from \"@react-navigation/native\";\n\nexport default function RankingScreen() {\n  const { user } = useAuth();\n  const [ranking, setRanking] = useState<RankingUser[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useFocusEffect(\n    useCallback(() => {\n      loadRanking();\n    }, [user])\n  );\n\n  const loadRanking = async () => {\n    try {\n      setLoading(true);\n      if (!user?.id) return;\n      \n      const academyId = user?.academy?.id || \"1\";\n      const rankingData = await storage.getRanking(academyId, user.id, user.name, user.avatar);\n      setRanking(rankingData);\n    } catch (error) {\n      console.error(\"Error loading ranking:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const topThree = ranking.slice(0, 3);\n  const [second, first, third] = [topThree[1], topThree[0], topThree[2]].filter(Boolean);\n\n  if (loading) {\n    return (\n      <View style={styles.loading}>\n        <ThemedText>Carregando ranking...</ThemedText>\n      </View>\n    );\n  }\n\n  return (\n    <ScreenScrollView contentContainerStyle={styles.content}>\n      <View style={styles.header}>\n        <ThemedText style={styles.academyName}>{user?.academy?.name || \"Minha Academia\"}</ThemedText>\n        <ThemedText style={styles.period}>Ranking do Mês</ThemedText>\n      </View>\n\n      {topThree.length >= 2 && (\n        <View style={styles.podium}>\n          {second && (\n            <View style={styles.podiumPosition}>\n              <View style={[styles.podiumAvatar, styles.silverAvatar]}>\n                <ThemedText style={styles.avatarText}>{second.avatar}</ThemedText>\n              </View>\n              <ThemedText style={styles.podiumName}>{second.name.split(\" \")[0]}</ThemedText>\n              <ThemedText style={styles.podiumPoints}>{formatPoints(second.monthlyPoints)}</ThemedText>\n              <View style={[styles.podiumRank, { backgroundColor: \"#C0C0C0\" }]}>\n                <ThemedText style={styles.podiumRankText}>2º</ThemedText>\n              </View>\n            </View>\n          )}\n\n          {first && (\n            <View style={[styles.podiumPosition, styles.firstPlace]}>\n              <View style={[styles.podiumAvatar, styles.goldAvatar]}>\n                <ThemedText style={styles.avatarText}>{first.avatar}</ThemedText>\n              </View>\n              <ThemedText style={styles.podiumName}>{first.name.split(\" \")[0]}</ThemedText>\n              <ThemedText style={styles.podiumPoints}>{formatPoints(first.monthlyPoints)}</ThemedText>\n              <View style={[styles.podiumRank, { backgroundColor: Colors.dark.premium }]}>\n                <Feather name=\"award\" size={16} color={Colors.dark.backgroundRoot} />\n              </View>\n            </View>\n          )}\n\n          {third && (\n            <View style={styles.podiumPosition}>\n              <View style={[styles.podiumAvatar, styles.bronzeAvatar]}>\n                <ThemedText style={styles.avatarText}>{third.avatar}</ThemedText>\n              </View>\n              <ThemedText style={styles.podiumName}>{third.name.split(\" \")[0]}</ThemedText>\n              <ThemedText style={styles.podiumPoints}>{formatPoints(third.monthlyPoints)}</ThemedText>\n              <View style={[styles.podiumRank, { backgroundColor: \"#CD7F32\" }]}>\n                <ThemedText style={styles.podiumRankText}>3º</ThemedText>\n              </View>\n            </View>\n          )}\n        </View>\n      )}\n\n      <View style={styles.leaderboard}>\n        <ThemedText style={styles.leaderboardTitle}>Classificação Completa</ThemedText>\n        {ranking.map((rankingUser) => (\n          <View\n            key={rankingUser.id}\n            style={[\n              styles.leaderboardItem,\n              rankingUser.isCurrentUser && styles.currentUserItem,\n            ]}\n          >\n            <View style={styles.leaderboardLeft}>\n              <ThemedText style={styles.rank}>#{rankingUser.rank}</ThemedText>\n              <View style={styles.avatar}>\n                <ThemedText style={styles.avatarSmallText}>{rankingUser.avatar}</ThemedText>\n              </View>\n              <ThemedText style={styles.userName}>{rankingUser.name}</ThemedText>\n            </View>\n            <View style={styles.leaderboardRight}>\n              <Feather name=\"zap\" size={16} color={Colors.dark.primary} />\n              <ThemedText style={styles.userPoints}>{rankingUser.monthlyPoints.toLocaleString()}</ThemedText>\n            </View>\n          </View>\n        ))}\n      </View>\n    </ScreenScrollView>\n  );\n}\n\nfunction formatPoints(points: number): string {\n  if (points >= 1000) {\n    return `${(points / 1000).toFixed(1)}k`;\n  }\n  return points.toString();\n}\n\nconst styles = StyleSheet.create({\n  loading: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  header: {\n    alignItems: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  academyName: {\n    ...Typography.h2,\n    marginBottom: Spacing.xs,\n  },\n  period: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  podium: {\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    alignItems: \"flex-end\",\n    marginBottom: Spacing.xl,\n    gap: Spacing.md,\n  },\n  podiumPosition: {\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  firstPlace: {\n    transform: [{ translateY: -20 }],\n  },\n  podiumAvatar: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderWidth: 3,\n  },\n  goldAvatar: {\n    backgroundColor: Colors.dark.premium,\n    borderColor: Colors.dark.premium,\n  },\n  silverAvatar: {\n    backgroundColor: \"#C0C0C0\",\n    borderColor: \"#C0C0C0\",\n  },\n  bronzeAvatar: {\n    backgroundColor: \"#CD7F32\",\n    borderColor: \"#CD7F32\",\n  },\n  avatarText: {\n    ...Typography.h3,\n    color: Colors.dark.backgroundRoot,\n  },\n  podiumName: {\n    ...Typography.caption,\n    fontWeight: \"600\",\n  },\n  podiumPoints: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  podiumRank: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: Spacing.xs,\n  },\n  podiumRankText: {\n    ...Typography.caption,\n    color: Colors.dark.backgroundRoot,\n    fontWeight: \"700\",\n  },\n  leaderboard: {\n    marginBottom: Spacing.xl,\n  },\n  leaderboardTitle: {\n    ...Typography.h3,\n    marginBottom: Spacing.md,\n  },\n  leaderboardItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    marginBottom: Spacing.sm,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  currentUserItem: {\n    borderColor: Colors.dark.primary,\n    backgroundColor: Colors.dark.backgroundSecondary,\n  },\n  leaderboardLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n  },\n  rank: {\n    ...Typography.bodyLarge,\n    fontWeight: \"700\",\n    width: 32,\n    color: Colors.dark.textSecondary,\n  },\n  avatar: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  avatarSmallText: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n  },\n  userName: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n  },\n  leaderboardRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  userPoints: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    color: Colors.dark.primary,\n  },\n});\n","size_bytes":8041},"hooks/useScreenInsets.ts":{"content":"import { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useHeaderHeight } from \"@react-navigation/elements\";\nimport { useBottomTabBarHeight } from \"@react-navigation/bottom-tabs\";\n\nimport { Spacing } from \"@/constants/theme\";\n\nexport function useScreenInsets() {\n  const insets = useSafeAreaInsets();\n  const headerHeight = useHeaderHeight();\n  const tabBarHeight = useBottomTabBarHeight();\n\n  return {\n    paddingTop: headerHeight + Spacing.xl,\n    paddingBottom: tabBarHeight + Spacing.xl,\n    scrollInsetBottom: insets.bottom + 16,\n  };\n}\n","size_bytes":563},"navigation/MainTabNavigator.tsx":{"content":"import React from \"react\";\nimport { createBottomTabNavigator } from \"@react-navigation/bottom-tabs\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { BlurView } from \"expo-blur\";\nimport { Platform, StyleSheet, View, Pressable } from \"react-native\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport HomeStackNavigator from \"@/navigation/HomeStackNavigator\";\nimport ProfileStackNavigator from \"@/navigation/ProfileStackNavigator\";\nimport WorkoutStackNavigator from \"@/navigation/WorkoutStackNavigator\";\nimport RankingStackNavigator from \"@/navigation/RankingStackNavigator\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { Spacing } from \"@/constants/theme\";\nimport { generateWorkout } from \"@/utils/workoutGenerator\";\n\nexport type MainTabParamList = {\n  HomeTab: undefined;\n  WorkoutTab: undefined;\n  StartWorkoutTab: undefined;\n  RankingTab: undefined;\n  ProfileTab: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\nexport default function MainTabNavigator() {\n  const { theme, isDark } = useTheme();\n  const { user } = useAuth();\n\n  return (\n    <Tab.Navigator\n      initialRouteName=\"HomeTab\"\n      screenOptions={{\n        tabBarActiveTintColor: theme.tabIconSelected,\n        tabBarInactiveTintColor: theme.tabIconDefault,\n        tabBarStyle: {\n          position: \"absolute\",\n          height: Spacing.tabBarHeight,\n          backgroundColor: Platform.select({\n            ios: \"transparent\",\n            android: theme.backgroundRoot,\n          }),\n          borderTopWidth: 0,\n          elevation: 0,\n        },\n        tabBarBackground: () =>\n          Platform.OS === \"ios\" ? (\n            <BlurView\n              intensity={100}\n              tint={isDark ? \"dark\" : \"light\"}\n              style={StyleSheet.absoluteFill}\n            />\n          ) : null,\n        headerShown: false,\n      }}\n    >\n      <Tab.Screen\n        name=\"HomeTab\"\n        component={HomeStackNavigator}\n        options={{\n          title: \"Início\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"home\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"WorkoutTab\"\n        component={WorkoutStackNavigator}\n        options={{\n          title: \"Treinos\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"list\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"StartWorkoutTab\"\n        component={View}\n        options={{\n          title: \"\",\n          tabBarIcon: ({ focused }) => (\n            <View\n              style={{\n                position: \"absolute\",\n                bottom: 8,\n                width: 64,\n                height: 64,\n                borderRadius: 32,\n                overflow: \"hidden\",\n              }}\n            >\n              <LinearGradient\n                colors={[\"#00C853\", \"#00E676\"]}\n                start={{ x: 0, y: 0 }}\n                end={{ x: 1, y: 1 }}\n                style={styles.fab}\n              >\n                <Feather name=\"play\" size={28} color=\"#FFFFFF\" />\n              </LinearGradient>\n            </View>\n          ),\n          tabBarButton: (props) => <Pressable {...props} />,\n        }}\n        listeners={({ navigation }) => ({\n          tabPress: (e) => {\n            e.preventDefault();\n            if (!user) return;\n            const exercises = generateWorkout(user);\n            navigation.navigate(\"StartWorkoutModal\" as any, {\n              exercises,\n              isNewWorkout: true,\n            });\n          },\n        })}\n      />\n      <Tab.Screen\n        name=\"RankingTab\"\n        component={RankingStackNavigator}\n        options={{\n          title: \"Ranking\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"award\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"ProfileTab\"\n        component={ProfileStackNavigator}\n        options={{\n          title: \"Perfil\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"user\" size={size} color={color} />\n          ),\n        }}\n      />\n    </Tab.Navigator>\n  );\n}\n\nconst styles = StyleSheet.create({\n  fab: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 2,\n    elevation: 4,\n  },\n});\n","size_bytes":4503},"components/Card.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, Pressable } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\ninterface CardProps {\n  elevation: number;\n  onPress?: () => void;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst getBackgroundColorForElevation = (\n  elevation: number,\n  theme: any,\n): string => {\n  switch (elevation) {\n    case 1:\n      return theme.backgroundDefault;\n    case 2:\n      return theme.backgroundSecondary;\n    case 3:\n      return theme.backgroundTertiary;\n    default:\n      return theme.backgroundRoot;\n  }\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Card({ elevation, onPress }: CardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const cardBackgroundColor = getBackgroundColorForElevation(elevation, theme);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98, springConfig);\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, springConfig);\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={[\n        styles.card,\n        {\n          backgroundColor: cardBackgroundColor,\n        },\n        animatedStyle,\n      ]}\n    >\n      <ThemedText type=\"h4\" style={styles.cardTitle}>\n        Card - Elevation {elevation}\n      </ThemedText>\n      <ThemedText type=\"small\" style={styles.cardDescription}>\n        This card has an elevation of {elevation}\n      </ThemedText>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    padding: Spacing.xl,\n    borderRadius: BorderRadius[\"2xl\"],\n  },\n  cardTitle: {\n    marginBottom: Spacing.sm,\n  },\n  cardDescription: {\n    opacity: 0.7,\n  },\n});\n","size_bytes":2211},"utils/storage.ts":{"content":"import AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nexport type StoredUser = {\n  id: string;\n  email: string;\n  passwordHash: string;\n  name: string;\n  createdAt: string;\n};\n\nexport type Exercise = {\n  id: string;\n  name: string;\n  sets: number;\n  reps: number;\n  rest: number;\n  completed?: boolean;\n  muscleGroup?: string;\n};\n\nexport type Workout = {\n  id: string;\n  date: string;\n  exercises: Exercise[];\n  duration: number;\n  points: number;\n  completed: boolean;\n  calories: number;\n  startTime?: string;\n  endTime?: string;\n};\n\nexport type Achievement = {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  earned: boolean;\n  earnedDate?: string;\n  points?: number;\n};\n\nexport type UserStats = {\n  totalWorkouts: number;\n  totalPoints: number;\n  currentStreak: number;\n  bestStreak: number;\n  weeklyPoints: number;\n  monthlyPoints: number;\n  lastWorkoutDate?: string;\n  weeklyWorkoutsCount?: number;\n  weekStartDate?: string;\n};\n\nexport type Academy = {\n  id: string;\n  name: string;\n  address: string;\n  memberCount: number;\n};\n\nexport type RankingUser = {\n  id: string;\n  name: string;\n  avatar: string;\n  points: number;\n  rank: number;\n  weeklyPoints: number;\n  monthlyPoints: number;\n  isCurrentUser?: boolean;\n};\n\nconst STORAGE_KEYS = {\n  USERS: '@fitrank:users',\n  CURRENT_USER_ID: '@fitrank:currentUserId',\n};\n\nconst hashPassword = (password: string): string => {\n  return btoa(password);\n};\n\nconst verifyPassword = (password: string, hash: string): boolean => {\n  try {\n    return btoa(password) === hash;\n  } catch {\n    return false;\n  }\n};\n\nconst validateEmail = (email: string): boolean => {\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return emailRegex.test(email);\n};\n\nconst getUserStorageKey = (userId: string, key: string): string => {\n  return `@fitrank:user_${userId}:${key}`;\n};\n\nconst authRepository = {\n  async getUsers(): Promise<StoredUser[]> {\n    try {\n      const data = await AsyncStorage.getItem(STORAGE_KEYS.USERS);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error(\"Error getting users:\", error);\n      return [];\n    }\n  },\n\n  async saveUser(user: StoredUser): Promise<void> {\n    try {\n      const users = await this.getUsers();\n      users.push(user);\n      await AsyncStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(users));\n    } catch (error) {\n      console.error(\"Error saving user:\", error);\n      throw new Error(\"Falha ao salvar usuário\");\n    }\n  },\n\n  async getUserByEmail(email: string): Promise<StoredUser | null> {\n    try {\n      const users = await this.getUsers();\n      return users.find(u => u.email.toLowerCase() === email.toLowerCase()) || null;\n    } catch (error) {\n      console.error(\"Error getting user by email:\", error);\n      return null;\n    }\n  },\n\n  async registerUser(email: string, password: string, name: string): Promise<StoredUser> {\n    if (!validateEmail(email)) {\n      throw new Error(\"Email inválido\");\n    }\n\n    if (password.length < 6) {\n      throw new Error(\"A senha deve ter no mínimo 6 caracteres\");\n    }\n\n    if (!name || name.trim().length === 0) {\n      throw new Error(\"Nome é obrigatório\");\n    }\n\n    const existingUser = await this.getUserByEmail(email);\n    if (existingUser) {\n      throw new Error(\"Este email já está cadastrado\");\n    }\n\n    const newUser: StoredUser = {\n      id: Date.now().toString() + Math.random().toString(36).substring(2, 9),\n      email: email.toLowerCase(),\n      passwordHash: hashPassword(password),\n      name: name.trim(),\n      createdAt: new Date().toISOString(),\n    };\n\n    await this.saveUser(newUser);\n    return newUser;\n  },\n\n  async validateCredentials(email: string, password: string): Promise<StoredUser | null> {\n    const user = await this.getUserByEmail(email);\n    if (!user) {\n      return null;\n    }\n\n    if (!verifyPassword(password, user.passwordHash)) {\n      return null;\n    }\n\n    return user;\n  },\n\n  async getCurrentUserId(): Promise<string | null> {\n    try {\n      return await AsyncStorage.getItem(STORAGE_KEYS.CURRENT_USER_ID);\n    } catch (error) {\n      console.error(\"Error getting current user ID:\", error);\n      return null;\n    }\n  },\n\n  async setCurrentUserId(userId: string): Promise<void> {\n    try {\n      await AsyncStorage.setItem(STORAGE_KEYS.CURRENT_USER_ID, userId);\n    } catch (error) {\n      console.error(\"Error setting current user ID:\", error);\n      throw new Error(\"Falha ao salvar sessão\");\n    }\n  },\n\n  async clearCurrentUserId(): Promise<void> {\n    try {\n      await AsyncStorage.removeItem(STORAGE_KEYS.CURRENT_USER_ID);\n    } catch (error) {\n      console.error(\"Error clearing current user ID:\", error);\n    }\n  },\n};\n\nexport { authRepository };\n\nexport const storage = {\n  async getWorkouts(userId: string): Promise<Workout[]> {\n    try {\n      const key = getUserStorageKey(userId, 'workouts');\n      const data = await AsyncStorage.getItem(key);\n      return data ? JSON.parse(data) : [];\n    } catch (error) {\n      console.error(\"Error getting workouts:\", error);\n      return [];\n    }\n  },\n\n  async saveWorkout(workout: Workout, userId: string): Promise<void> {\n    try {\n      const workouts = await this.getWorkouts(userId);\n      workouts.unshift(workout);\n      const key = getUserStorageKey(userId, 'workouts');\n      await AsyncStorage.setItem(key, JSON.stringify(workouts));\n    } catch (error) {\n      console.error(\"Error saving workout:\", error);\n    }\n  },\n\n  async getUserStats(userId: string): Promise<UserStats> {\n    try {\n      const key = getUserStorageKey(userId, 'stats');\n      const data = await AsyncStorage.getItem(key);\n      if (data) {\n        return JSON.parse(data);\n      }\n      return {\n        totalWorkouts: 0,\n        totalPoints: 0,\n        currentStreak: 0,\n        bestStreak: 0,\n        weeklyPoints: 0,\n        monthlyPoints: 0,\n      };\n    } catch (error) {\n      console.error(\"Error getting user stats:\", error);\n      return {\n        totalWorkouts: 0,\n        totalPoints: 0,\n        currentStreak: 0,\n        bestStreak: 0,\n        weeklyPoints: 0,\n        monthlyPoints: 0,\n      };\n    }\n  },\n\n  async updateUserStats(updates: Partial<UserStats>, userId: string): Promise<void> {\n    try {\n      const stats = await this.getUserStats(userId);\n      const updatedStats = { ...stats, ...updates };\n      const key = getUserStorageKey(userId, 'stats');\n      await AsyncStorage.setItem(key, JSON.stringify(updatedStats));\n    } catch (error) {\n      console.error(\"Error updating user stats:\", error);\n    }\n  },\n\n  async getAchievements(userId: string): Promise<Achievement[]> {\n    try {\n      const key = getUserStorageKey(userId, 'achievements');\n      const data = await AsyncStorage.getItem(key);\n      if (data) {\n        return JSON.parse(data);\n      }\n      return this.getDefaultAchievements();\n    } catch (error) {\n      console.error(\"Error getting achievements:\", error);\n      return this.getDefaultAchievements();\n    }\n  },\n\n  getDefaultAchievements(): Achievement[] {\n    return [\n      {\n        id: \"first-workout\",\n        name: \"Primeiro Treino\",\n        description: \"Complete seu primeiro treino\",\n        icon: \"first-workout\",\n        earned: false,\n      },\n      {\n        id: \"streak-7\",\n        name: \"Semana Completa\",\n        description: \"Treine por 7 dias seguidos\",\n        icon: \"streak-7\",\n        earned: false,\n      },\n      {\n        id: \"workouts-30\",\n        name: \"30 Treinos\",\n        description: \"Complete 30 treinos\",\n        icon: \"workouts-30\",\n        earned: false,\n      },\n      {\n        id: \"top-3\",\n        name: \"Top 3\",\n        description: \"Fique entre os 3 primeiros da sua academia\",\n        icon: \"top-3\",\n        earned: false,\n      },\n      {\n        id: \"points-5000\",\n        name: \"5000 Pontos\",\n        description: \"Acumule 5000 pontos\",\n        icon: \"points-5000\",\n        earned: false,\n      },\n      {\n        id: \"workouts-100\",\n        name: \"100 Treinos\",\n        description: \"Complete 100 treinos\",\n        icon: \"workouts-100\",\n        earned: false,\n      },\n      {\n        id: \"streak-30\",\n        name: \"Mês Perfeito\",\n        description: \"Treine por 30 dias seguidos\",\n        icon: \"streak-30\",\n        earned: false,\n      },\n      {\n        id: \"perfect-week\",\n        name: \"Semana Perfeita\",\n        description: \"Complete todos os treinos planejados em uma semana\",\n        icon: \"perfect-week\",\n        earned: false,\n      },\n      {\n        id: \"champion\",\n        name: \"Campeão\",\n        description: \"Seja o primeiro colocado da sua academia\",\n        icon: \"champion\",\n        earned: false,\n      },\n      {\n        id: \"premium\",\n        name: \"Premium\",\n        description: \"Assine o plano Premium\",\n        icon: \"premium\",\n        earned: false,\n      },\n    ];\n  },\n\n  async saveAchievements(achievements: Achievement[], userId: string): Promise<void> {\n    try {\n      const key = getUserStorageKey(userId, 'achievements');\n      await AsyncStorage.setItem(key, JSON.stringify(achievements));\n    } catch (error) {\n      console.error(\"Error saving achievements:\", error);\n    }\n  },\n\n  async getTodayWorkoutCount(userId: string): Promise<number> {\n    try {\n      const key = getUserStorageKey(userId, 'todayWorkoutCount');\n      const count = await AsyncStorage.getItem(key);\n      return count ? parseInt(count) : 0;\n    } catch (error) {\n      return 0;\n    }\n  },\n\n  async incrementTodayWorkoutCount(userId: string): Promise<void> {\n    try {\n      const count = await this.getTodayWorkoutCount(userId);\n      const key = getUserStorageKey(userId, 'todayWorkoutCount');\n      await AsyncStorage.setItem(key, (count + 1).toString());\n    } catch (error) {\n      console.error(\"Error incrementing workout count:\", error);\n    }\n  },\n\n  async resetTodayWorkoutCount(userId: string): Promise<void> {\n    try {\n      const key = getUserStorageKey(userId, 'todayWorkoutCount');\n      await AsyncStorage.setItem(key, \"0\");\n    } catch (error) {\n      console.error(\"Error resetting workout count:\", error);\n    }\n  },\n\n  async getAcademies(): Promise<Academy[]> {\n    try {\n      const data = await AsyncStorage.getItem(\"@academies\");\n      if (data) {\n        return JSON.parse(data);\n      }\n      return this.getDefaultAcademies();\n    } catch (error) {\n      console.error(\"Error getting academies:\", error);\n      return this.getDefaultAcademies();\n    }\n  },\n\n  getDefaultAcademies(): Academy[] {\n    return [\n      { id: \"1\", name: \"SmartFit Centro\", address: \"Av. Paulista, 1000\", memberCount: 250 },\n      { id: \"2\", name: \"SmartFit Jardins\", address: \"Rua Augusta, 500\", memberCount: 180 },\n      { id: \"3\", name: \"Bio Ritmo Vila Olímpia\", address: \"Av. Faria Lima, 2000\", memberCount: 320 },\n      { id: \"4\", name: \"Bodytech Moema\", address: \"Av. Ibirapuera, 1500\", memberCount: 290 },\n      { id: \"5\", name: \"Academia Cia Athletica\", address: \"Av. Brasil, 800\", memberCount: 210 },\n    ];\n  },\n\n  async saveAcademy(academy: Academy): Promise<void> {\n    try {\n      const academies = await this.getAcademies();\n      academies.push(academy);\n      await AsyncStorage.setItem(\"@academies\", JSON.stringify(academies));\n    } catch (error) {\n      console.error(\"Error saving academy:\", error);\n    }\n  },\n\n  async getRanking(academyId: string, userId: string, userName: string, userAvatar: string): Promise<RankingUser[]> {\n    try {\n      const stats = await this.getUserStats(userId);\n      \n      const defaultRanking = this.getDefaultRanking(academyId);\n      \n      const userRankingEntry: RankingUser = {\n        id: userId,\n        name: userName,\n        avatar: userAvatar || \"1\",\n        points: stats.totalPoints,\n        weeklyPoints: stats.weeklyPoints,\n        monthlyPoints: stats.monthlyPoints,\n        rank: 0,\n        isCurrentUser: true,\n      };\n      \n      const allUsers = [...defaultRanking.filter(u => u.id !== userId), userRankingEntry];\n      allUsers.sort((a, b) => b.monthlyPoints - a.monthlyPoints);\n      \n      allUsers.forEach((u, index) => {\n        u.rank = index + 1;\n      });\n      \n      return allUsers.slice(0, 50);\n    } catch (error) {\n      console.error(\"Error getting ranking:\", error);\n      return this.getDefaultRanking(academyId);\n    }\n  },\n\n  getDefaultRanking(academyId: string): RankingUser[] {\n    const names = [\n      \"João Silva\", \"Maria Santos\", \"Pedro Oliveira\", \"Ana Costa\", \"Carlos Souza\",\n      \"Juliana Lima\", \"Rafael Martins\", \"Beatriz Ferreira\", \"Lucas Almeida\", \"Fernanda Rocha\",\n      \"Rodrigo Nascimento\", \"Camila Ribeiro\", \"Diego Carvalho\", \"Patricia Gomes\", \"Bruno Cardoso\",\n      \"Amanda Dias\", \"Felipe Moreira\", \"Larissa Pinto\", \"Gustavo Freitas\", \"Isabela Mendes\"\n    ];\n    \n    return names.map((name, index) => ({\n      id: `mock-${index + 1}`,\n      name,\n      avatar: ((index % 5) + 1).toString(),\n      points: 12500 - (index * 450),\n      weeklyPoints: 850 - (index * 35),\n      monthlyPoints: 3200 - (index * 120),\n      rank: index + 1,\n    }));\n  },\n\n  async completeWorkout(workout: Workout, userId: string): Promise<void> {\n    try {\n      await this.saveWorkout(workout, userId);\n      const stats = await this.ensureWeeklyCountersAreFresh(userId);\n      \n      const updatedStats: Partial<UserStats> = {\n        totalWorkouts: stats.totalWorkouts + 1,\n        totalPoints: stats.totalPoints + workout.points,\n        weeklyPoints: stats.weeklyPoints + workout.points,\n        monthlyPoints: stats.monthlyPoints + workout.points,\n        lastWorkoutDate: workout.date,\n        weeklyWorkoutsCount: (stats.weeklyWorkoutsCount || 0) + 1,\n      };\n      \n      const lastWorkout = stats.lastWorkoutDate ? new Date(stats.lastWorkoutDate) : null;\n      const today = new Date(workout.date);\n      \n      if (lastWorkout) {\n        const diffDays = Math.floor((today.getTime() - lastWorkout.getTime()) / (1000 * 60 * 60 * 24));\n        if (diffDays === 1) {\n          updatedStats.currentStreak = stats.currentStreak + 1;\n          updatedStats.bestStreak = Math.max(stats.bestStreak, updatedStats.currentStreak);\n        } else if (diffDays > 1) {\n          updatedStats.currentStreak = 1;\n        }\n      } else {\n        updatedStats.currentStreak = 1;\n        updatedStats.bestStreak = 1;\n      }\n      \n      await this.updateUserStats(updatedStats, userId);\n      await this.checkAndUnlockAchievements(updatedStats as UserStats, userId);\n    } catch (error) {\n      console.error(\"Error completing workout:\", error);\n    }\n  },\n\n  getWeekStart(): Date {\n    const today = new Date();\n    const day = today.getDay();\n    const diff = today.getDate() - day;\n    const weekStart = new Date(today);\n    weekStart.setDate(diff);\n    weekStart.setHours(0, 0, 0, 0);\n    return weekStart;\n  },\n\n  isSameWeek(date1: Date, date2: Date): boolean {\n    const week1 = this.getWeekStart();\n    const week2 = this.getWeekStart();\n    week1.setTime(date1.getTime());\n    week2.setTime(date2.getTime());\n    return week1.getTime() === week2.getTime();\n  },\n\n  async ensureWeeklyCountersAreFresh(userId: string): Promise<UserStats> {\n    const stats = await this.getUserStats(userId);\n    const currentWeekStart = this.getWeekStart();\n    const savedWeekStart = stats.weekStartDate ? new Date(stats.weekStartDate) : null;\n    \n    const isNewWeek = !savedWeekStart || savedWeekStart.getTime() < currentWeekStart.getTime();\n    \n    if (isNewWeek) {\n      const updatedStats = {\n        ...stats,\n        weeklyWorkoutsCount: 0,\n        weekStartDate: currentWeekStart.toISOString(),\n        weeklyPoints: 0,\n      };\n      await this.updateUserStats({\n        weeklyWorkoutsCount: 0,\n        weekStartDate: currentWeekStart.toISOString(),\n        weeklyPoints: 0,\n      }, userId);\n      return updatedStats;\n    }\n    \n    return stats;\n  },\n\n  async checkAndUnlockAchievements(stats: UserStats, userId: string): Promise<Achievement[]> {\n    try {\n      const achievements = await this.getAchievements(userId);\n      let hasChanges = false;\n      const newlyUnlocked: Achievement[] = [];\n      \n      achievements.forEach(achievement => {\n        if (!achievement.earned) {\n          let shouldUnlock = false;\n          \n          switch (achievement.id) {\n            case \"first-workout\":\n              shouldUnlock = stats.totalWorkouts >= 1;\n              break;\n            case \"streak-7\":\n              shouldUnlock = stats.currentStreak >= 7;\n              break;\n            case \"workouts-30\":\n              shouldUnlock = stats.totalWorkouts >= 30;\n              break;\n            case \"points-5000\":\n              shouldUnlock = stats.totalPoints >= 5000;\n              break;\n            case \"workouts-100\":\n              shouldUnlock = stats.totalWorkouts >= 100;\n              break;\n            case \"streak-30\":\n              shouldUnlock = stats.currentStreak >= 30;\n              break;\n            case \"perfect-week\":\n              shouldUnlock = (stats.weeklyWorkoutsCount || 0) >= 7;\n              break;\n          }\n          \n          if (shouldUnlock) {\n            achievement.earned = true;\n            achievement.earnedDate = new Date().toISOString();\n            hasChanges = true;\n            newlyUnlocked.push(achievement);\n          }\n        }\n      });\n      \n      if (hasChanges) {\n        await this.saveAchievements(achievements, userId);\n      }\n      \n      return newlyUnlocked;\n    } catch (error) {\n      console.error(\"Error checking achievements:\", error);\n      return [];\n    }\n  },\n\n  async canGenerateWorkout(isPremium: boolean, userId: string): Promise<{ canGenerate: boolean; remaining: number }> {\n    try {\n      if (isPremium) {\n        return { canGenerate: true, remaining: -1 };\n      }\n      \n      const stats = await this.ensureWeeklyCountersAreFresh(userId);\n      const weeklyWorkouts = stats.weeklyWorkoutsCount || 0;\n      const FREE_WEEKLY_LIMIT = 2;\n      \n      return {\n        canGenerate: weeklyWorkouts < FREE_WEEKLY_LIMIT,\n        remaining: FREE_WEEKLY_LIMIT - weeklyWorkouts,\n      };\n    } catch (error) {\n      console.error(\"Error checking workout limit:\", error);\n      return { canGenerate: true, remaining: 2 };\n    }\n  },\n};\n","size_bytes":18144},"components/Button.tsx":{"content":"import React, { ReactNode } from \"react\";\nimport { StyleSheet, Pressable, ViewStyle, StyleProp } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { BorderRadius, Spacing } from \"@/constants/theme\";\n\ninterface ButtonProps {\n  onPress?: () => void;\n  children: ReactNode;\n  style?: StyleProp<ViewStyle>;\n  disabled?: boolean;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Button({\n  onPress,\n  children,\n  style,\n  disabled = false,\n}: ButtonProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (!disabled) {\n      scale.value = withSpring(0.98, springConfig);\n    }\n  };\n\n  const handlePressOut = () => {\n    if (!disabled) {\n      scale.value = withSpring(1, springConfig);\n    }\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={disabled ? undefined : onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      disabled={disabled}\n      style={[\n        styles.button,\n        {\n          backgroundColor: theme.link,\n          opacity: disabled ? 0.5 : 1,\n        },\n        style,\n        animatedStyle,\n      ]}\n    >\n      <ThemedText\n        type=\"body\"\n        style={[styles.buttonText, { color: theme.buttonText }]}\n      >\n        {children}\n      </ThemedText>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.full,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    fontWeight: \"600\",\n  },\n});\n","size_bytes":2014},"eslint.config.js":{"content":"// https://docs.expo.dev/guides/using-eslint/\nconst { defineConfig } = require(\"eslint/config\");\nconst expoConfig = require(\"eslint-config-expo/flat\");\nconst eslintPluginPrettierRecommended = require(\"eslint-plugin-prettier/recommended\");\n\nmodule.exports = defineConfig([\n  expoConfig,\n  eslintPluginPrettierRecommended,\n  {\n    ignores: [\"dist/*\"],\n  },\n]);\n","size_bytes":359},"components/ThemedText.tsx":{"content":"import { Text, type TextProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Typography } from \"@/constants/theme\";\n\nexport type ThemedTextProps = TextProps & {\n  lightColor?: string;\n  darkColor?: string;\n  type?: \"h1\" | \"h2\" | \"h3\" | \"h4\" | \"body\" | \"small\" | \"link\";\n};\n\nexport function ThemedText({\n  style,\n  lightColor,\n  darkColor,\n  type = \"body\",\n  ...rest\n}: ThemedTextProps) {\n  const { theme, isDark } = useTheme();\n\n  const getColor = () => {\n    if (isDark && darkColor) {\n      return darkColor;\n    }\n\n    if (!isDark && lightColor) {\n      return lightColor;\n    }\n\n    if (type === \"link\") {\n      return theme.link;\n    }\n\n    return theme.text;\n  };\n\n  const getTypeStyle = () => {\n    switch (type) {\n      case \"h1\":\n        return Typography.h1;\n      case \"h2\":\n        return Typography.h2;\n      case \"h3\":\n        return Typography.h3;\n      case \"h4\":\n        return Typography.h4;\n      case \"body\":\n        return Typography.body;\n      case \"small\":\n        return Typography.small;\n      case \"link\":\n        return Typography.link;\n      default:\n        return Typography.body;\n    }\n  };\n\n  return (\n    <Text style={[{ color: getColor() }, getTypeStyle(), style]} {...rest} />\n  );\n}\n","size_bytes":1251},"navigation/HomeStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport HomeScreen from \"@/screens/HomeScreen\";\nimport { HeaderTitle } from \"@/components/HeaderTitle\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type HomeStackParamList = {\n  Home: undefined;\n};\n\nconst Stack = createNativeStackNavigator<HomeStackParamList>();\n\nexport default function HomeStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Home\"\n        component={HomeScreen}\n        options={{\n          headerTitle: () => <HeaderTitle title=\"FitRank+\" />,\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","size_bytes":860},"navigation/RankingStackNavigator.tsx":{"content":"import { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport RankingScreen from \"@/screens/RankingScreen\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type RankingStackParamList = {\n  Ranking: undefined;\n};\n\nconst Stack = createNativeStackNavigator<RankingStackParamList>();\n\nexport default function RankingStackNavigator() {\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions}>\n      <Stack.Screen\n        name=\"Ranking\"\n        component={RankingScreen}\n        options={{\n          title: \"Ranking\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","size_bytes":628},"hooks/useColorScheme.ts":{"content":"export { useColorScheme } from \"react-native\";\n","size_bytes":47},"scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction getDeploymentUrl() {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    console.log(\"Using REPLIT_INTERNAL_APP_DOMAIN:\", url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    console.log(\"Using REPLIT_DEV_DOMAIN:\", url);\n    return url;\n  }\n\n  console.error(\n    \"ERROR: REPLIT_INTERNAL_APP_DOMAIN and REPLIT_DEV_DOMAIN not set\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\");\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro() {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  metroProcess = spawn(\"npm\", [\"run\", \"dev\"], {\n    stdio: [\"ignore\", \"ignore\", \"ignore\"],\n    detached: false,\n  });\n\n  for (let i = 0; i < 30; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  try {\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n    throw error;\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  const url = new URL(\"http://localhost:8081/index.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  try {\n    await downloadFile(url.toString(), output);\n  } catch (error) {\n    exitWithError(`Failed to download ${platform} bundle: ${error.message}`);\n  }\n}\n\nasync function downloadManifest(platform) {\n  const response = await fetch(\"http://localhost:8081/manifest\", {\n    headers: { \"expo-platform\": platform },\n  });\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}`);\n  }\n\n  return await response.json();\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n\n  try {\n    const [, , iosManifest, androidManifest] = await Promise.all([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n    console.log(\"Downloaded\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Download failed: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath).replace(/^\\.\\//, \"\");\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath).replace(/^\\./, \"\");\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath).replace(\n          /^\\.\\//,\n          \"\",\n        );\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nfunction createLandingPage(baseUrl) {\n  const expsUrl = baseUrl.replace(\"https://\", \"\");\n  const template = fs.readFileSync(\n    path.join(\"scripts\", \"landing-page-template.html\"),\n    \"utf-8\",\n  );\n\n  const html = template\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl);\n\n  fs.writeFileSync(path.join(\"static-build\", \"index.html\"), html);\n  console.log(\"Complete\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const baseUrl = getDeploymentUrl();\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro();\n  const manifests = await downloadBundlesAndManifests(timestamp);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n  createLandingPage(baseUrl);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","size_bytes":12348},"navigation/WorkoutStackNavigator.tsx":{"content":"import { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport WorkoutScreen from \"@/screens/WorkoutScreen\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type WorkoutStackParamList = {\n  Workout: undefined;\n};\n\nconst Stack = createNativeStackNavigator<WorkoutStackParamList>();\n\nexport default function WorkoutStackNavigator() {\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions}>\n      <Stack.Screen\n        name=\"Workout\"\n        component={WorkoutScreen}\n        options={{\n          title: \"Treinos\",\n        }}\n      />\n    </Stack.Navigator>\n  );\n}\n","size_bytes":628},"components/ScreenFlatList.tsx":{"content":"import React from \"react\";\nimport { FlatList, FlatListProps, StyleSheet } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport function ScreenFlatList<T>({\n  contentContainerStyle,\n  style,\n  ...flatListProps\n}: FlatListProps<T>) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  return (\n    <FlatList\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      {...flatListProps}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","size_bytes":1016},"components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","size_bytes":1674},"index.js":{"content":"import { registerRootComponent } from \"expo\";\n\nimport App from \"@/App\";\n\nregisterRootComponent(App);\n","size_bytes":101},"components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n} from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Fonts } from \"@/constants/theme\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const { theme } = useTheme();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              backgroundColor: theme.backgroundDefault,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <ThemedText type=\"h1\" style={styles.title}>\n          Something went wrong\n        </ThemedText>\n\n        <ThemedText type=\"body\" style={styles.message}>\n          Please reload the app to continue.\n        </ThemedText>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.link,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[styles.buttonText, { color: theme.buttonText }]}\n          >\n            Try Again\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <ThemedView style={styles.modalContainer}>\n              <View style={styles.modalHeader}>\n                <ThemedText type=\"h2\" style={styles.modalTitle}>\n                  Error Details\n                </ThemedText>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={styles.modalScrollContent}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundDefault },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: Fonts?.mono || \"monospace\",\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </ThemedView>\n          </View>\n        </Modal>\n      ) : null}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.lg,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  title: {\n    textAlign: \"center\",\n    lineHeight: 40,\n  },\n  message: {\n    textAlign: \"center\",\n    opacity: 0.7,\n    lineHeight: 24,\n  },\n  topButton: {\n    position: \"absolute\",\n    top: Spacing[\"2xl\"] + Spacing.lg,\n    right: Spacing.lg,\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.md,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing[\"2xl\"],\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  modalTitle: {\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: Spacing.lg,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    padding: Spacing.lg,\n  },\n  errorText: {\n    fontSize: 12,\n    lineHeight: 18,\n    width: \"100%\",\n  },\n});\n","size_bytes":6194},"components/ThemedView.tsx":{"content":"import { View, type ViewProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\n\nexport type ThemedViewProps = ViewProps & {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport function ThemedView({\n  style,\n  lightColor,\n  darkColor,\n  ...otherProps\n}: ThemedViewProps) {\n  const { theme, isDark } = useTheme();\n\n  const backgroundColor =\n    isDark && darkColor\n      ? darkColor\n      : !isDark && lightColor\n        ? lightColor\n        : theme.backgroundRoot;\n\n  return <View style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","size_bytes":563},"utils/workoutGenerator.ts":{"content":"import { Exercise } from \"./storage\";\nimport { User } from \"@/types/auth\";\n\ntype MuscleGroup = 'chest' | 'back' | 'legs' | 'shoulders' | 'biceps' | 'triceps' | 'abs';\n\ninterface GymExercise {\n  id: string;\n  name: string;\n  muscleGroup: MuscleGroup;\n  sets: number;\n  reps: string;\n  rest: number;\n}\n\ninterface WorkoutPlan {\n  name: string;\n  type: 'ABC' | 'ABCD' | 'FullBody' | 'UpperLower';\n  daysPerWeek: number;\n  workouts: {\n    day: string;\n    exercises: GymExercise[];\n  }[];\n}\n\nconst gymExerciseDatabase: Record<MuscleGroup, GymExercise[]> = {\n  chest: [\n    { id: 'chest-1', name: 'Supino Reto', muscleGroup: 'chest', sets: 4, reps: '8-12', rest: 90 },\n    { id: 'chest-2', name: 'Supino Inclinado', muscleGroup: 'chest', sets: 4, reps: '8-12', rest: 90 },\n    { id: 'chest-3', name: 'Supino Declinado', muscleGroup: 'chest', sets: 3, reps: '10-12', rest: 75 },\n    { id: 'chest-4', name: 'Crucifixo Reto', muscleGroup: 'chest', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'chest-5', name: 'Crucifixo Inclinado', muscleGroup: 'chest', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'chest-6', name: 'Voador (Peck Deck)', muscleGroup: 'chest', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'chest-7', name: 'Flexão de Braço', muscleGroup: 'chest', sets: 3, reps: '15-20', rest: 45 },\n    { id: 'chest-8', name: 'Cross Over', muscleGroup: 'chest', sets: 3, reps: '12-15', rest: 60 },\n  ],\n  back: [\n    { id: 'back-1', name: 'Remada Curvada', muscleGroup: 'back', sets: 4, reps: '8-12', rest: 90 },\n    { id: 'back-2', name: 'Pulldown Frente', muscleGroup: 'back', sets: 4, reps: '10-12', rest: 75 },\n    { id: 'back-3', name: 'Remada Sentada', muscleGroup: 'back', sets: 4, reps: '10-12', rest: 75 },\n    { id: 'back-4', name: 'Levantamento Terra', muscleGroup: 'back', sets: 4, reps: '6-10', rest: 120 },\n    { id: 'back-5', name: 'Pulley Frente', muscleGroup: 'back', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'back-6', name: 'Remada Unilateral', muscleGroup: 'back', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'back-7', name: 'Barra Fixa', muscleGroup: 'back', sets: 3, reps: '8-12', rest: 90 },\n    { id: 'back-8', name: 'Pulldown Triângulo', muscleGroup: 'back', sets: 3, reps: '10-12', rest: 75 },\n  ],\n  legs: [\n    { id: 'legs-1', name: 'Agachamento Livre', muscleGroup: 'legs', sets: 4, reps: '8-12', rest: 120 },\n    { id: 'legs-2', name: 'Leg Press 45°', muscleGroup: 'legs', sets: 4, reps: '10-15', rest: 90 },\n    { id: 'legs-3', name: 'Cadeira Extensora', muscleGroup: 'legs', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'legs-4', name: 'Cadeira Flexora', muscleGroup: 'legs', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'legs-5', name: 'Stiff', muscleGroup: 'legs', sets: 4, reps: '10-12', rest: 90 },\n    { id: 'legs-6', name: 'Afundo', muscleGroup: 'legs', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'legs-7', name: 'Agachamento Búlgaro', muscleGroup: 'legs', sets: 3, reps: '10-12', rest: 75 },\n    { id: 'legs-8', name: 'Panturrilha em Pé', muscleGroup: 'legs', sets: 4, reps: '15-20', rest: 45 },\n    { id: 'legs-9', name: 'Panturrilha Sentado', muscleGroup: 'legs', sets: 3, reps: '15-20', rest: 45 },\n  ],\n  shoulders: [\n    { id: 'shoulders-1', name: 'Desenvolvimento Barra', muscleGroup: 'shoulders', sets: 4, reps: '8-12', rest: 90 },\n    { id: 'shoulders-2', name: 'Desenvolvimento Halteres', muscleGroup: 'shoulders', sets: 4, reps: '10-12', rest: 90 },\n    { id: 'shoulders-3', name: 'Elevação Lateral', muscleGroup: 'shoulders', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'shoulders-4', name: 'Elevação Frontal', muscleGroup: 'shoulders', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'shoulders-5', name: 'Remada Alta', muscleGroup: 'shoulders', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'shoulders-6', name: 'Crucifixo Inverso', muscleGroup: 'shoulders', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'shoulders-7', name: 'Desenvolvimento Arnold', muscleGroup: 'shoulders', sets: 3, reps: '10-12', rest: 75 },\n  ],\n  biceps: [\n    { id: 'biceps-1', name: 'Rosca Direta', muscleGroup: 'biceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'biceps-2', name: 'Rosca Alternada', muscleGroup: 'biceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'biceps-3', name: 'Rosca Scott', muscleGroup: 'biceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'biceps-4', name: 'Rosca Martelo', muscleGroup: 'biceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'biceps-5', name: 'Rosca Concentrada', muscleGroup: 'biceps', sets: 3, reps: '12-15', rest: 45 },\n    { id: 'biceps-6', name: 'Rosca 21', muscleGroup: 'biceps', sets: 2, reps: '21', rest: 60 },\n  ],\n  triceps: [\n    { id: 'triceps-1', name: 'Tríceps Testa', muscleGroup: 'triceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'triceps-2', name: 'Tríceps Corda', muscleGroup: 'triceps', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'triceps-3', name: 'Tríceps Francês', muscleGroup: 'triceps', sets: 3, reps: '10-12', rest: 60 },\n    { id: 'triceps-4', name: 'Mergulho', muscleGroup: 'triceps', sets: 3, reps: '10-15', rest: 75 },\n    { id: 'triceps-5', name: 'Tríceps Barra', muscleGroup: 'triceps', sets: 3, reps: '12-15', rest: 60 },\n    { id: 'triceps-6', name: 'Tríceps Coice', muscleGroup: 'triceps', sets: 3, reps: '12-15', rest: 45 },\n  ],\n  abs: [\n    { id: 'abs-1', name: 'Abdominal Supra', muscleGroup: 'abs', sets: 3, reps: '15-20', rest: 45 },\n    { id: 'abs-2', name: 'Prancha Isométrica', muscleGroup: 'abs', sets: 3, reps: '30-60s', rest: 45 },\n    { id: 'abs-3', name: 'Elevação de Pernas', muscleGroup: 'abs', sets: 3, reps: '12-15', rest: 45 },\n    { id: 'abs-4', name: 'Abdominal Infra', muscleGroup: 'abs', sets: 3, reps: '15-20', rest: 45 },\n    { id: 'abs-5', name: 'Prancha Lateral', muscleGroup: 'abs', sets: 3, reps: '30-45s', rest: 45 },\n    { id: 'abs-6', name: 'Abdominal Bicicleta', muscleGroup: 'abs', sets: 3, reps: '20-30', rest: 45 },\n    { id: 'abs-7', name: 'Abdominal Oblíquo', muscleGroup: 'abs', sets: 3, reps: '15-20', rest: 45 },\n  ],\n};\n\nconst workoutPlans: WorkoutPlan[] = [\n  {\n    name: 'Treino ABC',\n    type: 'ABC',\n    daysPerWeek: 3,\n    workouts: [\n      {\n        day: 'A',\n        exercises: [\n          gymExerciseDatabase.chest[0],\n          gymExerciseDatabase.chest[1],\n          gymExerciseDatabase.chest[3],\n          gymExerciseDatabase.triceps[0],\n          gymExerciseDatabase.triceps[1],\n          gymExerciseDatabase.triceps[3],\n        ],\n      },\n      {\n        day: 'B',\n        exercises: [\n          gymExerciseDatabase.back[0],\n          gymExerciseDatabase.back[1],\n          gymExerciseDatabase.back[2],\n          gymExerciseDatabase.back[6],\n          gymExerciseDatabase.biceps[0],\n          gymExerciseDatabase.biceps[1],\n        ],\n      },\n      {\n        day: 'C',\n        exercises: [\n          gymExerciseDatabase.legs[0],\n          gymExerciseDatabase.legs[1],\n          gymExerciseDatabase.legs[2],\n          gymExerciseDatabase.legs[3],\n          gymExerciseDatabase.shoulders[0],\n          gymExerciseDatabase.shoulders[2],\n        ],\n      },\n    ],\n  },\n  {\n    name: 'Treino ABCD',\n    type: 'ABCD',\n    daysPerWeek: 4,\n    workouts: [\n      {\n        day: 'A',\n        exercises: [\n          gymExerciseDatabase.chest[0],\n          gymExerciseDatabase.chest[1],\n          gymExerciseDatabase.chest[3],\n          gymExerciseDatabase.chest[4],\n          gymExerciseDatabase.chest[5],\n        ],\n      },\n      {\n        day: 'B',\n        exercises: [\n          gymExerciseDatabase.back[0],\n          gymExerciseDatabase.back[1],\n          gymExerciseDatabase.back[3],\n          gymExerciseDatabase.back[2],\n          gymExerciseDatabase.back[6],\n        ],\n      },\n      {\n        day: 'C',\n        exercises: [\n          gymExerciseDatabase.legs[0],\n          gymExerciseDatabase.legs[1],\n          gymExerciseDatabase.legs[2],\n          gymExerciseDatabase.legs[3],\n          gymExerciseDatabase.legs[4],\n        ],\n      },\n      {\n        day: 'D',\n        exercises: [\n          gymExerciseDatabase.shoulders[0],\n          gymExerciseDatabase.shoulders[2],\n          gymExerciseDatabase.shoulders[3],\n          gymExerciseDatabase.biceps[0],\n          gymExerciseDatabase.biceps[2],\n          gymExerciseDatabase.triceps[0],\n          gymExerciseDatabase.triceps[1],\n        ],\n      },\n    ],\n  },\n  {\n    name: 'Treino Full Body',\n    type: 'FullBody',\n    daysPerWeek: 3,\n    workouts: [\n      {\n        day: 'FullBody',\n        exercises: [\n          gymExerciseDatabase.chest[0],\n          gymExerciseDatabase.back[1],\n          gymExerciseDatabase.legs[0],\n          gymExerciseDatabase.shoulders[0],\n          gymExerciseDatabase.biceps[0],\n          gymExerciseDatabase.triceps[0],\n          gymExerciseDatabase.abs[0],\n          gymExerciseDatabase.abs[1],\n        ],\n      },\n    ],\n  },\n  {\n    name: 'Treino Upper/Lower',\n    type: 'UpperLower',\n    daysPerWeek: 4,\n    workouts: [\n      {\n        day: 'Upper',\n        exercises: [\n          gymExerciseDatabase.chest[0],\n          gymExerciseDatabase.chest[1],\n          gymExerciseDatabase.back[0],\n          gymExerciseDatabase.back[1],\n          gymExerciseDatabase.shoulders[0],\n          gymExerciseDatabase.biceps[0],\n          gymExerciseDatabase.triceps[0],\n        ],\n      },\n      {\n        day: 'Lower',\n        exercises: [\n          gymExerciseDatabase.legs[0],\n          gymExerciseDatabase.legs[1],\n          gymExerciseDatabase.legs[2],\n          gymExerciseDatabase.legs[3],\n          gymExerciseDatabase.legs[4],\n          gymExerciseDatabase.abs[0],\n          gymExerciseDatabase.abs[1],\n        ],\n      },\n    ],\n  },\n];\n\nexport function selectPlanBasedOnFrequency(\n  weeklyFrequency: 2 | 3 | 4 | 5 | 6,\n  goal: \"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\"\n): \"ABC\" | \"ABCD\" | \"FullBody\" | \"UpperLower\" {\n  switch (weeklyFrequency) {\n    case 2:\n      return \"FullBody\";\n    case 3:\n      return \"ABC\";\n    case 4:\n      if (goal === \"hypertrophy\" || goal === \"beginner\") {\n        return \"ABCD\";\n      }\n      return \"UpperLower\";\n    case 5:\n      return \"ABCD\";\n    case 6:\n      return \"UpperLower\";\n    default:\n      return \"FullBody\";\n  }\n}\n\nexport function generateWorkout(user: User): Exercise[] {\n  const weeklyFrequency = user.weeklyFrequency || 3;\n  const goal = user.goal || 'beginner';\n  \n  const selectedPlanType = selectPlanBasedOnFrequency(weeklyFrequency, goal);\n  \n  const selectedWorkoutPlan = workoutPlans.find(plan => plan.type === selectedPlanType);\n  \n  if (!selectedWorkoutPlan || !selectedWorkoutPlan.workouts[0]) {\n    return [];\n  }\n\n  const firstWorkout = selectedWorkoutPlan.workouts[0];\n  const gymExercises = firstWorkout.exercises;\n  \n  return gymExercises.map((ex, idx) => ({\n    id: `${Date.now()}-${idx}`,\n    name: ex.name,\n    sets: ex.sets,\n    reps: typeof ex.reps === 'string' ? parseInt(ex.reps.split('-')[0]) : ex.reps,\n    rest: ex.rest,\n    completed: false,\n    muscleGroup: getMuscleGroupLabel(ex.muscleGroup),\n  }));\n}\n\nfunction getMuscleGroupLabel(muscleGroup: MuscleGroup): string {\n  const labels: Record<MuscleGroup, string> = {\n    chest: 'Peito',\n    back: 'Costas',\n    legs: 'Pernas',\n    shoulders: 'Ombros',\n    biceps: 'Bíceps',\n    triceps: 'Tríceps',\n    abs: 'Abdômen',\n  };\n  return labels[muscleGroup] || 'Geral';\n}\n\nexport function calculateWorkoutPoints(\n  duration: number,\n  exerciseCount: number,\n  streak: number,\n  level: \"beginner\" | \"intermediate\" | \"advanced\"\n): number {\n  const levelMultiplier = level === \"beginner\" ? 1 : level === \"intermediate\" ? 1.3 : 1.6;\n  const streakMultiplier = 1 + (streak * 0.05);\n  \n  const basePoints = (duration * levelMultiplier) + (exerciseCount * 50);\n  const totalPoints = Math.round(basePoints * streakMultiplier);\n  \n  return totalPoints;\n}\n\nexport function estimateCalories(\n  duration: number,\n  level: \"beginner\" | \"intermediate\" | \"advanced\",\n  weight: number\n): number {\n  const baseRate = level === \"beginner\" ? 5 : level === \"intermediate\" ? 7 : 9;\n  return Math.round((duration * baseRate * weight) / 70);\n}\n\nexport { gymExerciseDatabase, workoutPlans };\nexport type { GymExercise, WorkoutPlan, MuscleGroup };\n","size_bytes":12160},"screens/ProfileSetupScreen.tsx":{"content":"import { useState } from \"react\";\nimport { View, StyleSheet, Pressable, TextInput, ScrollView } from \"react-native\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\n\nexport default function ProfileSetupScreen() {\n  const [step, setStep] = useState(1);\n  const [goal, setGoal] = useState<\"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\">(\"hypertrophy\");\n  const [level, setLevel] = useState<\"beginner\" | \"intermediate\" | \"advanced\">(\"beginner\");\n  const [age, setAge] = useState(\"\");\n  const [weight, setWeight] = useState(\"\");\n  const [height, setHeight] = useState(\"\");\n  const [timeAvailable, setTimeAvailable] = useState(30);\n  const [weeklyFrequency, setWeeklyFrequency] = useState<2 | 3 | 4 | 5 | 6>(3);\n  const [location, setLocation] = useState<\"home\" | \"gym\">(\"gym\");\n\n  const { updateProfile, setHasCompletedOnboarding } = useAuth();\n  const navigation = useNavigation();\n  const insets = useSafeAreaInsets();\n\n  const handleNext = () => {\n    if (step < 6) {\n      setStep(step + 1);\n    } else {\n      handleFinish();\n    }\n  };\n\n  const handleBack = () => {\n    if (step > 1) {\n      setStep(step - 1);\n    }\n  };\n\n  const handleFinish = async () => {\n    const selectedPlan = selectPlan(weeklyFrequency, goal);\n    \n    await updateProfile({\n      goal,\n      level,\n      age: parseInt(age) || 25,\n      weight: parseFloat(weight) || 70,\n      height: parseFloat(height) || 170,\n      timeAvailable,\n      weeklyFrequency,\n      location,\n      selectedPlan,\n    });\n    \n    await setHasCompletedOnboarding(true);\n  };\n\n  const selectPlan = (\n    frequency: 2 | 3 | 4 | 5 | 6,\n    userGoal: \"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\"\n  ): \"ABC\" | \"ABCD\" | \"FullBody\" | \"UpperLower\" => {\n    switch (frequency) {\n      case 2:\n        return \"FullBody\";\n      case 3:\n        return \"ABC\";\n      case 4:\n        if (userGoal === \"hypertrophy\" || userGoal === \"beginner\") {\n          return \"ABCD\";\n        }\n        return \"UpperLower\";\n      case 5:\n        return \"ABCD\";\n      case 6:\n        return \"UpperLower\";\n      default:\n        return \"FullBody\";\n    }\n  };\n\n  const renderStep = () => {\n    switch (step) {\n      case 1:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Qual é seu objetivo?</ThemedText>\n            <View style={styles.optionsContainer}>\n              <OptionButton\n                label=\"Hipertrofia\"\n                selected={goal === \"hypertrophy\"}\n                onPress={() => setGoal(\"hypertrophy\")}\n              />\n              <OptionButton\n                label=\"Emagrecimento\"\n                selected={goal === \"weight_loss\"}\n                onPress={() => setGoal(\"weight_loss\")}\n              />\n              <OptionButton\n                label=\"Resistência\"\n                selected={goal === \"endurance\"}\n                onPress={() => setGoal(\"endurance\")}\n              />\n              <OptionButton\n                label=\"Iniciante\"\n                selected={goal === \"beginner\"}\n                onPress={() => setGoal(\"beginner\")}\n              />\n            </View>\n          </View>\n        );\n      case 2:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Qual seu nível?</ThemedText>\n            <View style={styles.optionsContainer}>\n              <OptionButton\n                label=\"Iniciante\"\n                selected={level === \"beginner\"}\n                onPress={() => setLevel(\"beginner\")}\n              />\n              <OptionButton\n                label=\"Intermediário\"\n                selected={level === \"intermediate\"}\n                onPress={() => setLevel(\"intermediate\")}\n              />\n              <OptionButton\n                label=\"Avançado\"\n                selected={level === \"advanced\"}\n                onPress={() => setLevel(\"advanced\")}\n              />\n            </View>\n          </View>\n        );\n      case 3:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Dados Físicos</ThemedText>\n            <View style={styles.inputGroup}>\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.label}>Idade</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"25\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={age}\n                  onChangeText={setAge}\n                  keyboardType=\"numeric\"\n                />\n              </View>\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.label}>Peso (kg)</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"70\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={weight}\n                  onChangeText={setWeight}\n                  keyboardType=\"numeric\"\n                />\n              </View>\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.label}>Altura (cm)</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"170\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={height}\n                  onChangeText={setHeight}\n                  keyboardType=\"numeric\"\n                />\n              </View>\n            </View>\n          </View>\n        );\n      case 4:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Tempo disponível por dia</ThemedText>\n            <View style={styles.optionsContainer}>\n              <OptionButton\n                label=\"30 min\"\n                selected={timeAvailable === 30}\n                onPress={() => setTimeAvailable(30)}\n              />\n              <OptionButton\n                label=\"45 min\"\n                selected={timeAvailable === 45}\n                onPress={() => setTimeAvailable(45)}\n              />\n              <OptionButton\n                label=\"60 min\"\n                selected={timeAvailable === 60}\n                onPress={() => setTimeAvailable(60)}\n              />\n            </View>\n          </View>\n        );\n      case 5:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Frequência semanal</ThemedText>\n            <View style={styles.optionsContainer}>\n              <OptionButton\n                label=\"2x por semana\"\n                selected={weeklyFrequency === 2}\n                onPress={() => setWeeklyFrequency(2)}\n              />\n              <OptionButton\n                label=\"3x por semana\"\n                selected={weeklyFrequency === 3}\n                onPress={() => setWeeklyFrequency(3)}\n              />\n              <OptionButton\n                label=\"4x por semana\"\n                selected={weeklyFrequency === 4}\n                onPress={() => setWeeklyFrequency(4)}\n              />\n              <OptionButton\n                label=\"5x por semana\"\n                selected={weeklyFrequency === 5}\n                onPress={() => setWeeklyFrequency(5)}\n              />\n              <OptionButton\n                label=\"6x por semana\"\n                selected={weeklyFrequency === 6}\n                onPress={() => setWeeklyFrequency(6)}\n              />\n            </View>\n          </View>\n        );\n      case 6:\n        return (\n          <View style={styles.stepContainer}>\n            <ThemedText style={styles.stepTitle}>Onde você treina?</ThemedText>\n            <View style={styles.optionsContainer}>\n              <OptionButton\n                label=\"Em Casa\"\n                selected={location === \"home\"}\n                onPress={() => setLocation(\"home\")}\n              />\n              <OptionButton\n                label=\"Na Academia\"\n                selected={location === \"gym\"}\n                onPress={() => setLocation(\"gym\")}\n              />\n            </View>\n          </View>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <LinearGradient\n      colors={[Colors.dark.backgroundRoot, Colors.dark.backgroundDefault]}\n      style={styles.container}\n    >\n      <ScrollView \n        contentContainerStyle={[styles.content, { paddingTop: insets.top + Spacing.xl, paddingBottom: insets.bottom + Spacing.xl }]}\n        keyboardShouldPersistTaps=\"handled\"\n      >\n        <View style={styles.header}>\n          <ThemedText style={styles.title}>Configure seu Perfil</ThemedText>\n          <ThemedText style={styles.subtitle}>Passo {step} de 6</ThemedText>\n        </View>\n\n        <View style={styles.progressContainer}>\n          <View style={styles.progressBar}>\n            <View style={[styles.progressFill, { width: `${(step / 6) * 100}%` }]} />\n          </View>\n        </View>\n\n        {renderStep()}\n\n        <View style={styles.buttonsContainer}>\n          {step > 1 && (\n            <Pressable\n              style={({ pressed }) => [\n                styles.secondaryButton,\n                pressed && styles.buttonPressed,\n              ]}\n              onPress={handleBack}\n            >\n              <ThemedText style={styles.secondaryButtonText}>Voltar</ThemedText>\n            </Pressable>\n          )}\n          <Pressable\n            style={({ pressed }) => [\n              styles.button,\n              pressed && styles.buttonPressed,\n              step === 1 && styles.buttonFull,\n            ]}\n            onPress={handleNext}\n          >\n            <LinearGradient\n              colors={[\"#00C853\", \"#00E676\"]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.buttonGradient}\n            >\n              <ThemedText style={styles.buttonText}>\n                {step === 6 ? \"Finalizar\" : \"Próximo\"}\n              </ThemedText>\n            </LinearGradient>\n          </Pressable>\n        </View>\n      </ScrollView>\n    </LinearGradient>\n  );\n}\n\nfunction OptionButton({ label, selected, onPress }: { label: string; selected: boolean; onPress: () => void }) {\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.optionButton,\n        selected && styles.optionButtonSelected,\n        pressed && styles.buttonPressed,\n      ]}\n      onPress={onPress}\n    >\n      <ThemedText style={[styles.optionButtonText, selected && styles.optionButtonTextSelected]}>\n        {label}\n      </ThemedText>\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  header: {\n    alignItems: \"center\",\n    marginTop: Spacing.xl,\n    marginBottom: Spacing.lg,\n  },\n  title: {\n    ...Typography.h2,\n    marginBottom: Spacing.sm,\n  },\n  subtitle: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  progressContainer: {\n    marginBottom: Spacing.xl,\n  },\n  progressBar: {\n    height: 6,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderRadius: 3,\n    overflow: \"hidden\",\n  },\n  progressFill: {\n    height: \"100%\",\n    backgroundColor: Colors.dark.primary,\n  },\n  stepContainer: {\n    marginBottom: Spacing.xl,\n  },\n  stepTitle: {\n    ...Typography.h2,\n    marginBottom: Spacing.lg,\n    textAlign: \"center\",\n  },\n  optionsContainer: {\n    gap: Spacing.md,\n  },\n  optionButton: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 2,\n    borderColor: \"transparent\",\n  },\n  optionButtonSelected: {\n    borderColor: Colors.dark.primary,\n    backgroundColor: Colors.dark.backgroundDefault,\n  },\n  optionButtonText: {\n    ...Typography.bodyLarge,\n    textAlign: \"center\",\n    color: Colors.dark.textSecondary,\n  },\n  optionButtonTextSelected: {\n    color: Colors.dark.primary,\n    fontWeight: \"600\",\n  },\n  inputGroup: {\n    gap: Spacing.md,\n  },\n  inputContainer: {\n    marginBottom: Spacing.md,\n  },\n  label: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginBottom: Spacing.sm,\n  },\n  input: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderRadius: BorderRadius.sm,\n    height: Spacing.inputHeight,\n    paddingHorizontal: Spacing.md,\n    color: Colors.dark.text,\n    ...Typography.bodyLarge,\n  },\n  buttonsContainer: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  button: {\n    flex: 1,\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    overflow: \"hidden\",\n  },\n  buttonFull: {\n    flex: 1,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonGradient: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n  secondaryButton: {\n    flex: 1,\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  secondaryButtonText: {\n    ...Typography.button,\n    color: Colors.dark.textSecondary,\n  },\n});\n","size_bytes":13557},"screens/ProfileScreen.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { StyleSheet, View, Alert, Pressable, Modal, FlatList, ScrollView, TextInput } from \"react-native\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { Colors, Spacing, BorderRadius, Typography } from \"@/constants/theme\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { Image } from \"expo-image\";\nimport { useNavigation, useFocusEffect } from \"@react-navigation/native\";\nimport { storage, UserStats, Academy, Achievement } from \"@/utils/storage\";\nimport { selectPlanBasedOnFrequency } from \"@/utils/workoutGenerator\";\n\nexport default function ProfileScreen() {\n  const { user, logout, updateProfile } = useAuth();\n  const navigation = useNavigation();\n  const [stats, setStats] = useState<UserStats | null>(null);\n  const [academies, setAcademies] = useState<Academy[]>([]);\n  const [achievements, setAchievements] = useState<Achievement[]>([]);\n  const [showAcademyModal, setShowAcademyModal] = useState(false);\n  const [showGoalModal, setShowGoalModal] = useState(false);\n  const [showFrequencyModal, setShowFrequencyModal] = useState(false);\n  const [showEditProfileModal, setShowEditProfileModal] = useState(false);\n  const [editName, setEditName] = useState(user?.name || \"\");\n  const [editAge, setEditAge] = useState(user?.age.toString() || \"\");\n  const [editWeight, setEditWeight] = useState(user?.weight.toString() || \"\");\n  const [editHeight, setEditHeight] = useState(user?.height.toString() || \"\");\n\n  useFocusEffect(\n    useCallback(() => {\n      let isMounted = true;\n      \n      const loadDataSafely = async () => {\n        if (!user?.id) return;\n        \n        const userStats = await storage.getUserStats(user.id);\n        const academyList = await storage.getAcademies();\n        const achievementList = await storage.getAchievements(user.id);\n        \n        if (isMounted) {\n          setStats(userStats);\n          setAcademies(academyList);\n          setAchievements(achievementList);\n        }\n      };\n      \n      loadDataSafely();\n      \n      return () => {\n        isMounted = false;\n      };\n    }, [user?.id])\n  );\n\n  const loadData = async () => {\n    if (!user?.id) return;\n    \n    const userStats = await storage.getUserStats(user.id);\n    const academyList = await storage.getAcademies();\n    const achievementList = await storage.getAchievements(user.id);\n    setStats(userStats);\n    setAcademies(academyList);\n    setAchievements(achievementList);\n  };\n\n  const handleLogout = () => {\n    Alert.alert(\"Sair\", \"Tem certeza que deseja sair da sua conta?\", [\n      { text: \"Cancelar\", style: \"cancel\" },\n      {\n        text: \"Sair\",\n        style: \"destructive\",\n        onPress: async () => {\n          await logout();\n        },\n      },\n    ]);\n  };\n\n  const handleUpgradeToPremium = () => {\n    (navigation as any).navigate('Premium');\n  };\n\n  const handleSelectAcademy = async (academy: Academy) => {\n    await updateProfile({ \n      academy: {\n        id: academy.id,\n        name: academy.name\n      }\n    });\n    await loadData();\n    setShowAcademyModal(false);\n    Alert.alert(\"Academia atualizada\", `Agora você faz parte de ${academy.name}!`);\n  };\n\n  const handleUpdateGoal = async (newGoal: \"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\") => {\n    if (!user) return;\n    \n    const currentFrequency = user.weeklyFrequency || 3;\n    const newPlan = selectPlanBasedOnFrequency(currentFrequency, newGoal);\n    await updateProfile({ goal: newGoal, selectedPlan: newPlan });\n    await loadData();\n    setShowGoalModal(false);\n    Alert.alert(\n      \"Objetivo atualizado\",\n      `Seu plano de treino foi atualizado para ${newPlan}!`\n    );\n  };\n\n  const handleUpdateFrequency = async (newFrequency: 2 | 3 | 4 | 5 | 6) => {\n    if (!user) return;\n    \n    const currentGoal = user.goal || 'beginner';\n    const newPlan = selectPlanBasedOnFrequency(newFrequency, currentGoal);\n    await updateProfile({ weeklyFrequency: newFrequency, selectedPlan: newPlan });\n    await loadData();\n    setShowFrequencyModal(false);\n    Alert.alert(\n      \"Frequência atualizada\",\n      `Seu plano de treino foi atualizado para ${newPlan}!`\n    );\n  };\n\n  const getGoalLabel = (goal: \"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\") => {\n    const labels = {\n      hypertrophy: \"Hipertrofia\",\n      weight_loss: \"Emagrecimento\",\n      endurance: \"Resistência\",\n      beginner: \"Iniciante\",\n    };\n    return labels[goal];\n  };\n\n  const handleSaveProfile = async () => {\n    if (!editName.trim()) {\n      Alert.alert(\"Erro\", \"Por favor, preencha seu nome\");\n      return;\n    }\n\n    const age = parseInt(editAge) || 25;\n    const weight = parseInt(editWeight) || 70;\n    const height = parseInt(editHeight) || 170;\n\n    await updateProfile({\n      name: editName,\n      age,\n      weight,\n      height,\n    });\n    \n    setShowEditProfileModal(false);\n    Alert.alert(\"Sucesso\", \"Perfil atualizado com sucesso!\");\n  };\n\n  const handleOpenEditProfile = () => {\n    setEditName(user?.name || \"\");\n    setEditAge(user?.age.toString() || \"\");\n    setEditWeight(user?.weight.toString() || \"\");\n    setEditHeight(user?.height.toString() || \"\");\n    setShowEditProfileModal(true);\n  };\n\n  if (!user) {\n    return (\n      <View style={styles.loading}>\n        <ThemedText>Carregando...</ThemedText>\n      </View>\n    );\n  }\n\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(n => n[0])\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  const isImageUrl = (avatar?: string) => {\n    return avatar && (avatar.startsWith('http://') || avatar.startsWith('https://'));\n  };\n\n  return (\n    <ScreenScrollView contentContainerStyle={styles.content}>\n      <View style={styles.header}>\n        <View style={styles.avatarContainer}>\n          {isImageUrl(user.avatar) ? (\n            <Image\n              source={{ uri: user.avatar }}\n              style={styles.avatarImage}\n              contentFit=\"cover\"\n            />\n          ) : (\n            <ThemedText style={styles.avatar}>{getInitials(user.name)}</ThemedText>\n          )}\n        </View>\n        <ThemedText style={styles.name}>{user.name}</ThemedText>\n        <ThemedText style={styles.details}>\n          {user.age} anos • {user.academy?.name || \"Sem academia\"}\n        </ThemedText>\n      </View>\n\n      {!user.isPremium && (\n        <Pressable\n          style={({ pressed }) => [\n            styles.premiumCard,\n            pressed && styles.buttonPressed,\n          ]}\n          onPress={handleUpgradeToPremium}\n        >\n          <LinearGradient\n            colors={[\"#FFD700\", \"#FFA500\"]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.premiumGradient}\n          >\n            <Feather name=\"zap\" size={24} color={Colors.dark.backgroundRoot} />\n            <View style={styles.premiumContent}>\n              <ThemedText style={styles.premiumTitle}>Upgrade para Premium</ThemedText>\n              <ThemedText style={styles.premiumSubtitle}>\n                Treinos ilimitados, sem anúncios e muito mais\n              </ThemedText>\n            </View>\n            <Feather name=\"chevron-right\" size={24} color={Colors.dark.backgroundRoot} />\n          </LinearGradient>\n        </Pressable>\n      )}\n\n      {user.isPremium && (\n        <View style={styles.premiumBadge}>\n          <Feather name=\"award\" size={20} color={Colors.dark.premium} />\n          <ThemedText style={styles.premiumBadgeText}>Membro Premium</ThemedText>\n        </View>\n      )}\n\n      <View style={styles.section}>\n        <ThemedText style={styles.sectionTitle}>Estatísticas</ThemedText>\n        <View style={styles.statsGrid}>\n          <View style={styles.statCard}>\n            <Feather name=\"zap\" size={24} color={Colors.dark.primary} />\n            <ThemedText style={styles.statValue}>{stats?.totalPoints.toLocaleString() || \"0\"}</ThemedText>\n            <ThemedText style={styles.statLabel}>Pontos</ThemedText>\n          </View>\n          <View style={styles.statCard}>\n            <Feather name=\"activity\" size={24} color={Colors.dark.primary} />\n            <ThemedText style={styles.statValue}>{stats?.totalWorkouts || \"0\"}</ThemedText>\n            <ThemedText style={styles.statLabel}>Treinos</ThemedText>\n          </View>\n          <View style={styles.statCard}>\n            <Feather name=\"trending-up\" size={24} color={Colors.dark.primary} />\n            <ThemedText style={styles.statValue}>{stats?.currentStreak || \"0\"}</ThemedText>\n            <ThemedText style={styles.statLabel}>Sequência</ThemedText>\n          </View>\n          <View style={styles.statCard}>\n            <Feather name=\"award\" size={24} color={Colors.dark.primary} />\n            <ThemedText style={styles.statValue}>{stats?.bestStreak || \"0\"}</ThemedText>\n            <ThemedText style={styles.statLabel}>Melhor Seq.</ThemedText>\n          </View>\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <View style={styles.sectionHeader}>\n          <Feather name=\"award\" size={24} color={Colors.dark.primary} />\n          <ThemedText style={styles.sectionTitle}>Conquistas</ThemedText>\n        </View>\n        <View style={styles.achievementsGrid}>\n          {achievements.slice(0, 6).map((achievement) => (\n            <View\n              key={achievement.id}\n              style={[\n                styles.achievementCard,\n                !achievement.earned && styles.achievementLocked,\n              ]}\n            >\n              <View style={[\n                styles.achievementIcon,\n                achievement.earned && styles.achievementIconEarned,\n              ]}>\n                {achievement.earned ? (\n                  <Feather name=\"award\" size={28} color={Colors.dark.premium} />\n                ) : (\n                  <Feather name=\"lock\" size={24} color={Colors.dark.textTertiary} />\n                )}\n              </View>\n              <ThemedText style={[\n                styles.achievementName,\n                !achievement.earned && styles.achievementLockedText,\n              ]}>\n                {achievement.name}\n              </ThemedText>\n              <ThemedText style={styles.achievementDesc} numberOfLines={2}>\n                {achievement.description}\n              </ThemedText>\n              {achievement.earned && achievement.earnedDate && (\n                <View style={styles.achievementDateBadge}>\n                  <Feather name=\"check-circle\" size={12} color={Colors.dark.success} />\n                  <ThemedText style={styles.achievementDate}>\n                    {new Date(achievement.earnedDate).toLocaleDateString(\"pt-BR\", {\n                      day: \"2-digit\",\n                      month: \"short\",\n                    })}\n                  </ThemedText>\n                </View>\n              )}\n            </View>\n          ))}\n        </View>\n        <View style={styles.achievementsSummaryCard}>\n          <Feather name=\"star\" size={20} color={Colors.dark.primary} />\n          <ThemedText style={styles.achievementsSummary}>\n            {achievements.filter(a => a.earned).length} de {achievements.length} conquistas desbloqueadas\n          </ThemedText>\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <ThemedText style={styles.sectionTitle}>Academia</ThemedText>\n        <Pressable\n          style={({ pressed }) => [\n            styles.academyCard,\n            pressed && styles.buttonPressed,\n          ]}\n          onPress={() => setShowAcademyModal(true)}\n        >\n          <View style={styles.academyInfo}>\n            <Feather name=\"home\" size={20} color={Colors.dark.primary} />\n            <View style={{ flex: 1 }}>\n              <ThemedText style={styles.academyName}>\n                {user.academy?.name || \"Selecionar Academia\"}\n              </ThemedText>\n              {user.academy?.address && (\n                <ThemedText style={styles.academyAddress}>{user.academy.address}</ThemedText>\n              )}\n            </View>\n          </View>\n          <Feather name=\"chevron-right\" size={20} color={Colors.dark.textTertiary} />\n        </Pressable>\n      </View>\n\n      <View style={styles.section}>\n        <ThemedText style={styles.sectionTitle}>Preferências de Treino</ThemedText>\n        <View style={styles.trainingPreferences}>\n          <Pressable\n            style={({ pressed }) => [\n              styles.preferenceCard,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={() => setShowGoalModal(true)}\n          >\n            <View style={styles.preferenceInfo}>\n              <Feather name=\"target\" size={20} color={Colors.dark.primary} />\n              <View style={{ flex: 1 }}>\n                <ThemedText style={styles.preferenceLabel}>Objetivo</ThemedText>\n                <ThemedText style={styles.preferenceValue}>\n                  {getGoalLabel(user.goal)}\n                </ThemedText>\n              </View>\n            </View>\n            <Feather name=\"chevron-right\" size={20} color={Colors.dark.textTertiary} />\n          </Pressable>\n\n          <Pressable\n            style={({ pressed }) => [\n              styles.preferenceCard,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={() => setShowFrequencyModal(true)}\n          >\n            <View style={styles.preferenceInfo}>\n              <Feather name=\"calendar\" size={20} color={Colors.dark.primary} />\n              <View style={{ flex: 1 }}>\n                <ThemedText style={styles.preferenceLabel}>Frequência Semanal</ThemedText>\n                <ThemedText style={styles.preferenceValue}>\n                  {user.weeklyFrequency}x por semana\n                </ThemedText>\n              </View>\n            </View>\n            <Feather name=\"chevron-right\" size={20} color={Colors.dark.textTertiary} />\n          </Pressable>\n\n          {user.selectedPlan && (\n            <View style={styles.planBadge}>\n              <Feather name=\"layers\" size={16} color={Colors.dark.success} />\n              <ThemedText style={styles.planBadgeText}>\n                Plano: {user.selectedPlan}\n              </ThemedText>\n            </View>\n          )}\n        </View>\n      </View>\n\n      <View style={styles.section}>\n        <ThemedText style={styles.sectionTitle}>Configurações</ThemedText>\n        <View style={styles.settingsList}>\n          <SettingItem icon=\"user\" label=\"Editar Perfil\" onPress={handleOpenEditProfile} />\n          <SettingItem \n            icon=\"bell\" \n            label=\"Notificações\" \n            onPress={() => Alert.alert(\"Notificações\", \"Em breve você poderá configurar notificações personalizadas!\")} \n          />\n          <SettingItem \n            icon=\"shield\" \n            label=\"Privacidade\" \n            onPress={() => Alert.alert(\"Privacidade\", \"Em breve você poderá gerenciar suas configurações de privacidade!\")} \n          />\n          <SettingItem \n            icon=\"help-circle\" \n            label=\"Ajuda\" \n            onPress={() => Alert.alert(\"Ajuda\", \"Precisa de ajuda?\\n\\nEntre em contato: suporte@fitrank.com\")} \n          />\n          <SettingItem\n            icon=\"log-out\"\n            label=\"Sair\"\n            onPress={handleLogout}\n            isDestructive\n          />\n        </View>\n      </View>\n\n      <Modal\n        visible={showAcademyModal}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={() => setShowAcademyModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText style={styles.modalTitle}>Selecionar Academia</ThemedText>\n              <Pressable onPress={() => setShowAcademyModal(false)}>\n                <Feather name=\"x\" size={24} color={Colors.dark.text} />\n              </Pressable>\n            </View>\n            <FlatList\n              data={academies}\n              keyExtractor={(item) => item.id}\n              renderItem={({ item }) => (\n                <Pressable\n                  style={({ pressed }) => [\n                    styles.academyItem,\n                    pressed && styles.buttonPressed,\n                    item.id === user.academy?.id && styles.academyItemSelected,\n                  ]}\n                  onPress={() => handleSelectAcademy(item)}\n                >\n                  <View style={{ flex: 1 }}>\n                    <ThemedText style={styles.academyItemName}>{item.name}</ThemedText>\n                    <ThemedText style={styles.academyItemAddress}>{item.address}</ThemedText>\n                    <ThemedText style={styles.academyItemMembers}>\n                      {item.memberCount} membros\n                    </ThemedText>\n                  </View>\n                  {item.id === user.academy?.id && (\n                    <Feather name=\"check\" size={20} color={Colors.dark.success} />\n                  )}\n                </Pressable>\n              )}\n            />\n          </View>\n        </View>\n      </Modal>\n\n      <Modal\n        visible={showGoalModal}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={() => setShowGoalModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText style={styles.modalTitle}>Selecionar Objetivo</ThemedText>\n              <Pressable onPress={() => setShowGoalModal(false)}>\n                <Feather name=\"x\" size={24} color={Colors.dark.text} />\n              </Pressable>\n            </View>\n            <ScrollView style={styles.modalScroll}>\n              {([\"hypertrophy\", \"weight_loss\", \"endurance\", \"beginner\"] as const).map((goal) => (\n                <Pressable\n                  key={goal}\n                  style={({ pressed }) => [\n                    styles.optionItem,\n                    pressed && styles.buttonPressed,\n                    user.goal === goal && styles.optionItemSelected,\n                  ]}\n                  onPress={() => handleUpdateGoal(goal)}\n                >\n                  <ThemedText style={styles.optionItemText}>\n                    {getGoalLabel(goal)}\n                  </ThemedText>\n                  {user.goal === goal && (\n                    <Feather name=\"check\" size={20} color={Colors.dark.success} />\n                  )}\n                </Pressable>\n              ))}\n            </ScrollView>\n          </View>\n        </View>\n      </Modal>\n\n      <Modal\n        visible={showFrequencyModal}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={() => setShowFrequencyModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText style={styles.modalTitle}>Frequência Semanal</ThemedText>\n              <Pressable onPress={() => setShowFrequencyModal(false)}>\n                <Feather name=\"x\" size={24} color={Colors.dark.text} />\n              </Pressable>\n            </View>\n            <ScrollView style={styles.modalScroll}>\n              {([2, 3, 4, 5, 6] as const).map((freq) => (\n                <Pressable\n                  key={freq}\n                  style={({ pressed }) => [\n                    styles.optionItem,\n                    pressed && styles.buttonPressed,\n                    user.weeklyFrequency === freq && styles.optionItemSelected,\n                  ]}\n                  onPress={() => handleUpdateFrequency(freq)}\n                >\n                  <ThemedText style={styles.optionItemText}>\n                    {freq}x por semana\n                  </ThemedText>\n                  {user.weeklyFrequency === freq && (\n                    <Feather name=\"check\" size={20} color={Colors.dark.success} />\n                  )}\n                </Pressable>\n              ))}\n            </ScrollView>\n          </View>\n        </View>\n      </Modal>\n\n      <Modal\n        visible={showEditProfileModal}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={() => setShowEditProfileModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText style={styles.modalTitle}>Editar Perfil</ThemedText>\n              <Pressable onPress={() => setShowEditProfileModal(false)}>\n                <Feather name=\"x\" size={24} color={Colors.dark.text} />\n              </Pressable>\n            </View>\n            <ScrollView style={styles.modalScroll}>\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.inputLabel}>Nome</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"Seu nome\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={editName}\n                  onChangeText={setEditName}\n                />\n              </View>\n\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.inputLabel}>Idade</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"25\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={editAge}\n                  onChangeText={setEditAge}\n                  keyboardType=\"number-pad\"\n                />\n              </View>\n\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.inputLabel}>Peso (kg)</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"70\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={editWeight}\n                  onChangeText={setEditWeight}\n                  keyboardType=\"number-pad\"\n                />\n              </View>\n\n              <View style={styles.inputContainer}>\n                <ThemedText style={styles.inputLabel}>Altura (cm)</ThemedText>\n                <TextInput\n                  style={styles.input}\n                  placeholder=\"170\"\n                  placeholderTextColor={Colors.dark.textTertiary}\n                  value={editHeight}\n                  onChangeText={setEditHeight}\n                  keyboardType=\"number-pad\"\n                />\n              </View>\n\n              <Pressable\n                style={({ pressed }) => [\n                  styles.saveButton,\n                  pressed && styles.buttonPressed,\n                ]}\n                onPress={handleSaveProfile}\n              >\n                <LinearGradient\n                  colors={[\"#00C853\", \"#00E676\"]}\n                  start={{ x: 0, y: 0 }}\n                  end={{ x: 1, y: 1 }}\n                  style={styles.saveButtonGradient}\n                >\n                  <ThemedText style={styles.saveButtonText}>Salvar</ThemedText>\n                </LinearGradient>\n              </Pressable>\n            </ScrollView>\n          </View>\n        </View>\n      </Modal>\n    </ScreenScrollView>\n  );\n}\n\nfunction SettingItem({\n  icon,\n  label,\n  onPress,\n  isDestructive,\n}: {\n  icon: string;\n  label: string;\n  onPress: () => void;\n  isDestructive?: boolean;\n}) {\n  return (\n    <Pressable\n      style={({ pressed }) => [\n        styles.settingItem,\n        pressed && styles.buttonPressed,\n      ]}\n      onPress={onPress}\n    >\n      <View style={styles.settingLeft}>\n        <Feather\n          name={icon as any}\n          size={20}\n          color={isDestructive ? Colors.dark.error : Colors.dark.textSecondary}\n        />\n        <ThemedText\n          style={[styles.settingLabel, isDestructive && styles.destructiveText]}\n        >\n          {label}\n        </ThemedText>\n      </View>\n      <Feather name=\"chevron-right\" size={20} color={Colors.dark.textTertiary} />\n    </Pressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  loading: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  header: {\n    alignItems: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  avatarContainer: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n    overflow: \"hidden\",\n  },\n  avatarImage: {\n    width: 80,\n    height: 80,\n  },\n  avatar: {\n    ...Typography.h1,\n  },\n  name: {\n    ...Typography.h2,\n    marginBottom: Spacing.xs,\n  },\n  details: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  premiumCard: {\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    marginBottom: Spacing.lg,\n  },\n  premiumGradient: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  premiumContent: {\n    flex: 1,\n  },\n  premiumTitle: {\n    ...Typography.h3,\n    color: Colors.dark.backgroundRoot,\n    marginBottom: Spacing.xs,\n  },\n  premiumSubtitle: {\n    ...Typography.caption,\n    color: Colors.dark.backgroundRoot,\n    opacity: 0.8,\n  },\n  premiumBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.sm,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.lg,\n  },\n  premiumBadgeText: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    color: Colors.dark.premium,\n  },\n  section: {\n    marginBottom: Spacing.xxl,\n  },\n  sectionHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  sectionTitle: {\n    ...Typography.h3,\n  },\n  statsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.md,\n  },\n  statCard: {\n    flex: 1,\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    gap: Spacing.sm,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  statValue: {\n    ...Typography.h2,\n    color: Colors.dark.primary,\n  },\n  statLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  settingsList: {\n    gap: Spacing.xs,\n  },\n  settingItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  settingLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n  },\n  settingLabel: {\n    ...Typography.bodyLarge,\n  },\n  destructiveText: {\n    color: Colors.dark.error,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  academyCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  academyInfo: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n  },\n  academyName: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    marginBottom: 2,\n  },\n  academyAddress: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.7)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContent: {\n    backgroundColor: Colors.dark.backgroundRoot,\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    paddingTop: Spacing.lg,\n    maxHeight: \"80%\",\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingHorizontal: Spacing.lg,\n    marginBottom: Spacing.lg,\n  },\n  modalTitle: {\n    ...Typography.h2,\n  },\n  academyItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: Colors.dark.border,\n  },\n  academyItemSelected: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n  },\n  academyItemName: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n    marginBottom: 4,\n  },\n  academyItemAddress: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    marginBottom: 2,\n  },\n  academyItemMembers: {\n    ...Typography.caption,\n    color: Colors.dark.textTertiary,\n  },\n  achievementsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    justifyContent: \"space-between\",\n    marginBottom: Spacing.lg,\n  },\n  achievementCard: {\n    width: \"47%\",\n    marginBottom: Spacing.md,\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.lg,\n    borderWidth: 2,\n    borderColor: Colors.dark.premium,\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  achievementLocked: {\n    borderColor: Colors.dark.border,\n    backgroundColor: Colors.dark.backgroundDefault,\n    opacity: 0.5,\n  },\n  achievementIcon: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  achievementIconEarned: {\n    backgroundColor: \"rgba(255, 215, 0, 0.15)\",\n  },\n  achievementName: {\n    ...Typography.body,\n    fontWeight: \"700\",\n    textAlign: \"center\",\n  },\n  achievementLockedText: {\n    color: Colors.dark.textTertiary,\n  },\n  achievementDesc: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    textAlign: \"center\",\n  },\n  achievementDateBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 4,\n    borderRadius: BorderRadius.xs,\n  },\n  achievementDate: {\n    ...Typography.caption,\n    fontSize: 10,\n    color: Colors.dark.success,\n    fontWeight: \"600\",\n  },\n  achievementsSummaryCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.sm,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  achievementsSummary: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    fontWeight: \"500\",\n  },\n  trainingPreferences: {\n    gap: Spacing.md,\n  },\n  preferenceCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  preferenceInfo: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n  },\n  preferenceLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginBottom: 4,\n  },\n  preferenceValue: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n  },\n  planBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.sm,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n    borderWidth: 1,\n    borderColor: Colors.dark.success,\n  },\n  planBadgeText: {\n    ...Typography.caption,\n    fontWeight: \"600\",\n    color: Colors.dark.success,\n  },\n  modalScroll: {\n    paddingHorizontal: Spacing.lg,\n  },\n  optionItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: Colors.dark.border,\n  },\n  optionItemSelected: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n  },\n  optionItemText: {\n    ...Typography.bodyLarge,\n    fontWeight: \"500\",\n  },\n  inputContainer: {\n    marginBottom: Spacing.lg,\n  },\n  inputLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginBottom: Spacing.sm,\n  },\n  input: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderRadius: BorderRadius.sm,\n    padding: Spacing.md,\n    color: Colors.dark.text,\n    ...Typography.bodyLarge,\n  },\n  saveButton: {\n    width: \"100%\",\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    marginTop: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  saveButtonGradient: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  saveButtonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n});\n","size_bytes":32769},"screens/OnboardingScreen.tsx":{"content":"import { View, StyleSheet, Pressable, Dimensions } from \"react-native\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Image } from \"expo-image\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\n\nconst { width } = Dimensions.get(\"window\");\n\nexport default function OnboardingScreen() {\n  const { setHasCompletedOnboarding } = useAuth();\n  const navigation = useNavigation();\n\n  const handleGetStarted = async () => {\n    await setHasCompletedOnboarding(true);\n    navigation.navigate(\"LoginModal\" as never);\n  };\n\n  return (\n    <LinearGradient\n      colors={[Colors.dark.backgroundRoot, Colors.dark.backgroundDefault]}\n      style={styles.container}\n    >\n      <ScreenScrollView contentContainerStyle={styles.content}>\n        <View style={styles.logoContainer}>\n          <Image\n            source={require(\"@/assets/images/icon.png\")}\n            style={styles.logo}\n            contentFit=\"contain\"\n          />\n          <ThemedText style={styles.title}>FitRank+</ThemedText>\n          <ThemedText style={styles.tagline}>Treine. Compita. Evolua.</ThemedText>\n        </View>\n\n        <View style={styles.featuresContainer}>\n          <FeatureCard\n            icon=\"💪\"\n            title=\"Treinos Personalizados\"\n            description=\"IA cria treinos exclusivos baseados no seu perfil e objetivos\"\n          />\n          <FeatureCard\n            icon=\"🏆\"\n            title=\"Sistema de Ranking\"\n            description=\"Compita com outros atletas da sua academia e ganhe pontos\"\n          />\n          <FeatureCard\n            icon=\"📊\"\n            title=\"Acompanhe seu Progresso\"\n            description=\"Veja sua evolução com gráficos detalhados e conquistas\"\n          />\n        </View>\n\n        <Pressable\n          style={({ pressed }) => [\n            styles.button,\n            pressed && styles.buttonPressed,\n          ]}\n          onPress={handleGetStarted}\n        >\n          <LinearGradient\n            colors={[\"#00C853\", \"#00E676\"]}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.buttonGradient}\n          >\n            <ThemedText style={styles.buttonText}>Começar Agora</ThemedText>\n          </LinearGradient>\n        </Pressable>\n      </ScreenScrollView>\n    </LinearGradient>\n  );\n}\n\nfunction FeatureCard({ icon, title, description }: { icon: string; title: string; description: string }) {\n  return (\n    <View style={styles.featureCard}>\n      <View style={styles.featureIconContainer}>\n        <ThemedText style={styles.featureIcon}>{icon}</ThemedText>\n      </View>\n      <ThemedText style={styles.featureTitle}>{title}</ThemedText>\n      <ThemedText style={styles.featureDescription}>{description}</ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  content: {\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n  },\n  logoContainer: {\n    alignItems: \"center\",\n    marginTop: Spacing.xxl,\n    marginBottom: Spacing.xxl,\n  },\n  logo: {\n    width: 120,\n    height: 120,\n    marginBottom: Spacing.lg,\n  },\n  title: {\n    ...Typography.h1,\n    marginBottom: Spacing.sm,\n  },\n  tagline: {\n    ...Typography.bodyLarge,\n    color: Colors.dark.textSecondary,\n  },\n  featuresContainer: {\n    width: \"100%\",\n    gap: Spacing.md,\n    marginBottom: Spacing.xxl,\n  },\n  featureCard: {\n    backgroundColor: Colors.dark.backgroundDefault,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  featureIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  featureIcon: {\n    fontSize: 24,\n  },\n  featureTitle: {\n    ...Typography.h3,\n    marginBottom: Spacing.sm,\n  },\n  featureDescription: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  button: {\n    width: \"100%\",\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    overflow: \"hidden\",\n    marginBottom: Spacing.xl,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonGradient: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n});\n","size_bytes":4587},"navigation/RootNavigator.tsx":{"content":"import { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport { View, ActivityIndicator } from \"react-native\";\nimport MainTabNavigator from \"@/navigation/MainTabNavigator\";\nimport OnboardingScreen from \"@/screens/OnboardingScreen\";\nimport LoginScreen from \"@/screens/LoginScreen\";\nimport ProfileSetupScreen from \"@/screens/ProfileSetupScreen\";\nimport StartWorkoutScreen from \"@/screens/StartWorkoutScreen\";\nimport { Exercise } from \"@/utils/storage\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { Colors } from \"@/constants/theme\";\n\nexport type RootStackParamList = {\n  Main: undefined;\n  OnboardingModal: undefined;\n  LoginModal: undefined;\n  ProfileSetupModal: undefined;\n  StartWorkoutModal: { exercises: Exercise[]; isNewWorkout: boolean };\n};\n\nconst Stack = createNativeStackNavigator<RootStackParamList>();\n\nexport default function RootNavigator() {\n  const { user, isLoading, hasCompletedOnboarding } = useAuth();\n\n  if (isLoading) {\n    return (\n      <View style={{ flex: 1, justifyContent: \"center\", alignItems: \"center\", backgroundColor: Colors.dark.backgroundRoot }}>\n        <ActivityIndicator size=\"large\" color={Colors.dark.primary} />\n      </View>\n    );\n  }\n\n  if (!user) {\n    return (\n      <Stack.Navigator\n        screenOptions={{\n          headerShown: false,\n        }}\n      >\n        <Stack.Group screenOptions={{ presentation: \"modal\" }}>\n          <Stack.Screen name=\"LoginModal\" component={LoginScreen} />\n        </Stack.Group>\n      </Stack.Navigator>\n    );\n  }\n\n  if (!hasCompletedOnboarding) {\n    return (\n      <Stack.Navigator\n        screenOptions={{\n          headerShown: false,\n        }}\n      >\n        <Stack.Group screenOptions={{ presentation: \"modal\" }}>\n          <Stack.Screen name=\"ProfileSetupModal\" component={ProfileSetupScreen} />\n        </Stack.Group>\n      </Stack.Navigator>\n    );\n  }\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen name=\"Main\" component={MainTabNavigator} />\n      <Stack.Group screenOptions={{ presentation: \"modal\" }}>\n        <Stack.Screen name=\"OnboardingModal\" component={OnboardingScreen} />\n        <Stack.Screen name=\"StartWorkoutModal\" component={StartWorkoutScreen} />\n      </Stack.Group>\n    </Stack.Navigator>\n  );\n}\n","size_bytes":2314},"screens/HomeScreen.tsx":{"content":"import { useState, useCallback } from \"react\";\nimport { View, StyleSheet, Pressable } from \"react-native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Colors, Spacing, Typography, BorderRadius } from \"@/constants/theme\";\nimport { useAuth } from \"@/hooks/useSupabaseAuth\";\nimport { storage, Workout, UserStats } from \"@/utils/storage\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { useNavigation, useFocusEffect } from \"@react-navigation/native\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { generateWorkout } from \"@/utils/workoutGenerator\";\nimport { AdBanner } from \"@/components/AdBanner\";\n\ntype HomeStats = Pick<UserStats, 'currentStreak' | 'totalWorkouts' | 'totalPoints' | 'weeklyPoints'>;\n\nexport default function HomeScreen() {\n  const { user } = useAuth();\n  const navigation = useNavigation();\n  const [stats, setStats] = useState<HomeStats>({\n    currentStreak: 0,\n    totalWorkouts: 0,\n    totalPoints: 0,\n    weeklyPoints: 0,\n  });\n  const [todayWorkout, setTodayWorkout] = useState<Workout | null>(null);\n\n  useFocusEffect(\n    useCallback(() => {\n      let isMounted = true;\n\n      const loadDataSafely = async () => {\n        if (!user?.id) return;\n        \n        const userStats = await storage.getUserStats(user.id);\n        const workouts = await storage.getWorkouts(user.id);\n        const today = new Date().toDateString();\n        const todaysWorkout = workouts.find(w => new Date(w.date).toDateString() === today);\n\n        if (isMounted) {\n          setStats(userStats);\n          setTodayWorkout(todaysWorkout || null);\n        }\n      };\n\n      loadDataSafely();\n\n      return () => {\n        isMounted = false;\n      };\n    }, [user?.id])\n  );\n\n  const handleStartWorkout = () => {\n    if (!user) {\n      return;\n    }\n    const exercises = generateWorkout(user);\n    navigation.navigate(\"StartWorkoutModal\" as never, {\n      exercises,\n      isNewWorkout: true,\n    } as never);\n  };\n\n  const handleViewWorkouts = () => {\n    navigation.navigate(\"WorkoutTab\" as never);\n  };\n\n  return (\n    <ScreenScrollView contentContainerStyle={styles.content}>\n      <View style={styles.streakCard}>\n        <LinearGradient\n          colors={stats.currentStreak >= 7 ? [\"#00C853\", \"#00E676\"] : [Colors.dark.backgroundSecondary, Colors.dark.backgroundSecondary]}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.streakGradient}\n        >\n          <View style={styles.streakIconContainer}>\n            <Feather name=\"zap\" size={28} color={Colors.dark.text} />\n          </View>\n          <View style={styles.streakContent}>\n            <ThemedText style={styles.streakNumber}>{stats.currentStreak}</ThemedText>\n            <ThemedText style={styles.streakLabel}>dias de sequência</ThemedText>\n          </View>\n          {stats.currentStreak >= 7 && (\n            <View style={styles.streakBadge}>\n              <Feather name=\"award\" size={16} color={Colors.dark.text} />\n            </View>\n          )}\n        </LinearGradient>\n      </View>\n\n      {todayWorkout && todayWorkout.completed ? (\n        <View style={styles.card}>\n          <View style={styles.cardHeader}>\n            <Feather name=\"check-circle\" size={24} color={Colors.dark.success} />\n            <ThemedText style={styles.cardTitle}>Treino de Hoje Completo!</ThemedText>\n          </View>\n          <View style={styles.completedInfo}>\n            <View style={styles.completedStats}>\n              <View style={styles.completedStat}>\n                <Feather name=\"zap\" size={20} color={Colors.dark.primary} />\n                <ThemedText style={styles.completedStatValue}>{todayWorkout.points}</ThemedText>\n                <ThemedText style={styles.completedStatLabel}>pontos</ThemedText>\n              </View>\n              <View style={styles.completedStat}>\n                <Feather name=\"activity\" size={20} color={Colors.dark.primary} />\n                <ThemedText style={styles.completedStatValue}>{todayWorkout.exercises.length}</ThemedText>\n                <ThemedText style={styles.completedStatLabel}>exercícios</ThemedText>\n              </View>\n              <View style={styles.completedStat}>\n                <Feather name=\"clock\" size={20} color={Colors.dark.primary} />\n                <ThemedText style={styles.completedStatValue}>{todayWorkout.duration}</ThemedText>\n                <ThemedText style={styles.completedStatLabel}>minutos</ThemedText>\n              </View>\n            </View>\n          </View>\n        </View>\n      ) : (\n        <View style={styles.card}>\n          <View style={styles.cardHeader}>\n            <Feather name=\"calendar\" size={24} color={Colors.dark.primary} />\n            <ThemedText style={styles.cardTitle}>Treino do Dia</ThemedText>\n          </View>\n          <View style={styles.workoutInfo}>\n            <InfoRow icon=\"activity\" label=\"Exercícios\" value=\"6\" />\n            <InfoRow icon=\"clock\" label=\"Tempo\" value={`${user?.timeAvailable || 30} min`} />\n            <InfoRow icon=\"trending-up\" label=\"Dificuldade\" value={user?.level === \"beginner\" ? \"Iniciante\" : user?.level === \"intermediate\" ? \"Intermediário\" : \"Avançado\"} />\n          </View>\n          <Pressable\n            style={({ pressed }) => [\n              styles.primaryButton,\n              pressed && styles.buttonPressed,\n            ]}\n            onPress={handleStartWorkout}\n          >\n            <LinearGradient\n              colors={[\"#00C853\", \"#00E676\"]}\n              start={{ x: 0, y: 0 }}\n              end={{ x: 1, y: 1 }}\n              style={styles.buttonGradient}\n            >\n              <Feather name=\"play\" size={20} color={Colors.dark.buttonText} style={{ marginRight: Spacing.sm }} />\n              <ThemedText style={styles.buttonText}>Iniciar Treino</ThemedText>\n            </LinearGradient>\n          </Pressable>\n        </View>\n      )}\n\n      <View style={styles.card}>\n        <View style={styles.cardHeader}>\n          <Feather name=\"bar-chart-2\" size={24} color={Colors.dark.primary} />\n          <ThemedText style={styles.cardTitle}>Resumo de Pontos</ThemedText>\n        </View>\n        <View style={styles.statsGrid}>\n          <StatCard icon=\"calendar\" label=\"Pontos Semanais\" value={stats.weeklyPoints.toString()} />\n          <StatCard icon=\"award\" label=\"Total de Pontos\" value={stats.totalPoints.toString()} />\n        </View>\n      </View>\n\n      <View style={styles.card}>\n        <View style={styles.cardHeader}>\n          <Feather name=\"trending-up\" size={24} color={Colors.dark.primary} />\n          <ThemedText style={styles.cardTitle}>Estatísticas</ThemedText>\n        </View>\n        <View style={styles.quickStats}>\n          <QuickStat icon=\"activity\" label=\"Treinos\" value={stats.totalWorkouts.toString()} />\n          <QuickStat icon=\"zap\" label=\"Pontos\" value={stats.totalPoints.toString()} />\n          <QuickStat icon=\"trending-up\" label=\"Sequência\" value={`${stats.currentStreak}`} />\n        </View>\n      </View>\n\n      <Pressable\n        style={({ pressed }) => [\n          styles.secondaryButton,\n          pressed && styles.buttonPressed,\n        ]}\n        onPress={handleViewWorkouts}\n      >\n        <Feather name=\"list\" size={18} color={Colors.dark.primary} style={{ marginRight: Spacing.sm }} />\n        <ThemedText style={styles.secondaryButtonText}>Ver Histórico de Treinos</ThemedText>\n      </Pressable>\n\n      <AdBanner style={styles.adBanner} />\n    </ScreenScrollView>\n  );\n}\n\nfunction InfoRow({ icon, label, value }: { icon: string; label: string; value: string }) {\n  return (\n    <View style={styles.infoRow}>\n      <Feather name={icon as any} size={20} color={Colors.dark.textSecondary} />\n      <View style={styles.infoContent}>\n        <ThemedText style={styles.infoLabel}>{label}</ThemedText>\n        <ThemedText style={styles.infoValue}>{value}</ThemedText>\n      </View>\n    </View>\n  );\n}\n\nfunction StatCard({ icon, label, value }: { icon: string; label: string; value: string }) {\n  return (\n    <View style={styles.statCard}>\n      <View style={styles.statIconContainer}>\n        <Feather name={icon as any} size={20} color={Colors.dark.primary} />\n      </View>\n      <ThemedText style={styles.statValue}>{value}</ThemedText>\n      <ThemedText style={styles.statLabel}>{label}</ThemedText>\n    </View>\n  );\n}\n\nfunction QuickStat({ icon, label, value }: { icon: string; label: string; value: string }) {\n  return (\n    <View style={styles.quickStat}>\n      <View style={styles.quickStatIconContainer}>\n        <Feather name={icon as any} size={24} color={Colors.dark.primary} />\n      </View>\n      <ThemedText style={styles.quickStatValue}>{value}</ThemedText>\n      <ThemedText style={styles.quickStatLabel}>{label}</ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    paddingHorizontal: Spacing.lg,\n  },\n  streakCard: {\n    marginBottom: Spacing.xl,\n    borderRadius: BorderRadius.lg,\n    overflow: \"hidden\",\n  },\n  streakGradient: {\n    padding: Spacing.xl,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.lg,\n  },\n  streakIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    backgroundColor: \"rgba(255, 255, 255, 0.15)\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  streakContent: {\n    flex: 1,\n  },\n  streakNumber: {\n    ...Typography.h1,\n    fontSize: 40,\n    fontWeight: \"700\",\n    marginBottom: Spacing.xs,\n  },\n  streakLabel: {\n    ...Typography.body,\n    color: Colors.dark.text,\n    opacity: 0.9,\n  },\n  streakBadge: {\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    backgroundColor: \"rgba(255, 255, 255, 0.2)\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  card: {\n    backgroundColor: Colors.dark.backgroundDefault,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    marginBottom: Spacing.xl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  cardHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  cardTitle: {\n    ...Typography.h3,\n    flex: 1,\n  },\n  completedInfo: {\n    paddingVertical: Spacing.md,\n  },\n  completedStats: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n    gap: Spacing.md,\n  },\n  completedStat: {\n    flex: 1,\n    alignItems: \"center\",\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  completedStatValue: {\n    ...Typography.h2,\n    color: Colors.dark.primary,\n  },\n  completedStatLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  workoutInfo: {\n    gap: Spacing.lg,\n    marginBottom: Spacing.xl,\n  },\n  infoRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n  },\n  infoContent: {\n    flex: 1,\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  infoLabel: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n  infoValue: {\n    ...Typography.bodyLarge,\n    fontWeight: \"600\",\n  },\n  statsGrid: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  statCard: {\n    flex: 1,\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  statIconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: Colors.dark.backgroundTertiary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  statValue: {\n    ...Typography.h2,\n    color: Colors.dark.primary,\n  },\n  statLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    textAlign: \"center\",\n  },\n  quickStats: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n    gap: Spacing.md,\n  },\n  quickStat: {\n    flex: 1,\n    alignItems: \"center\",\n    backgroundColor: Colors.dark.backgroundSecondary,\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  quickStatIconContainer: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    backgroundColor: Colors.dark.backgroundTertiary,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  quickStatValue: {\n    ...Typography.h3,\n    fontWeight: \"700\",\n    color: Colors.dark.text,\n  },\n  quickStatLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  primaryButton: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    overflow: \"hidden\",\n  },\n  buttonPressed: {\n    opacity: 0.8,\n  },\n  buttonGradient: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    ...Typography.button,\n    color: Colors.dark.buttonText,\n  },\n  secondaryButton: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.xl,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.xl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n  },\n  secondaryButtonText: {\n    ...Typography.button,\n    color: Colors.dark.primary,\n  },\n  adBanner: {\n    marginBottom: Spacing.xl,\n  },\n});\n","size_bytes":13349},"components/ScreenScrollView.tsx":{"content":"import { ScrollView, ScrollViewProps, StyleSheet } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport function ScreenScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  ...scrollViewProps\n}: ScrollViewProps) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  return (\n    <ScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      {...scrollViewProps}\n    >\n      {children}\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","size_bytes":1043},"hooks/useTheme.ts":{"content":"import { Colors } from \"@/constants/theme\";\nimport { useColorScheme } from \"@/hooks/useColorScheme\";\n\nexport function useTheme() {\n  const colorScheme = useColorScheme();\n  const isDark = colorScheme === \"dark\";\n  const theme = Colors[colorScheme ?? \"light\"];\n\n  return {\n    theme,\n    isDark,\n  };\n}\n","size_bytes":302},"navigation/screenOptions.ts":{"content":"import { Platform } from \"react-native\";\nimport { NativeStackNavigationOptions } from \"@react-navigation/native-stack\";\nimport { isLiquidGlassAvailable } from \"expo-glass-effect\";\n\ninterface ScreenOptionsParams {\n  theme: {\n    backgroundRoot: string;\n    text: string;\n  };\n  isDark: boolean;\n  transparent?: boolean;\n}\n\nexport const getCommonScreenOptions = ({\n  theme,\n  isDark,\n  transparent = true,\n}: ScreenOptionsParams): NativeStackNavigationOptions => ({\n  headerTitleAlign: \"center\",\n  headerTransparent: transparent,\n  headerBlurEffect: isDark ? \"dark\" : \"light\",\n  headerTintColor: theme.text,\n  headerStyle: {\n    backgroundColor: Platform.select({\n      ios: undefined,\n      android: theme.backgroundRoot,\n      web: theme.backgroundRoot,\n    }),\n  },\n  gestureEnabled: true,\n  gestureDirection: \"horizontal\",\n  fullScreenGestureEnabled: isLiquidGlassAvailable() ? false : true,\n  contentStyle: {\n    backgroundColor: theme.backgroundRoot,\n  },\n});\n","size_bytes":964},"constants/theme.ts":{"content":"import { Platform } from \"react-native\";\n\nexport const Colors = {\n  light: {\n    text: \"#11181C\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#687076\",\n    tabIconSelected: \"#00C853\",\n    link: \"#00C853\",\n    backgroundRoot: \"#FFFFFF\",\n    backgroundDefault: \"#F2F2F2\",\n    backgroundSecondary: \"#E6E6E6\",\n    backgroundTertiary: \"#D9D9D9\",\n  },\n  dark: {\n    text: \"#FFFFFF\",\n    textSecondary: \"#A0A0A0\",\n    textTertiary: \"#707070\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#707070\",\n    tabIconSelected: \"#00C853\",\n    link: \"#00C853\",\n    backgroundRoot: \"#0A0A0A\",\n    backgroundDefault: \"#161616\",\n    backgroundSecondary: \"#202020\",\n    backgroundTertiary: \"#2C2C2C\",\n    primary: \"#00C853\",\n    primaryDark: \"#00A844\",\n    secondary: \"#00E676\",\n    success: \"#00E676\",\n    warning: \"#FFD93D\",\n    error: \"#FF5252\",\n    premium: \"#FFD700\",\n    border: \"#2A2A2A\",\n  },\n};\n\nexport const Spacing = {\n  xs: 4,\n  sm: 8,\n  md: 16,\n  lg: 24,\n  xl: 32,\n  xxl: 48,\n  inputHeight: 48,\n  buttonHeight: 52,\n  tabBarHeight: 65,\n};\n\nexport const BorderRadius = {\n  xs: 8,\n  sm: 12,\n  md: 16,\n  lg: 24,\n  xl: 26,\n  full: 9999,\n};\n\nexport const Typography = {\n  h1: {\n    fontSize: 32,\n    fontWeight: \"700\" as const,\n  },\n  h2: {\n    fontSize: 24,\n    fontWeight: \"700\" as const,\n  },\n  h3: {\n    fontSize: 20,\n    fontWeight: \"600\" as const,\n  },\n  bodyLarge: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n  body: {\n    fontSize: 14,\n    fontWeight: \"400\" as const,\n  },\n  caption: {\n    fontSize: 12,\n    fontWeight: \"500\" as const,\n  },\n  button: {\n    fontSize: 16,\n    fontWeight: \"600\" as const,\n  },\n};\n\nexport const Fonts = Platform.select({\n  ios: {\n    /** iOS `UIFontDescriptorSystemDesignDefault` */\n    sans: \"system-ui\",\n    /** iOS `UIFontDescriptorSystemDesignSerif` */\n    serif: \"ui-serif\",\n    /** iOS `UIFontDescriptorSystemDesignRounded` */\n    rounded: \"ui-rounded\",\n    /** iOS `UIFontDescriptorSystemDesignMonospaced` */\n    mono: \"ui-monospace\",\n  },\n  default: {\n    sans: \"normal\",\n    serif: \"serif\",\n    rounded: \"normal\",\n    mono: \"monospace\",\n  },\n  web: {\n    sans: \"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n    serif: \"Georgia, 'Times New Roman', serif\",\n    rounded:\n      \"'SF Pro Rounded', 'Hiragino Maru Gothic ProN', Meiryo, 'MS PGothic', sans-serif\",\n    mono: \"SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\n  },\n});\n","size_bytes":2469},"components/ScreenKeyboardAwareScrollView.tsx":{"content":"import { Platform, StyleSheet } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\nimport { ScreenScrollView } from \"./ScreenScrollView\";\n\nexport function ScreenKeyboardAwareScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  keyboardShouldPersistTaps = \"handled\",\n  ...scrollViewProps\n}: KeyboardAwareScrollViewProps) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  /**\n   * KeyboardAwareScrollView isn't compatible with web (it relies on native APIs), so the code falls back to ScreenScrollView on web to avoid runtime errors.\n   */\n  if (Platform.OS === \"web\") {\n    return (\n      <ScreenScrollView\n        style={style}\n        contentContainerStyle={contentContainerStyle}\n        keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n        {...scrollViewProps}\n      >\n        {children}\n      </ScreenScrollView>\n    );\n  }\n\n  return (\n    <KeyboardAwareScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...scrollViewProps}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","size_bytes":1813},"components/HeaderTitle.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Image } from \"react-native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Spacing } from \"@/constants/theme\";\n\ninterface HeaderTitleProps {\n  title: string;\n}\n\nexport function HeaderTitle({ title }: HeaderTitleProps) {\n  return (\n    <View style={styles.container}>\n      <Image\n        source={require(\"../assets/images/icon.png\")}\n        style={styles.icon}\n        resizeMode=\"contain\"\n      />\n      <ThemedText style={styles.title}>{title}</ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n  icon: {\n    width: 28,\n    height: 28,\n    marginRight: Spacing.sm,\n  },\n  title: {\n    fontSize: 17,\n    fontWeight: \"600\",\n  },\n});\n","size_bytes":829},"lib/supabase-service.ts":{"content":"import { supabase } from './supabase';\nimport type { User } from '@/types/auth';\nimport type { Workout, UserStats, Achievement, Academy, RankingUser } from '@/utils/storage';\n\nexport type SupabaseProfile = {\n  id: string;\n  email: string;\n  name: string;\n  avatar: string;\n  age: number;\n  weight: number;\n  height: number;\n  goal: 'hypertrophy' | 'weight_loss' | 'endurance' | 'beginner';\n  level: 'beginner' | 'intermediate' | 'advanced';\n  time_available: number;\n  weekly_frequency: 2 | 3 | 4 | 5 | 6;\n  location: 'home' | 'gym';\n  equipment: string[];\n  academy_id?: string;\n  is_premium: boolean;\n  selected_plan?: 'ABC' | 'ABCD' | 'FullBody' | 'UpperLower';\n  onboarding_complete: boolean;\n  created_at: string;\n  updated_at: string;\n};\n\nfunction snakeToCamel(obj: any): any {\n  if (Array.isArray(obj)) {\n    return obj.map(snakeToCamel);\n  } else if (obj !== null && typeof obj === 'object') {\n    return Object.keys(obj).reduce((acc, key) => {\n      const camelKey = key.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n      acc[camelKey] = snakeToCamel(obj[key]);\n      return acc;\n    }, {} as any);\n  }\n  return obj;\n}\n\nfunction camelToSnake(obj: any): any {\n  if (Array.isArray(obj)) {\n    return obj.map(camelToSnake);\n  } else if (obj !== null && typeof obj === 'object') {\n    return Object.keys(obj).reduce((acc, key) => {\n      const snakeKey = key.replace(/([A-Z])/g, '_$1').toLowerCase();\n      acc[snakeKey] = camelToSnake(obj[key]);\n      return acc;\n    }, {} as any);\n  }\n  return obj;\n}\n\nfunction profileToUser(profile: SupabaseProfile): User {\n  return {\n    id: profile.id,\n    name: profile.name,\n    email: profile.email,\n    avatar: profile.avatar,\n    age: profile.age,\n    weight: profile.weight,\n    height: profile.height,\n    goal: profile.goal,\n    level: profile.level,\n    timeAvailable: profile.time_available,\n    weeklyFrequency: profile.weekly_frequency,\n    location: profile.location,\n    equipment: profile.equipment,\n    academy: profile.academy_id ? {\n      id: profile.academy_id,\n      name: '',\n    } : undefined,\n    isPremium: profile.is_premium,\n    selectedPlan: profile.selected_plan,\n  };\n}\n\nexport const supabaseService = {\n  async getProfile(userId: string): Promise<User | null> {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', userId)\n      .single();\n\n    if (error) {\n      console.error('Error fetching profile:', error);\n      return null;\n    }\n\n    return data ? profileToUser(data as SupabaseProfile) : null;\n  },\n\n  async createProfile(profile: Partial<User>): Promise<User | null> {\n    const snakeProfile = camelToSnake(profile);\n    \n    // Set default values\n    const profileData = {\n      ...snakeProfile,\n      is_premium: false,\n      onboarding_complete: false,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    };\n    \n    const { data, error } = await supabase\n      .from('profiles')\n      .insert(profileData)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error creating profile:', error);\n      throw new Error('Falha ao criar perfil');\n    }\n\n    return data ? profileToUser(data as SupabaseProfile) : null;\n  },\n\n  async updateProfile(userId: string, updates: Partial<User>): Promise<User | null> {\n    const snakeUpdates = camelToSnake(updates);\n    \n    const { data, error } = await supabase\n      .from('profiles')\n      .update(snakeUpdates)\n      .eq('id', userId)\n      .select()\n      .single();\n\n    if (error) {\n      console.error('Error updating profile:', error);\n      throw new Error('Falha ao atualizar perfil');\n    }\n\n    return data ? profileToUser(data as SupabaseProfile) : null;\n  },\n\n  async getOnboardingStatus(userId: string): Promise<boolean> {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('onboarding_complete')\n      .eq('id', userId)\n      .single();\n\n    if (error) {\n      console.error('Error fetching onboarding status:', error);\n      return false;\n    }\n\n    return data?.onboarding_complete || false;\n  },\n\n  async setOnboardingComplete(userId: string, complete: boolean): Promise<void> {\n    const { error } = await supabase\n      .from('profiles')\n      .update({ onboarding_complete: complete })\n      .eq('id', userId);\n\n    if (error) {\n      console.error('Error updating onboarding status:', error);\n      throw new Error('Falha ao atualizar status do onboarding');\n    }\n  },\n\n  async getWorkouts(userId: string): Promise<Workout[]> {\n    const { data, error } = await supabase\n      .from('workouts')\n      .select('*')\n      .eq('user_id', userId)\n      .order('date', { ascending: false });\n\n    if (error) {\n      console.error('Error fetching workouts:', error);\n      return [];\n    }\n\n    return (data || []).map(w => ({\n      id: w.id,\n      date: w.date,\n      exercises: w.exercises,\n      duration: w.duration,\n      points: w.points,\n      calories: w.calories,\n      completed: w.completed,\n      startTime: w.start_time,\n      endTime: w.end_time,\n    }));\n  },\n\n  async saveWorkout(workout: Workout, userId: string): Promise<void> {\n    const { error } = await supabase\n      .from('workouts')\n      .insert({\n        user_id: userId,\n        date: workout.date,\n        exercises: workout.exercises,\n        duration: workout.duration,\n        points: workout.points,\n        calories: workout.calories,\n        completed: workout.completed,\n        start_time: workout.startTime,\n        end_time: workout.endTime,\n      });\n\n    if (error) {\n      console.error('Error saving workout:', error);\n      throw new Error('Falha ao salvar treino');\n    }\n  },\n\n  async getUserStats(userId: string): Promise<UserStats> {\n    const { data, error } = await supabase\n      .from('user_stats')\n      .select('*')\n      .eq('user_id', userId)\n      .single();\n\n    if (error) {\n      console.error('Error fetching user stats:', error);\n      return {\n        totalWorkouts: 0,\n        totalPoints: 0,\n        currentStreak: 0,\n        bestStreak: 0,\n        weeklyPoints: 0,\n        monthlyPoints: 0,\n      };\n    }\n\n    return {\n      totalWorkouts: data.total_workouts || 0,\n      totalPoints: data.total_points || 0,\n      currentStreak: data.current_streak || 0,\n      bestStreak: data.best_streak || 0,\n      weeklyPoints: data.weekly_points || 0,\n      monthlyPoints: data.monthly_points || 0,\n      lastWorkoutDate: data.last_workout_date,\n      weeklyWorkoutsCount: data.weekly_workouts_count || 0,\n      weekStartDate: data.week_start_date,\n    };\n  },\n\n  async updateUserStats(userId: string, updates: Partial<UserStats>): Promise<void> {\n    const snakeUpdates = camelToSnake(updates);\n    \n    const { error } = await supabase\n      .from('user_stats')\n      .update(snakeUpdates)\n      .eq('user_id', userId);\n\n    if (error) {\n      console.error('Error updating user stats:', error);\n      throw new Error('Falha ao atualizar estatísticas');\n    }\n  },\n\n  async getAchievements(userId: string): Promise<Achievement[]> {\n    const { data, error } = await supabase\n      .from('achievements')\n      .select('*')\n      .eq('user_id', userId);\n\n    if (error) {\n      console.error('Error fetching achievements:', error);\n      return [];\n    }\n\n    return (data || []).map(a => ({\n      id: a.achievement_id,\n      name: a.name,\n      description: a.description,\n      icon: a.icon,\n      earned: a.earned,\n      earnedDate: a.earned_date,\n      points: a.points,\n    }));\n  },\n\n  async initializeDefaultAchievements(userId: string): Promise<void> {\n    const defaultAchievements = [\n      { id: 'first-workout', name: 'Primeiro Treino', description: 'Complete seu primeiro treino', icon: 'first-workout' },\n      { id: 'streak-7', name: 'Semana Completa', description: 'Treine por 7 dias seguidos', icon: 'streak-7' },\n      { id: 'workouts-30', name: '30 Treinos', description: 'Complete 30 treinos', icon: 'workouts-30' },\n      { id: 'top-3', name: 'Top 3', description: 'Fique entre os 3 primeiros da sua academia', icon: 'top-3' },\n      { id: 'points-5000', name: '5000 Pontos', description: 'Acumule 5000 pontos', icon: 'points-5000' },\n      { id: 'workouts-100', name: '100 Treinos', description: 'Complete 100 treinos', icon: 'workouts-100' },\n      { id: 'streak-30', name: 'Mês Perfeito', description: 'Treine por 30 dias seguidos', icon: 'streak-30' },\n      { id: 'perfect-week', name: 'Semana Perfeita', description: 'Complete todos os treinos planejados em uma semana', icon: 'perfect-week' },\n      { id: 'champion', name: 'Campeão', description: 'Seja o primeiro colocado da sua academia', icon: 'champion' },\n      { id: 'premium', name: 'Premium', description: 'Assine o plano Premium', icon: 'premium' },\n    ];\n\n    const achievementsToInsert = defaultAchievements.map(a => ({\n      user_id: userId,\n      achievement_id: a.id,\n      name: a.name,\n      description: a.description,\n      icon: a.icon,\n      earned: false,\n    }));\n\n    const { error } = await supabase\n      .from('achievements')\n      .insert(achievementsToInsert);\n\n    if (error && !error.message.includes('duplicate')) {\n      console.error('Error initializing achievements:', error);\n    }\n  },\n\n  async unlockAchievement(userId: string, achievementId: string): Promise<void> {\n    const { error } = await supabase\n      .from('achievements')\n      .update({\n        earned: true,\n        earned_date: new Date().toISOString(),\n      })\n      .eq('user_id', userId)\n      .eq('achievement_id', achievementId);\n\n    if (error) {\n      console.error('Error unlocking achievement:', error);\n    }\n  },\n\n  async getAcademies(): Promise<Academy[]> {\n    const { data, error } = await supabase\n      .from('academies')\n      .select('*')\n      .order('name');\n\n    if (error) {\n      console.error('Error fetching academies:', error);\n      return [];\n    }\n\n    return (data || []).map(a => ({\n      id: a.id,\n      name: a.name,\n      address: a.address || '',\n      memberCount: a.member_count || 0,\n    }));\n  },\n\n  async getAcademyRanking(academyId: string, currentUserId: string): Promise<RankingUser[]> {\n    const { data, error } = await supabase\n      .rpc('get_academy_ranking', { academy_uuid: academyId });\n\n    if (error) {\n      console.error('Error fetching ranking:', error);\n      return [];\n    }\n\n    return (data || []).map((r: any) => ({\n      id: r.id,\n      name: r.name,\n      avatar: r.avatar,\n      points: r.points,\n      weeklyPoints: r.weekly_points,\n      monthlyPoints: r.monthly_points,\n      rank: r.rank,\n      isCurrentUser: r.id === currentUserId,\n    }));\n  },\n\n  async completeWorkout(workout: Workout, userId: string): Promise<Achievement[]> {\n    await this.saveWorkout(workout, userId);\n    \n    const stats = await this.getUserStats(userId);\n    const updatedStats: Partial<UserStats> = {\n      totalWorkouts: stats.totalWorkouts + 1,\n      totalPoints: stats.totalPoints + workout.points,\n      weeklyPoints: stats.weeklyPoints + workout.points,\n      monthlyPoints: stats.monthlyPoints + workout.points,\n      lastWorkoutDate: workout.date,\n      weeklyWorkoutsCount: (stats.weeklyWorkoutsCount || 0) + 1,\n    };\n\n    const lastWorkout = stats.lastWorkoutDate ? new Date(stats.lastWorkoutDate) : null;\n    const today = new Date(workout.date);\n    \n    if (lastWorkout) {\n      const diffDays = Math.floor((today.getTime() - lastWorkout.getTime()) / (1000 * 60 * 60 * 24));\n      if (diffDays === 1) {\n        updatedStats.currentStreak = stats.currentStreak + 1;\n        updatedStats.bestStreak = Math.max(stats.bestStreak, updatedStats.currentStreak);\n      } else if (diffDays > 1) {\n        updatedStats.currentStreak = 1;\n      }\n    } else {\n      updatedStats.currentStreak = 1;\n      updatedStats.bestStreak = 1;\n    }\n\n    await this.updateUserStats(userId, updatedStats);\n\n    const newlyUnlocked = await this.checkAndUnlockAchievements(updatedStats as UserStats, userId);\n    return newlyUnlocked;\n  },\n\n  async checkAndUnlockAchievements(stats: UserStats, userId: string): Promise<Achievement[]> {\n    const achievements = await this.getAchievements(userId);\n    const newlyUnlocked: Achievement[] = [];\n\n    for (const achievement of achievements) {\n      if (!achievement.earned) {\n        let shouldUnlock = false;\n\n        switch (achievement.id) {\n          case 'first-workout':\n            shouldUnlock = stats.totalWorkouts >= 1;\n            break;\n          case 'streak-7':\n            shouldUnlock = stats.currentStreak >= 7;\n            break;\n          case 'workouts-30':\n            shouldUnlock = stats.totalWorkouts >= 30;\n            break;\n          case 'points-5000':\n            shouldUnlock = stats.totalPoints >= 5000;\n            break;\n          case 'workouts-100':\n            shouldUnlock = stats.totalWorkouts >= 100;\n            break;\n          case 'streak-30':\n            shouldUnlock = stats.currentStreak >= 30;\n            break;\n          case 'perfect-week':\n            shouldUnlock = (stats.weeklyWorkoutsCount || 0) >= 7;\n            break;\n        }\n\n        if (shouldUnlock) {\n          await this.unlockAchievement(userId, achievement.id);\n          newlyUnlocked.push(achievement);\n        }\n      }\n    }\n\n    return newlyUnlocked;\n  },\n\n  async canGenerateWorkout(userId: string, isPremium: boolean): Promise<{ canGenerate: boolean; remaining: number }> {\n    if (isPremium) {\n      return { canGenerate: true, remaining: -1 };\n    }\n\n    const stats = await this.getUserStats(userId);\n    const weeklyWorkouts = stats.weeklyWorkoutsCount || 0;\n    const FREE_WEEKLY_LIMIT = 2;\n\n    return {\n      canGenerate: weeklyWorkouts < FREE_WEEKLY_LIMIT,\n      remaining: FREE_WEEKLY_LIMIT - weeklyWorkouts,\n    };\n  },\n};\n","size_bytes":13731},"QUICK_START_LOCAL.md":{"content":"# ⚡ QUICK START - Rodar FitRank+ Localmente\n\n## 🎯 OPÇÃO 1: Script Automático (MAIS RÁPIDO)\n\n### **Windows:**\n1. Baixe o projeto (ZIP ou Git)\n2. Abra o prompt de comando na pasta do projeto\n3. Execute:\n```cmd\nsetup-local.bat\n```\n\n### **Linux/Mac:**\n1. Baixe o projeto (ZIP ou Git)\n2. Abra o terminal na pasta do projeto\n3. Execute:\n```bash\nchmod +x setup-local.sh\n./setup-local.sh\n```\n\n---\n\n## 🎯 OPÇÃO 2: Manual (Passo a Passo)\n\n### **1. Instalar dependências:**\n```bash\nnpm install\n```\n\n### **2. Criar arquivo `.env` com:**\n```\nEXPO_PUBLIC_SUPABASE_URL=https://clwspdnaafuvjdhjhrpn.supabase.co\nEXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsd3NwZG5hYWZ1dmpkaGpocnBuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5NDEzMTksImV4cCI6MjA3OTUxNzMxOX0.oeOPYysYYFMmcsmMt8sHiqnEejNtNZ5cJFa48fxXUFg\n```\n\n### **3. Iniciar emulador Android Studio ou conectar celular USB**\n\n### **4. Rodar o app:**\n```bash\nnpx expo run:android\n```\n\n---\n\n## 📖 GUIA COMPLETO\n\nLeia: **ANDROID_STUDIO_SETUP.md** para instruções detalhadas.\n\n---\n\n## 🆘 PROBLEMAS?\n\n**App crasha ao abrir:**\n- Verifique se o arquivo `.env` existe\n- Verifique se as variáveis estão corretas\n- Veja os logs no terminal\n\n**Erro de compilação:**\n```bash\ncd android\n./gradlew clean\ncd ..\nnpx expo run:android\n```\n\n**Emulador não aparece:**\n```bash\nadb devices\n```\n\nSe vazio, inicie o emulador no Android Studio primeiro.\n","size_bytes":1435},"SETUP_SUPABASE.md":{"content":"# Configuração Completa do Supabase + Google OAuth\n\n## 📋 Visão Geral\n\nEste documento contém todas as etapas necessárias para configurar o Supabase como backend do FitRank+ e habilitar Google Sign-In.\n\n**O que já está pronto:**\n- ✅ Cliente Supabase configurado (`lib/supabase.ts`)\n- ✅ Schema SQL com todas as tabelas (`supabase-schema.sql`)\n- ✅ Camada de serviços para CRUD (`lib/supabase-service.ts`)\n- ✅ Hook de autenticação com Google OAuth (`hooks/useSupabaseAuth.ts`)\n- ✅ Variáveis de ambiente configuradas no Replit Secrets\n\n**O que você precisa fazer:**\n1. Executar o SQL para criar as tabelas no Supabase\n2. (Opcional) Configurar Google OAuth no Google Cloud Console\n\n---\n\n## 🗄️ PASSO 1: Criar Tabelas no Supabase\n\n### 1.1. Acesse o SQL Editor\n\n1. Vá para https://supabase.com/dashboard\n2. Selecione seu projeto **fitrank-plus**\n3. No menu lateral esquerdo, clique em **SQL Editor**\n\n### 1.2. Execute o Schema SQL\n\n1. Clique em **\"New query\"** (botão verde no canto superior direito)\n2. Abra o arquivo `supabase-schema.sql` neste projeto\n3. **Copie TODO o conteúdo** do arquivo (são ~350 linhas)\n4. Cole no SQL Editor do Supabase\n5. Clique em **\"Run\"** (ou pressione `Ctrl+Enter` / `Cmd+Enter`)\n\n### 1.3. Verifique se deu certo\n\nVocê deve ver a mensagem:\n```\nSuccess. No rows returned\n```\n\nDepois, no menu lateral, clique em **\"Table Editor\"**. Você deve ver estas tabelas:\n- ✅ **profiles** - Dados do perfil dos usuários\n- ✅ **workouts** - Treinos realizados\n- ✅ **user_stats** - Estatísticas e progressão\n- ✅ **achievements** - Conquistas desbloqueadas\n- ✅ **academies** - Academias cadastradas (com 5 academias seed)\n\n**✨ Pronto! Seu banco de dados está configurado.**\n\n---\n\n## 🔐 PASSO 2: Configurar Google OAuth (OPCIONAL)\n\nSe você quiser que os usuários façam login com Google, siga os passos abaixo. **Caso contrário, pule para o Passo 3.**\n\n### 2.1. Google Cloud Console\n\n1. **Acesse:** https://console.cloud.google.com/\n\n2. **Crie um projeto:**\n   - Clique em \"Select a project\" (topo da página)\n   - Clique em \"New Project\"\n   - Nome: `FitRank Plus`\n   - Clique em \"Create\"\n\n3. **Ative a API Google+:**\n   - Menu lateral: **APIs & Services** → **Library**\n   - Procure: `Google+ API`\n   - Clique em \"Enable\"\n\n### 2.2. Tela de Consentimento OAuth\n\n1. **Vá para:** Menu lateral → **APIs & Services** → **OAuth consent screen**\n\n2. **Configure:**\n   - Tipo: **External**\n   - App name: `FitRank+`\n   - User support email: [seu email]\n   - Developer contact: [seu email]\n   - Clique em \"Save and Continue\"\n\n3. **Scopes:**\n   - Clique em \"Add or Remove Scopes\"\n   - Selecione:\n     - `.../auth/userinfo.email`\n     - `.../auth/userinfo.profile`\n   - Clique em \"Update\" → \"Save and Continue\"\n\n4. **Test Users (opcional):**\n   - Adicione seu email como test user\n   - Clique em \"Save and Continue\"\n\n### 2.3. Criar Client IDs\n\n#### Web Client ID (OBRIGATÓRIO)\n\n1. **Menu:** **APIs & Services** → **Credentials**\n2. Clique em **\"Create Credentials\"** → **\"OAuth client ID\"**\n3. Configurações:\n   - Application type: **Web application**\n   - Name: `FitRank+ Web`\n   - Authorized JavaScript origins:\n     ```\n     https://localhost:19006\n     ```\n   - Authorized redirect URIs:\n     ```\n     https://auth.expo.io/@SEU_USERNAME_EXPO/fitrank-plus\n     https://localhost:19006\n     ```\n4. Clique em **\"Create\"**\n5. **COPIE o Client ID** (formato: `123456789-abc...apps.googleusercontent.com`)\n\n#### iOS Client ID (Opcional - para builds nativos)\n\n1. Clique em **\"Create Credentials\"** → **\"OAuth client ID\"**\n2. Configurações:\n   - Application type: **iOS**\n   - Name: `FitRank+ iOS`\n   - Bundle ID: `com.fitrankplus.app`\n3. Clique em \"Create\"\n4. **COPIE o Client ID**\n\n#### Android Client ID (Opcional - para builds nativos)\n\n1. Clique em **\"Create Credentials\"** → **\"OAuth client ID\"**\n2. Configurações:\n   - Application type: **Android**\n   - Name: `FitRank+ Android`\n   - Package name: `com.fitrankplus.app`\n   - SHA-1 fingerprint: (deixe em branco por enquanto)\n3. Clique em \"Create\"\n4. **COPIE o Client ID**\n\n### 2.4. Configurar Client IDs no Replit\n\nDepois de ter os Client IDs do Google, me envie neste formato:\n\n```\nWeb Client ID: 123456789-abcdefgh.apps.googleusercontent.com\niOS Client ID: (se tiver)\nAndroid Client ID: (se tiver)\n```\n\nVou configurá-los como secrets seguros no Replit.\n\n---\n\n## 📝 PASSO 3: Teste a Configuração\n\nDepois de executar o SQL, me avise dizendo:\n\n> \"Executei o SQL no Supabase. As tabelas foram criadas com sucesso!\"\n\nOu, se tiver algum erro, copie a mensagem de erro e me envie.\n\n---\n\n## 🎯 Próximos Passos\n\nApós você confirmar que o SQL foi executado com sucesso, eu vou:\n\n1. ✅ Integrar o novo sistema de autenticação Supabase no app\n2. ✅ Substituir todos os pontos que usam AsyncStorage pelo Supabase\n3. ✅ Adicionar o botão \"Continuar com Google\" na tela de login\n4. ✅ Testar login, cadastro e Google Sign-In end-to-end\n5. ✅ Atualizar o README com a nova arquitetura\n\n---\n\n## 🐛 Problemas Comuns\n\n### \"Row Level Security policy violation\"\n- Significa que as políticas RLS estão funcionando corretamente\n- Verifique se o usuário está autenticado antes de acessar dados\n\n### \"relation 'profiles' does not exist\"\n- Você não executou o SQL no Supabase ainda\n- Volte ao Passo 1.2 e execute o schema completo\n\n### Google OAuth: \"redirect_uri_mismatch\"\n- Verifique se adicionou `https://auth.expo.io/@SEU_USERNAME/fitrank-plus` nos redirect URIs\n- Substitua `SEU_USERNAME` pelo seu username do Expo\n\n### Google OAuth: \"invalid_client\"\n- Verifique se copiou o **Web Client ID** corretamente\n- Certifique-se de usar o Web Client ID, não o iOS/Android\n\n---\n\n## 📚 Referências\n\n- **Supabase Docs:** https://supabase.com/docs\n- **Expo Auth Session:** https://docs.expo.dev/versions/latest/sdk/auth-session/\n- **Google Cloud Console:** https://console.cloud.google.com/\n- **Expo + Supabase Guide:** https://supabase.com/docs/guides/getting-started/tutorials/with-expo-react-native\n\n---\n\n## ✅ Checklist Final\n\nAntes de prosseguir, confirme:\n\n- [ ] Executei o SQL no Supabase SQL Editor\n- [ ] Vi a mensagem \"Success. No rows returned\"\n- [ ] Verifiquei que as 5 tabelas foram criadas no Table Editor\n- [ ] (Opcional) Configurei Google OAuth e copiei os Client IDs\n\n**Quando tudo estiver pronto, me avise e vou continuar a integração!** 🚀\n","size_bytes":6392},"setup-local.sh":{"content":"#!/bin/bash\n\necho \"🚀 FitRank+ - Setup Local para Android Studio\"\necho \"==============================================\"\necho \"\"\n\n# Verificar Node.js\necho \"📦 Verificando Node.js...\"\nif ! command -v node &> /dev/null; then\n    echo \"❌ Node.js não encontrado. Instale em: https://nodejs.org\"\n    exit 1\nfi\necho \"✅ Node.js $(node --version) instalado\"\necho \"\"\n\n# Verificar npm\necho \"📦 Verificando npm...\"\nif ! command -v npm &> /dev/null; then\n    echo \"❌ npm não encontrado\"\n    exit 1\nfi\necho \"✅ npm $(npm --version) instalado\"\necho \"\"\n\n# Instalar dependências\necho \"📥 Instalando dependências...\"\nnpm install\necho \"✅ Dependências instaladas\"\necho \"\"\n\n# Criar arquivo .env se não existir\nif [ ! -f .env ]; then\n    echo \"📝 Criando arquivo .env...\"\n    cat > .env << 'EOF'\nEXPO_PUBLIC_SUPABASE_URL=https://clwspdnaafuvjdhjhrpn.supabase.co\nEXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsd3NwZG5hYWZ1dmpkaGpocnBuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5NDEzMTksImV4cCI6MjA3OTUxNzMxOX0.oeOPYysYYFMmcsmMt8sHiqnEejNtNZ5cJFa48fxXUFg\nEXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID=222196005724-hsduk810apqv8425nbmo4g4p5hffsh7e.apps.googleusercontent.com\nEXPO_PUBLIC_GOOGLE_CLIENT_SECRET=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\nEOF\n    echo \"✅ Arquivo .env criado\"\nelse\n    echo \"ℹ️  Arquivo .env já existe\"\nfi\necho \"\"\n\n# Verificar ADB\necho \"📱 Verificando ADB (Android Debug Bridge)...\"\nif command -v adb &> /dev/null; then\n    echo \"✅ ADB instalado\"\n    echo \"\"\n    echo \"📱 Dispositivos conectados:\"\n    adb devices\nelse\n    echo \"⚠️  ADB não encontrado. Instale Android Studio primeiro.\"\nfi\necho \"\"\n\necho \"✅ Setup concluído!\"\necho \"\"\necho \"🎯 Próximos passos:\"\necho \"1. Abra Android Studio\"\necho \"2. Inicie um emulador ou conecte um celular via USB\"\necho \"3. Execute: npx expo run:android\"\necho \"\"\necho \"📖 Leia o guia completo em: ANDROID_STUDIO_SETUP.md\"\necho \"\"\n","size_bytes":1946},"GOOGLE_OAUTH_SETUP.md":{"content":"# Configuração do Google OAuth para FitRank+\n\n## Passo 1: Configurar Google Cloud Console\n\n1. **Acesse o Google Cloud Console:**\n   - Vá para: https://console.cloud.google.com/\n\n2. **Crie um novo projeto (ou selecione existente):**\n   - Clique em \"Select a project\" no topo\n   - Clique em \"New Project\"\n   - Nome: `FitRank Plus`\n   - Clique em \"Create\"\n\n3. **Ative a API do Google+:**\n   - No menu lateral, vá em **APIs & Services** → **Library**\n   - Procure por \"Google+ API\"\n   - Clique e depois clique em \"Enable\"\n\n## Passo 2: Configurar Tela de Consentimento OAuth\n\n1. **Vá para OAuth consent screen:**\n   - No menu lateral: **APIs & Services** → **OAuth consent screen**\n\n2. **Escolha o tipo de usuário:**\n   - Selecione **External**\n   - Clique em \"Create\"\n\n3. **Preencha as informações:**\n   - App name: `FitRank+`\n   - User support email: Seu email\n   - Developer contact: Seu email\n   - Clique em \"Save and Continue\"\n\n4. **Scopes:**\n   - Clique em \"Add or Remove Scopes\"\n   - Adicione: `.../auth/userinfo.email` e `.../auth/userinfo.profile`\n   - Clique em \"Update\" e depois \"Save and Continue\"\n\n5. **Test users (opcional para desenvolvimento):**\n   - Adicione seu email como test user\n   - Clique em \"Save and Continue\"\n\n## Passo 3: Criar Credenciais OAuth\n\n### Web Client ID\n\n1. **Crie credencial Web:**\n   - Vá em **APIs & Services** → **Credentials**\n   - Clique em \"Create Credentials\" → \"OAuth client ID\"\n   - Application type: **Web application**\n   - Name: `FitRank+ Web`\n   - Authorized JavaScript origins:\n     - `https://localhost:19006` (para desenvolvimento)\n   - Authorized redirect URIs:\n     - `https://auth.expo.io/@SEU_USERNAME/fitrank-plus`\n     - `https://localhost:19006`\n   - Clique em \"Create\"\n   - **COPIE o Client ID** (algo como `123456789-abc...apps.googleusercontent.com`)\n\n### iOS Client ID (opcional - para Expo Go e builds iOS)\n\n1. **Crie credencial iOS:**\n   - Clique em \"Create Credentials\" → \"OAuth client ID\"\n   - Application type: **iOS**\n   - Name: `FitRank+ iOS`\n   - Bundle ID: `com.fitrankplus.app`\n   - Clique em \"Create\"\n   - **COPIE o Client ID**\n\n### Android Client ID (opcional - para Expo Go e builds Android)\n\n1. **Crie credencial Android:**\n   - Clique em \"Create Credentials\" → \"OAuth client ID\"\n   - Application type: **Android**\n   - Name: `FitRank+ Android`\n   - Package name: `com.fitrankplus.app`\n   - SHA-1 certificate fingerprint: \n     - Para desenvolvimento com Expo Go, use: deixe em branco por enquanto\n   - Clique em \"Create\"\n   - **COPIE o Client ID**\n\n## Passo 4: Configurar no Replit\n\nDepois de ter os Client IDs, você precisa configurá-los no Replit. Me envie:\n\n1. **Web Client ID** (obrigatório)\n2. **iOS Client ID** (opcional)\n3. **Android Client ID** (opcional)\n\nFormato:\n```\nWeb Client ID: 123456789-abcdefgh.apps.googleusercontent.com\niOS Client ID: (se tiver)\nAndroid Client ID: (se tiver)\n```\n\n## Notas Importantes\n\n- **Para desenvolvimento local:** Você só precisa do Web Client ID\n- **Para builds nativos:** Você precisará dos Client IDs específicos de cada plataforma\n- **Expo Go:** Funciona melhor com Web Client ID\n- **Deep linking:** O scheme `fitrankplus://` já está configurado no app.json\n\n## Problemas Comuns\n\n### \"redirect_uri_mismatch\"\n- Verifique se o redirect URI no Google Console inclui: `https://auth.expo.io/@SEU_USERNAME/fitrank-plus`\n\n### \"invalid_client\"\n- Verifique se copiou o Client ID corretamente\n- Certifique-se de que está usando o Web Client ID\n\n### Botão não aparece\n- Verifique se as env vars foram configuradas corretamente\n- Reinicie o servidor Expo após configurar as variáveis\n","size_bytes":3630},"ANDROID_STUDIO_SETUP.md":{"content":"# 📱 GUIA: RODAR FITRANKPLUS NO ANDROID STUDIO\n\n## ✅ PRÉ-REQUISITOS\n\n### 1. **Android Studio Instalado**\n- Baixe em: https://developer.android.com/studio\n- Instale o Android SDK (vem junto)\n- Configure um emulador Android ou conecte um celular via USB\n\n### 2. **Node.js**\n- Versão 18+ instalada\n- Verifique: `node --version`\n\n### 3. **Git** (opcional, mas recomendado)\n- Para clonar o projeto\n\n---\n\n## 🚀 PASSO A PASSO\n\n### **PASSO 1: Baixar o Projeto**\n\n**Opção A - Via Git (RECOMENDADO):**\n```bash\ngit clone https://github.com/xinxatop/fitrank-plus.git\ncd fitrank-plus\n```\n\n**Opção B - Download ZIP:**\n1. No Replit, clique em \"⋮\" (três pontos) → \"Download as ZIP\"\n2. Extraia o ZIP em uma pasta no seu PC\n3. Abra o terminal nessa pasta\n\n---\n\n### **PASSO 2: Instalar Dependências**\n\n```bash\nnpm install\n```\n\nAguarde instalar tudo (2-3 minutos).\n\n---\n\n### **PASSO 3: Criar Arquivo de Variáveis de Ambiente**\n\nCrie um arquivo chamado `.env` na raiz do projeto com este conteúdo:\n\n```env\nEXPO_PUBLIC_SUPABASE_URL=https://clwspdnaafuvjdhjhrpn.supabase.co\nEXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsd3NwZG5hYWZ1dmpkaGpocnBuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5NDEzMTksImV4cCI6MjA3OTUxNzMxOX0.oeOPYysYYFMmcsmMt8sHiqnEejNtNZ5cJFa48fxXUFg\nEXPO_PUBLIC_GOOGLE_WEB_CLIENT_ID=222196005724-hsduk810apqv8425nbmo4g4p5hffsh7e.apps.googleusercontent.com\nEXPO_PUBLIC_GOOGLE_CLIENT_SECRET=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\n```\n\n**IMPORTANTE:** No Windows, use Notepad ou VS Code para criar o arquivo. Salve como `.env` (com o ponto na frente).\n\n---\n\n### **PASSO 4: Configurar Android Studio**\n\n1. **Abra Android Studio**\n2. **Configure o AVD Manager (Emulador):**\n   - Clique em: `Tools` → `Device Manager`\n   - Clique em `Create Device`\n   - Escolha: **Pixel 6** (ou qualquer Android moderno)\n   - API Level: **API 33** (Android 13) ou superior\n   - Clique em `Finish`\n   - Clique em `Play` ▶️ para iniciar o emulador\n\n**OU conecte seu celular via USB:**\n1. Ative modo desenvolvedor no celular:\n   - Vá em: `Configurações` → `Sobre o telefone`\n   - Toque 7x em `Número da versão`\n2. Ative: `Configurações` → `Opções do desenvolvedor` → `Depuração USB`\n3. Conecte o cabo USB\n4. Autorize o computador quando aparecer a mensagem\n\n---\n\n### **PASSO 5: Verificar Dispositivos Conectados**\n\nNo terminal, rode:\n```bash\nnpx expo run:android --device\n```\n\nVocê deve ver seu emulador ou celular listado.\n\n---\n\n### **PASSO 6: RODAR O APP!**\n\n```bash\nnpx expo run:android\n```\n\n**O que vai acontecer:**\n1. ⏱️ Expo vai compilar o projeto (5-10 minutos na primeira vez)\n2. 📱 Vai abrir o Android Studio automaticamente\n3. 🚀 Vai instalar o app no emulador/celular\n4. 📊 Terminal mostra TODOS os logs em tempo real\n5. ✅ App abre automaticamente\n\n---\n\n### **PASSO 7: Ver Logs em Tempo Real**\n\n**No Terminal:**\n- Todos os logs aparecem automaticamente\n- `console.log()` aparece aqui\n- Erros aparecem em vermelho\n\n**No Android Studio:**\n1. Clique em `View` → `Tool Windows` → `Logcat`\n2. Filtre por: `fitrankplus` ou `ReactNativeJS`\n3. Você verá TODOS os logs nativos + JavaScript\n\n---\n\n## 🐛 DEBUGGING\n\n### **Se der erro de compilação:**\n```bash\n# Limpar cache e rebuildar\ncd android\n./gradlew clean\ncd ..\nnpx expo run:android\n```\n\n### **Se o app crashar:**\n1. Olhe os logs no terminal\n2. Olhe o Logcat do Android Studio\n3. Procure por linhas com `ERROR` ou `FATAL`\n4. Me manda print desses erros!\n\n### **Se o emulador estiver lento:**\n- Feche outros apps\n- Dê mais RAM ao emulador (Android Studio → AVD Manager → Edit → Advanced → RAM)\n- Ou use seu celular físico (é mais rápido)\n\n---\n\n## 🔥 COMANDOS ÚTEIS\n\n```bash\n# Rodar no Android\nnpx expo run:android\n\n# Limpar cache\nnpm run clean\n\n# Reinstalar dependências\nrm -rf node_modules package-lock.json\nnpm install\n\n# Ver dispositivos conectados\nadb devices\n\n# Ver logs em tempo real\nnpx react-native log-android\n```\n\n---\n\n## 📊 O QUE FAZER QUANDO O APP ABRIR\n\n1. ✅ Veja se abre sem crashar\n2. ✅ Teste o Google Login\n3. ✅ Complete o onboarding\n4. ✅ Teste criar um treino\n5. ✅ Veja o ranking\n6. 📸 **Se der qualquer erro, copie os logs e me manda!**\n\n---\n\n## 🆘 PRECISA DE AJUDA?\n\n**Erros comuns:**\n\n**\"SDK location not found\"**\n```bash\n# Crie o arquivo android/local.properties com:\nsdk.dir=C:\\\\Users\\\\SEU_USUARIO\\\\AppData\\\\Local\\\\Android\\\\Sdk\n```\n\n**\"INSTALL_FAILED_INSUFFICIENT_STORAGE\"**\n- Libere espaço no emulador\n- Ou use um emulador com mais storage\n\n**\"Unable to load script\"**\n- Verifique se o Metro Bundler está rodando\n- Tente: `npx expo start --clear`\n\n---\n\n## 🎯 PRÓXIMOS PASSOS\n\nDepois de testar localmente:\n1. 🐛 Corrija os bugs que encontrar\n2. 🔄 Rebuilde o APK com as correções\n3. 🚀 Publique na Play Store\n\n**BOA SORTE! ME AVISA QUANDO CONSEGUIR RODAR!** 💪\n","size_bytes":4863},"lib/supabase.ts":{"content":"import 'react-native-url-polyfill/auto';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { createClient } from '@supabase/supabase-js';\nimport Constants from 'expo-constants';\n\nconst supabaseUrl = Constants.expoConfig?.extra?.supabaseUrl || process.env.EXPO_PUBLIC_SUPABASE_URL || '';\nconst supabaseAnonKey = Constants.expoConfig?.extra?.supabaseAnonKey || process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || '';\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.error('Missing Supabase credentials. Please set EXPO_PUBLIC_SUPABASE_URL and EXPO_PUBLIC_SUPABASE_ANON_KEY');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    storage: AsyncStorage,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: false,\n  },\n  global: {\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    },\n  },\n});\n","size_bytes":916},"types/auth.ts":{"content":"export type User = {\n  id: string;\n  name: string;\n  email: string;\n  avatar: string;\n  age: number;\n  weight: number;\n  height: number;\n  goal: \"hypertrophy\" | \"weight_loss\" | \"endurance\" | \"beginner\";\n  level: \"beginner\" | \"intermediate\" | \"advanced\";\n  timeAvailable: number;\n  weeklyFrequency: 2 | 3 | 4 | 5 | 6;\n  location: \"home\" | \"gym\";\n  equipment: string[];\n  academy?: {\n    id: string;\n    name: string;\n    address?: string;\n  };\n  isPremium: boolean;\n  selectedPlan?: \"ABC\" | \"ABCD\" | \"FullBody\" | \"UpperLower\";\n};\n","size_bytes":529},"BUILD_APK_GUIDE.md":{"content":"# 📱 GUIA: GERAR APK DO FITRANKPLUS\n\n## ✅ PRÉ-REQUISITOS\n\n1. **Conta Expo** (gratuita)\n   - Se não tiver, crie em: https://expo.dev/signup\n   - Anote seu email e senha\n\n2. **Acesso ao Shell do Replit**\n   - Clique no botão \"Shell\" no lado esquerdo da tela\n\n---\n\n## 🚀 PASSO A PASSO\n\n### **PASSO 1: Fazer Login no Expo**\n\nNo Shell do Replit, digite:\n\n```bash\nnpx eas-cli login\n```\n\n**O que vai acontecer:**\n- Vai pedir seu **email** → Digite o email da sua conta Expo\n- Vai pedir sua **senha** → Digite a senha (não aparece na tela, é normal)\n- Se tudo der certo, vai mostrar: \"Logged in as seuemail@exemplo.com\"\n\n---\n\n### **PASSO 2: Iniciar o Build do APK**\n\nNo Shell, digite:\n\n```bash\nnpx eas-cli build --platform android --profile preview\n```\n\n**O que vai acontecer:**\n1. O Expo vai perguntar se pode usar suas credenciais → Digite **Y** (yes)\n2. Vai começar a fazer upload do código → Aguarde (pode demorar 1-2 minutos)\n3. Vai mostrar um link para acompanhar o build\n4. O build acontece nos servidores do Expo (5-15 minutos)\n\n**IMPORTANTE:**\n- **NÃO FECHE** o terminal enquanto estiver fazendo upload\n- Depois que o upload terminar, pode fechar o terminal\n- O build continua na nuvem do Expo\n\n---\n\n### **PASSO 3: Acompanhar o Build**\n\nVocê pode acompanhar de 2 formas:\n\n**Opção A - No Terminal:**\n- Deixe o terminal aberto e aguarde\n- Vai mostrar o progresso em tempo real\n\n**Opção B - No Site (RECOMENDADO):**\n- Acesse: https://expo.dev/accounts/SEU_USERNAME/projects/fitrank-plus/builds\n- Você verá o build em andamento com progresso em %\n\n---\n\n### **PASSO 4: Baixar o APK**\n\nQuando o build terminar (15 minutos aproximadamente):\n\n1. O terminal vai mostrar um link tipo:\n   ```\n   ✅ Build successful!\n   📦 https://expo.dev/artifacts/eas/xxxxx.apk\n   ```\n\n2. **Copie esse link** e envie para o seu celular (WhatsApp, email, etc)\n\n3. **No celular:**\n   - Abra o link\n   - Baixe o arquivo `.apk`\n   - Toque no arquivo para instalar\n   - Se pedir, ative \"Instalar apps desconhecidos\" nas configurações\n\n---\n\n## ⚠️ POSSÍVEIS PROBLEMAS\n\n### **Erro: \"No project ID configured\"**\n```bash\nnpx eas-cli build:configure\n```\nDepois rode o build novamente.\n\n### **Erro: \"Build failed\"**\n- Verifique os logs no site do Expo\n- Geralmente é problema de configuração\n- Me chame que eu te ajudo!\n\n### **Celular não instala o APK**\n- Vá em: Configurações → Segurança → Instalar apps desconhecidos\n- Ative para o navegador/Chrome\n- Tente instalar novamente\n\n---\n\n## 🎯 RESUMO RÁPIDO\n\n```bash\n# 1. Login\nnpx eas-cli login\n\n# 2. Build\nnpx eas-cli build --platform android --profile preview\n\n# 3. Aguardar e baixar o APK quando terminar\n```\n\n---\n\n## 💡 DICAS\n\n- **Tempo total:** ~15-20 minutos\n- **Tamanho do APK:** ~50-80 MB\n- **Validade:** O APK não expira, você pode reinstalar quando quiser\n- **Updates:** Para atualizar o app, gere um novo APK\n\n---\n\n## 🆘 PRECISA DE AJUDA?\n\nSe tiver qualquer problema, me chame e eu te ajudo! 🚀\n\n**Boa sorte com seu primeiro APK!** 📱✨\n","size_bytes":3025},"hooks/useSupabaseAuth.ts":{"content":"import { useState, useEffect, createContext, useContext } from 'react';\nimport { Platform } from 'react-native';\nimport * as Linking from 'expo-linking';\nimport * as WebBrowser from 'expo-web-browser';\nimport { supabase } from '@/lib/supabase';\nimport { supabaseService } from '@/lib/supabase-service';\nimport type { User } from '@/types/auth';\nimport type { Session } from '@supabase/supabase-js';\n\n// Complete auth session for web (must be at module scope)\nWebBrowser.maybeCompleteAuthSession();\n\ntype AuthContextType = {\n  user: User | null;\n  isLoading: boolean;\n  session: Session | null;\n  login: (email: string, password: string) => Promise<void>;\n  signup: (email: string, password: string, name: string) => Promise<void>;\n  loginWithGoogle: () => Promise<void>;\n  logout: () => Promise<void>;\n  updateProfile: (updates: Partial<User>) => Promise<void>;\n  refreshProfile: () => Promise<void>;\n  hasCompletedOnboarding: boolean;\n  setHasCompletedOnboarding: (value: boolean) => Promise<void>;\n};\n\nexport const AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n}\n\nexport function useAuthState(): AuthContextType {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasCompletedOnboarding, setHasCompletedOnboardingState] = useState(false);\n  \n  // Guard against concurrent loadUserProfile calls\n  const loadingProfileRef = { current: false };\n\n  useEffect(() => {\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      setSession(session);\n      if (session?.user) {\n        loadUserProfile(session.user.id);\n      } else {\n        setIsLoading(false);\n      }\n    });\n\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((event, session) => {\n      setSession(session);\n      if (session?.user) {\n        loadUserProfile(session.user.id);\n      } else {\n        setUser(null);\n        setHasCompletedOnboardingState(false);\n        setIsLoading(false);\n      }\n    });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, []);\n\n  // Handle deep links for OAuth callbacks\n  useEffect(() => {\n    let isProcessing = false; // Guard against duplicate processing\n\n    const handleDeepLink = async (url: string) => {\n      if (!url || !url.includes('auth/callback') || isProcessing) {\n        return;\n      }\n\n      isProcessing = true;\n\n      try {\n        const QueryParams = await import('expo-auth-session/build/QueryParams');\n        \n        let params = QueryParams.getQueryParams(url).params;\n        \n        if ((!params.code && !params.access_token) && url.includes('#')) {\n          const fragmentUrl = url.replace('#', '?');\n          params = QueryParams.getQueryParams(fragmentUrl).params;\n        }\n\n        const { code, access_token, refresh_token, error: errorParam } = params;\n\n        if (errorParam) {\n          console.error('[Auth] Deep link error:', errorParam);\n          return;\n        }\n\n        if (code) {\n          const { data, error } = await supabase.auth.exchangeCodeForSession(code);\n          \n          if (error) {\n            console.error('[Auth] Code exchange error:', error);\n            return;\n          }\n\n          if (data.user) {\n            await loadUserProfile(data.user.id);\n          }\n        }\n        else if (access_token && refresh_token) {\n          const { error } = await supabase.auth.setSession({\n            access_token,\n            refresh_token,\n          });\n\n          if (error) {\n            console.error('[Auth] Session error:', error);\n          } else {\n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await loadUserProfile(user.id);\n            }\n          }\n        }\n      } catch (error) {\n        console.error('[Auth] Deep link handler error:', error);\n      } finally {\n        setTimeout(() => {\n          isProcessing = false;\n        }, 1000);\n      }\n    };\n\n    // Get initial URL (if app opened via deep link)\n    Linking.getInitialURL().then((url) => {\n      if (url) handleDeepLink(url);\n    });\n\n    // Listen for deep links while app is running\n    const subscription = Linking.addEventListener('url', ({ url }) => {\n      handleDeepLink(url);\n    });\n\n    return () => {\n      subscription.remove();\n    };\n  }, []);\n\n  const loadUserProfile = async (userId: string) => {\n    if (loadingProfileRef.current) {\n      return;\n    }\n    \n    loadingProfileRef.current = true;\n    \n    try {\n      let profile = await supabaseService.getProfile(userId);\n      \n      if (!profile) {\n        const { data: { user: authUser } } = await supabase.auth.getUser();\n        \n        if (authUser) {\n          const newProfile: Partial<User> = {\n            id: userId,\n            name: authUser.user_metadata?.name || authUser.user_metadata?.full_name || authUser.email?.split('@')[0] || 'Usuário',\n            email: authUser.email || '',\n            avatar: authUser.user_metadata?.avatar_url || authUser.user_metadata?.picture || '',\n            age: 0,\n            weight: 0,\n            height: 0,\n            goal: 'beginner',\n            level: 'beginner',\n            timeAvailable: 60,\n            weeklyFrequency: 3,\n            location: 'gym',\n            equipment: [],\n            isPremium: false,\n          };\n          \n          try {\n            profile = await supabaseService.createProfile(newProfile);\n          } catch (createError) {\n            console.error('[Auth] Error creating profile:', createError);\n            throw createError;\n          }\n        } else {\n          console.error('[Auth] No auth user found');\n        }\n      }\n      \n      if (profile) {\n        setUser(profile);\n        const onboardingComplete = await supabaseService.getOnboardingStatus(userId);\n        setHasCompletedOnboardingState(onboardingComplete);\n      } else {\n        console.error('[Auth] Failed to load profile');\n      }\n    } catch (error) {\n      console.error('[Auth] Error loading profile:', error);\n    } finally {\n      setIsLoading(false);\n      loadingProfileRef.current = false;\n    }\n  };\n\n  const login = async (email: string, password: string) => {\n    const { data, error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n\n    if (error) {\n      if (error.message.includes('Invalid login credentials')) {\n        throw new Error('Email ou senha incorretos');\n      }\n      throw new Error(error.message);\n    }\n\n    if (data.user) {\n      const profile = await supabaseService.getProfile(data.user.id);\n      if (profile) {\n        setUser(profile);\n      }\n    }\n  };\n\n  const signup = async (email: string, password: string, name: string) => {\n    try {\n      if (password.length < 6) {\n        throw new Error('A senha deve ter no mínimo 6 caracteres');\n      }\n\n      if (!name || name.trim().length === 0) {\n        throw new Error('Nome é obrigatório');\n      }\n\n      const { data, error } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: {\n            name: name.trim(),\n          },\n        },\n      });\n\n      if (error) {\n        if (error.message.includes('already registered')) {\n          throw new Error('Este email já está cadastrado');\n        }\n        throw new Error(error.message);\n      }\n\n      if (data.user) {\n        await supabaseService.initializeDefaultAchievements(data.user.id);\n        \n        const profile = await supabaseService.getProfile(data.user.id);\n        if (profile) {\n          setUser(profile);\n        }\n      }\n    } catch (error) {\n      console.error('Signup error:', error);\n      throw error;\n    }\n  };\n\n  const loginWithGoogle = async () => {\n    try {\n      const { makeRedirectUri } = await import('expo-auth-session');\n      \n      let redirectTo: string;\n      \n      if (Platform.OS === 'web') {\n        redirectTo = makeRedirectUri({\n          path: 'auth/callback',\n        });\n      } else {\n        redirectTo = 'fitrankplus://auth/callback';\n      }\n\n      const { data, error } = await supabase.auth.signInWithOAuth({\n        provider: 'google',\n        options: {\n          redirectTo,\n          skipBrowserRedirect: true,\n        },\n      });\n\n      if (error) {\n        console.error('[Auth] Google OAuth error:', error);\n        throw new Error(error.message);\n      }\n\n      if (!data?.url) {\n        throw new Error('No OAuth URL received');\n      }\n\n      const result = await WebBrowser.openAuthSessionAsync(\n        data.url,\n        redirectTo,\n        { showInRecents: true }\n      );\n\n      if (result.type === 'success') {\n        if (Platform.OS === 'web' && result.url) {\n          const QueryParams = await import('expo-auth-session/build/QueryParams');\n          let params = QueryParams.getQueryParams(result.url).params;\n          \n          if ((!params.code && !params.access_token) && result.url.includes('#')) {\n            const fragmentUrl = result.url.replace('#', '?');\n            params = QueryParams.getQueryParams(fragmentUrl).params;\n          }\n          \n          const { code, access_token, refresh_token } = params;\n          \n          if (code) {\n            const { data, error } = await supabase.auth.exchangeCodeForSession(code);\n            \n            if (error) {\n              console.error('[Auth] Code exchange error:', error);\n              throw new Error('Erro ao completar login com Google');\n            }\n            \n            if (data.user) {\n              await loadUserProfile(data.user.id);\n            }\n          }\n          else if (access_token && refresh_token) {\n            const { error } = await supabase.auth.setSession({\n              access_token,\n              refresh_token,\n            });\n            \n            if (error) {\n              console.error('[Auth] Session error:', error);\n              throw new Error('Erro ao completar login com Google');\n            }\n            \n            const { data: { user } } = await supabase.auth.getUser();\n            if (user) {\n              await loadUserProfile(user.id);\n            }\n          } else {\n            throw new Error('Erro ao processar autenticação');\n          }\n        }\n        return;\n      } else if (result.type === 'cancel' || result.type === 'dismiss') {\n        throw new Error('Login cancelado pelo usuário');\n      } else {\n        throw new Error('Falha no login com Google');\n      }\n    } catch (error: any) {\n      console.error('[Auth] Google login error:', error);\n      throw error;\n    }\n  };\n\n  const logout = async () => {\n    await supabase.auth.signOut();\n    setUser(null);\n    setSession(null);\n    setHasCompletedOnboardingState(false);\n  };\n\n  const updateProfile = async (updates: Partial<User>) => {\n    if (!user) return;\n    \n    const updatedUser = await supabaseService.updateProfile(user.id, updates);\n    if (updatedUser) {\n      setUser(updatedUser);\n    }\n  };\n\n  const setHasCompletedOnboarding = async (value: boolean) => {\n    if (!user) {\n      return;\n    }\n    await supabaseService.setOnboardingComplete(user.id, value);\n    setHasCompletedOnboardingState(value);\n  };\n\n  const refreshProfile = async () => {\n    if (session?.user?.id) {\n      await loadUserProfile(session.user.id);\n    }\n  };\n\n  return {\n    user,\n    isLoading,\n    session,\n    login,\n    signup,\n    loginWithGoogle,\n    logout,\n    updateProfile,\n    refreshProfile,\n    hasCompletedOnboarding,\n    setHasCompletedOnboarding,\n  };\n}\n","size_bytes":11708},"app.config.js":{"content":"module.exports = {\n  expo: {\n    name: \"FitRank+\",\n    slug: \"fitrank-plus\",\n    version: \"1.0.0\",\n    orientation: \"portrait\",\n    icon: \"./assets/images/icon.png\",\n    scheme: \"fitrankplus\",\n    userInterfaceStyle: \"dark\",\n    newArchEnabled: true,\n    extra: {\n      supabaseUrl: \"https://clwspdnaafuvjdhjhrpn.supabase.co\",\n      supabaseAnonKey: \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNsd3NwZG5hYWZ1dmpkaGpocnBuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5NDEzMTksImV4cCI6MjA3OTUxNzMxOX0.oeOPYysYYFMmcsmMt8sHiqnEejNtNZ5cJFa48fxXUFg\",\n      stripePaymentLink: \"https://buy.stripe.com/6oUfZheFY16i5XigSx3gk00\",\n      eas: {\n        projectId: \"ca78fd8c-e890-43a4-aec8-977ed3cfde09\"\n      },\n    },\n    ios: {\n      supportsTablet: true,\n      bundleIdentifier: \"com.fitrankplus.app\",\n    },\n    android: {\n      package: \"com.fitrankplus.app\",\n      adaptiveIcon: {\n        backgroundColor: \"#0D2818\",\n        foregroundImage: \"./assets/images/android-icon-foreground.png\",\n        monochromeImage: \"./assets/images/android-icon-foreground.png\",\n      },\n      edgeToEdgeEnabled: true,\n      predictiveBackGestureEnabled: false,\n    },\n    web: {\n      output: \"single\",\n      favicon: \"./assets/images/favicon.png\",\n    },\n    plugins: [\n      [\n        \"expo-splash-screen\",\n        {\n          image: \"./assets/images/splash-icon.png\",\n          imageWidth: 200,\n          resizeMode: \"contain\",\n          backgroundColor: \"#0D2818\",\n        },\n      ],\n      \"expo-web-browser\",\n    ],\n    experiments: {\n      reactCompiler: true,\n    },\n  },\n};\n","size_bytes":1577},"GOOGLE_OAUTH_MOBILE_SETUP.md":{"content":"# Configuração do Google OAuth para Mobile\n\nEste documento explica como configurar o Google OAuth para funcionar no celular com Expo + Supabase.\n\n## ⚠️ IMPORTANTE: Limitação do Expo Go\n\n**Google OAuth NÃO funciona corretamente no Expo Go** devido às seguintes limitações:\n\n1. Expo Go não permite customizar o URL scheme do app (`fitrankplus://`)\n2. Muitos provedores OAuth (incluindo Google) rejeitam URLs com scheme `exp://`\n3. Expo Go gera URLs instáveis que mudam conforme o ambiente (IP local, proxy Expo, etc.)\n\n### 🎯 Solução Recomendada: Development Build\n\nPara desenvolver e testar o Google OAuth localmente, você precisa criar um **Development Build**:\n\n```bash\n# Instalar expo-dev-client\nnpx expo install expo-dev-client\n\n# Criar build local para Android\nnpx expo run:android\n\n# Ou para iOS (requer Mac)\nnpx expo run:ios\n```\n\nO Development Build funciona igual ao Expo Go (hot reload, debugging), mas permite custom URL schemes e funciona perfeitamente com OAuth!\n\n## ✅ Código Implementado\n\nO código móvel já está implementado e pronto! Funciona em Development Builds e apps standalone.\n\n## 📋 Configuração no Supabase Dashboard\n\n### 1. Adicionar Redirect URLs\n\nVá para o **Supabase Dashboard** → Seu projeto → **Authentication** → **URL Configuration** → **Redirect URLs**\n\nAdicione a seguinte URL:\n\n```\nfitrankplus://auth/callback\n```\n\n> **Nota:** Esta URL funciona em:\n> - ✅ Development Builds (Android/iOS local)\n> - ✅ Standalone Builds (produção)\n> - ❌ Expo Go (não suportado - use Development Build)\n\n### 2. Configurar Google OAuth Provider\n\nAinda no Supabase Dashboard:\n1. Vá em **Authentication** → **Providers** → **Google**\n2. Verifique se está **Enabled**\n3. Confirme que o **Web Client ID** e **Client Secret** estão preenchidos (já configurado anteriormente)\n\n## 🧪 Como Testar\n\n### Opção 1: Development Build (Recomendado)\n\n1. **Instalar expo-dev-client** (apenas uma vez):\n   ```bash\n   npx expo install expo-dev-client\n   ```\n\n2. **Criar e rodar o build local:**\n   ```bash\n   # Para Android\n   npx expo run:android\n   \n   # Para iOS (requer Mac)\n   npx expo run:ios\n   ```\n\n3. O app abrirá no seu dispositivo/emulador conectado\n\n4. Clique em \"Entrar\" → \"Continuar com Google\"\n\n5. O navegador abrirá, faça login com sua conta Google\n\n6. Após aprovação, você será redirecionado automaticamente de volta ao app!\n\n### Opção 2: Standalone Build (Produção)\n\nPara builds de produção:\n\n```bash\n# EAS Build (recomendado)\nnpm install -g eas-cli\neas build --platform android  # ou ios\n```\n\n## 🔧 Fluxo Técnico\n\n1. Usuário clica \"Continuar com Google\"\n2. App gera redirect URI: `fitrankplus://auth/callback`\n3. Supabase retorna URL de OAuth do Google\n4. Expo Web Browser abre o navegador com a URL\n5. Usuário faz login e autoriza o app\n6. Google redireciona para Supabase: `https://[project].supabase.co/auth/v1/callback`\n7. Supabase processa e redireciona para: `fitrankplus://auth/callback?code=...`\n8. Sistema operacional abre o app com o deep link\n9. Deep link handler captura o código de autorização\n10. App troca o código por tokens usando PKCE\n11. Supabase cria sessão e carrega perfil do usuário\n12. App navega para onboarding ou tela principal\n\n## 🐛 Troubleshooting\n\n### \"Login cancelado\" ou \"Redireciona para localhost:3000\"\n**Causa:** Você está usando Expo Go, que não suporta Google OAuth\n\n**Solução:**\n1. Crie um Development Build:\n   ```bash\n   npx expo install expo-dev-client\n   npx expo run:android  # ou expo run:ios\n   ```\n2. Teste no Development Build ao invés do Expo Go\n\n### \"Redirect URL not allowed\"\n**Causa:** A URL de redirect não está na whitelist do Supabase\n\n**Solução:**\n1. Vá no Supabase Dashboard → Authentication → URL Configuration\n2. Adicione: `fitrankplus://auth/callback`\n3. Aguarde 1-2 minutos (cache do Supabase)\n\n### \"App não abre após login\"\n**Causa:** Scheme não configurado ou build incorreto\n\n**Solução:**\n1. Verifique `app.config.js` - deve ter `scheme: \"fitrankplus\"`\n2. Recrie o build: `npx expo run:android`\n\n### \"Session não atualiza\"\n**Causa:** Deep link handler não está processando\n\n**Solução:**\nVerifique os logs para ver se o callback está chegando:\n```\n[Deep Link] Received URL: fitrankplus://...\n[Deep Link] Processing callback...\n```\n\n### \"Google Login não funciona na web\"\n✅ Esperado - OAuth mobile é para dispositivos móveis. Para web, implemente separadamente.\n\n## 📱 URLs do Projeto\n\n- **Custom Scheme:** `fitrankplus://`\n- **Auth Callback:** `fitrankplus://auth/callback`\n- **Bundle ID (iOS):** `com.fitrankplus.app`\n- **Package (Android):** `com.fitrankplus.app`\n\n## ✨ Funcionalidades Implementadas\n\n- ✅ OAuth flow com expo-web-browser\n- ✅ Deep linking com expo-linking\n- ✅ Handler automático de callbacks\n- ✅ Tratamento de erros (cancel, dismiss, missing tokens)\n- ✅ Criação automática de perfil para novos usuários\n- ✅ Navegação pós-login (onboarding ou main screen)\n\n## 📚 Documentação Adicional\n\n- [Supabase Auth with Expo](https://supabase.com/docs/guides/auth/quickstarts/with-expo-react-native-social-auth)\n- [Expo Deep Linking](https://docs.expo.dev/guides/linking/)\n- [Expo Web Browser](https://docs.expo.dev/versions/latest/sdk/webbrowser/)\n","size_bytes":5278},"screens/PremiumScreen.tsx":{"content":"import { useState, useEffect, useCallback } from 'react';\nimport { StyleSheet, View, Pressable, Alert, ActivityIndicator } from 'react-native';\nimport { ScreenScrollView } from '@/components/ScreenScrollView';\nimport { ThemedText } from '@/components/ThemedText';\nimport { Colors, Spacing, BorderRadius, Typography } from '@/constants/theme';\nimport { Feather } from '@expo/vector-icons';\nimport { LinearGradient } from 'expo-linear-gradient';\nimport { useAuth } from '@/hooks/useSupabaseAuth';\nimport { useNavigation, useFocusEffect } from '@react-navigation/native';\nimport { openStripeCheckout, checkPremiumStatus } from '@/lib/stripe';\n\nconst PREMIUM_FEATURES = [\n  { icon: 'repeat' as const, title: 'Treinos Ilimitados', description: 'Gere quantos treinos quiser, sem limites' },\n  { icon: 'zap' as const, title: 'Sem Anuncios', description: 'Experiencia limpa e sem interrupcoes' },\n  { icon: 'award' as const, title: 'Treinos Avancados', description: 'Acesso a programas especializados' },\n  { icon: 'bar-chart-2' as const, title: 'Estatisticas Detalhadas', description: 'Analise completa do seu progresso' },\n  { icon: 'headphones' as const, title: 'Suporte Prioritario', description: 'Atendimento exclusivo e rapido' },\n  { icon: 'star' as const, title: 'Recursos Exclusivos', description: 'Acesso antecipado a novidades' },\n];\n\nexport default function PremiumScreen() {\n  const { user, refreshProfile } = useAuth();\n  const navigation = useNavigation();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isCheckingStatus, setIsCheckingStatus] = useState(false);\n\n  useFocusEffect(\n    useCallback(() => {\n      if (user?.id) {\n        refreshPremiumStatus();\n      }\n    }, [user?.id])\n  );\n\n  const refreshPremiumStatus = async () => {\n    if (!user?.id) return;\n    \n    setIsCheckingStatus(true);\n    try {\n      const isPremium = await checkPremiumStatus(user.id);\n      if (isPremium && !user.isPremium) {\n        await refreshProfile();\n        Alert.alert(\n          'Parabens!',\n          'Sua assinatura Premium foi ativada com sucesso!',\n          [{ text: 'OK', onPress: () => navigation.goBack() }]\n        );\n      }\n    } catch (error) {\n      console.error('Error refreshing premium status:', error);\n    } finally {\n      setIsCheckingStatus(false);\n    }\n  };\n\n  const handleSubscribe = async () => {\n    if (!user?.id || !user?.email) {\n      Alert.alert('Erro', 'Voce precisa estar logado para assinar.');\n      return;\n    }\n\n    setIsLoading(true);\n    \n    try {\n      const result = await openStripeCheckout(user.id, user.email);\n      \n      if (result.success) {\n        await refreshPremiumStatus();\n      } else if (result.error) {\n        if (result.error !== 'Pagamento cancelado') {\n          Alert.alert('Aviso', result.error);\n        }\n      }\n    } catch (error) {\n      console.error('Subscription error:', error);\n      Alert.alert('Erro', 'Nao foi possivel processar sua assinatura. Tente novamente.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleRestorePurchases = async () => {\n    if (!user?.id) {\n      Alert.alert('Erro', 'Voce precisa estar logado.');\n      return;\n    }\n\n    setIsCheckingStatus(true);\n    try {\n      const isPremium = await checkPremiumStatus(user.id);\n      if (isPremium) {\n        await refreshProfile();\n        Alert.alert('Sucesso', 'Sua assinatura Premium foi restaurada!');\n      } else {\n        Alert.alert('Nenhuma assinatura', 'Nao encontramos uma assinatura ativa para sua conta.');\n      }\n    } catch (error) {\n      Alert.alert('Erro', 'Nao foi possivel verificar sua assinatura.');\n    } finally {\n      setIsCheckingStatus(false);\n    }\n  };\n\n  if (user?.isPremium) {\n    return (\n      <ScreenScrollView contentContainerStyle={styles.content}>\n        <View style={styles.premiumActiveContainer}>\n          <LinearGradient\n            colors={[Colors.dark.primary, '#00E676']}\n            start={{ x: 0, y: 0 }}\n            end={{ x: 1, y: 1 }}\n            style={styles.premiumActiveBadge}\n          >\n            <Feather name=\"check-circle\" size={48} color={Colors.dark.backgroundRoot} />\n          </LinearGradient>\n          <ThemedText style={styles.premiumActiveTitle}>Voce ja e Premium!</ThemedText>\n          <ThemedText style={styles.premiumActiveSubtitle}>\n            Aproveite todos os beneficios exclusivos\n          </ThemedText>\n          \n          <View style={styles.activeFeaturesGrid}>\n            {PREMIUM_FEATURES.map((feature, index) => (\n              <View key={index} style={styles.activeFeatureItem}>\n                <Feather name={feature.icon} size={20} color={Colors.dark.primary} />\n                <ThemedText style={styles.activeFeatureText}>{feature.title}</ThemedText>\n              </View>\n            ))}\n          </View>\n\n          <Pressable\n            style={styles.manageButton}\n            onPress={() => Alert.alert('Gerenciar Assinatura', 'Voce pode gerenciar sua assinatura nas configuracoes do seu dispositivo.')}\n          >\n            <ThemedText style={styles.manageButtonText}>Gerenciar Assinatura</ThemedText>\n          </Pressable>\n        </View>\n      </ScreenScrollView>\n    );\n  }\n\n  return (\n    <ScreenScrollView contentContainerStyle={styles.content}>\n      <View style={styles.header}>\n        <LinearGradient\n          colors={['#FFD700', '#FFA500']}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 1 }}\n          style={styles.crownBadge}\n        >\n          <Feather name=\"award\" size={40} color={Colors.dark.backgroundRoot} />\n        </LinearGradient>\n        <ThemedText style={styles.title}>FitRank+ Premium</ThemedText>\n        <ThemedText style={styles.subtitle}>\n          Desbloqueie todo o potencial do seu treino\n        </ThemedText>\n      </View>\n\n      <View style={styles.featuresContainer}>\n        {PREMIUM_FEATURES.map((feature, index) => (\n          <View key={index} style={styles.featureCard}>\n            <View style={styles.featureIconContainer}>\n              <Feather name={feature.icon} size={24} color={Colors.dark.primary} />\n            </View>\n            <View style={styles.featureContent}>\n              <ThemedText style={styles.featureTitle}>{feature.title}</ThemedText>\n              <ThemedText style={styles.featureDescription}>{feature.description}</ThemedText>\n            </View>\n          </View>\n        ))}\n      </View>\n\n      <View style={styles.pricingCard}>\n        <View style={styles.pricingHeader}>\n          <ThemedText style={styles.pricingLabel}>Assinatura Mensal</ThemedText>\n          <View style={styles.priceContainer}>\n            <ThemedText style={styles.currency}>R$</ThemedText>\n            <ThemedText style={styles.price}>29</ThemedText>\n            <ThemedText style={styles.cents}>,90</ThemedText>\n            <ThemedText style={styles.period}>/mes</ThemedText>\n          </View>\n        </View>\n        <View style={styles.pricingBenefits}>\n          <View style={styles.benefitRow}>\n            <Feather name=\"check\" size={16} color={Colors.dark.success} />\n            <ThemedText style={styles.benefitText}>Cancele quando quiser</ThemedText>\n          </View>\n          <View style={styles.benefitRow}>\n            <Feather name=\"check\" size={16} color={Colors.dark.success} />\n            <ThemedText style={styles.benefitText}>Sem taxas ocultas</ThemedText>\n          </View>\n          <View style={styles.benefitRow}>\n            <Feather name=\"check\" size={16} color={Colors.dark.success} />\n            <ThemedText style={styles.benefitText}>Acesso imediato</ThemedText>\n          </View>\n        </View>\n      </View>\n\n      <Pressable\n        style={({ pressed }) => [\n          styles.subscribeButton,\n          pressed && styles.buttonPressed,\n          isLoading && styles.buttonDisabled,\n        ]}\n        onPress={handleSubscribe}\n        disabled={isLoading}\n      >\n        <LinearGradient\n          colors={[Colors.dark.primary, '#00E676']}\n          start={{ x: 0, y: 0 }}\n          end={{ x: 1, y: 0 }}\n          style={styles.subscribeGradient}\n        >\n          {isLoading ? (\n            <ActivityIndicator color={Colors.dark.backgroundRoot} />\n          ) : (\n            <>\n              <ThemedText style={styles.subscribeText}>Assinar Agora</ThemedText>\n              <Feather name=\"arrow-right\" size={20} color={Colors.dark.backgroundRoot} />\n            </>\n          )}\n        </LinearGradient>\n      </Pressable>\n\n      <Pressable\n        style={styles.restoreButton}\n        onPress={handleRestorePurchases}\n      >\n        <ThemedText style={styles.restoreText}>Restaurar Compras</ThemedText>\n      </Pressable>\n\n      <ThemedText style={styles.termsText}>\n        Ao assinar, voce concorda com nossos Termos de Uso e Politica de Privacidade.\n        A cobranca sera feita mensalmente ate o cancelamento.\n      </ThemedText>\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  content: {\n    padding: Spacing.lg,\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: Spacing.xl,\n  },\n  crownBadge: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.md,\n  },\n  title: {\n    ...Typography.h1,\n    color: Colors.dark.text,\n    marginBottom: Spacing.xs,\n  },\n  subtitle: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    textAlign: 'center',\n  },\n  featuresContainer: {\n    marginBottom: Spacing.xl,\n  },\n  featureCard: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.md,\n    marginBottom: Spacing.sm,\n  },\n  featureIconContainer: {\n    width: 48,\n    height: 48,\n    borderRadius: BorderRadius.md,\n    backgroundColor: Colors.dark.backgroundTertiary,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginRight: Spacing.md,\n  },\n  featureContent: {\n    flex: 1,\n  },\n  featureTitle: {\n    ...Typography.bodyLarge,\n    fontWeight: '600',\n    color: Colors.dark.text,\n    marginBottom: 2,\n  },\n  featureDescription: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n  },\n  pricingCard: {\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n    marginBottom: Spacing.lg,\n    borderWidth: 2,\n    borderColor: Colors.dark.primary,\n  },\n  pricingHeader: {\n    alignItems: 'center',\n    marginBottom: Spacing.md,\n  },\n  pricingLabel: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginBottom: Spacing.xs,\n  },\n  priceContainer: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n  },\n  currency: {\n    ...Typography.bodyLarge,\n    color: Colors.dark.text,\n    marginTop: 4,\n  },\n  price: {\n    fontSize: 48,\n    fontWeight: '700',\n    color: Colors.dark.text,\n  },\n  cents: {\n    ...Typography.bodyLarge,\n    color: Colors.dark.text,\n    marginTop: 4,\n  },\n  period: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    marginLeft: Spacing.xs,\n    alignSelf: 'flex-end',\n    marginBottom: 8,\n  },\n  pricingBenefits: {\n    borderTopWidth: 1,\n    borderTopColor: Colors.dark.border,\n    paddingTop: Spacing.md,\n  },\n  benefitRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: Spacing.xs,\n  },\n  benefitText: {\n    ...Typography.caption,\n    color: Colors.dark.textSecondary,\n    marginLeft: Spacing.sm,\n  },\n  subscribeButton: {\n    borderRadius: BorderRadius.lg,\n    overflow: 'hidden',\n    marginBottom: Spacing.md,\n  },\n  subscribeGradient: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: Spacing.md,\n    gap: Spacing.sm,\n  },\n  subscribeText: {\n    ...Typography.button,\n    fontWeight: '700',\n    color: Colors.dark.backgroundRoot,\n  },\n  buttonPressed: {\n    opacity: 0.8,\n    transform: [{ scale: 0.98 }],\n  },\n  buttonDisabled: {\n    opacity: 0.6,\n  },\n  restoreButton: {\n    alignItems: 'center',\n    paddingVertical: Spacing.md,\n  },\n  restoreText: {\n    ...Typography.caption,\n    color: Colors.dark.primary,\n  },\n  termsText: {\n    fontSize: 11,\n    color: Colors.dark.textTertiary,\n    textAlign: 'center',\n    lineHeight: 16,\n  },\n  premiumActiveContainer: {\n    alignItems: 'center',\n    paddingTop: Spacing.xl,\n  },\n  premiumActiveBadge: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    alignItems: 'center',\n    justifyContent: 'center',\n    marginBottom: Spacing.lg,\n  },\n  premiumActiveTitle: {\n    ...Typography.h2,\n    color: Colors.dark.text,\n    marginBottom: Spacing.xs,\n  },\n  premiumActiveSubtitle: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n    textAlign: 'center',\n    marginBottom: Spacing.xl,\n  },\n  activeFeaturesGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    justifyContent: 'center',\n    gap: Spacing.md,\n    marginBottom: Spacing.xl,\n  },\n  activeFeatureItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: Colors.dark.backgroundSecondary,\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    gap: Spacing.xs,\n  },\n  activeFeatureText: {\n    ...Typography.caption,\n    color: Colors.dark.text,\n  },\n  manageButton: {\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.xl,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderRadius: BorderRadius.lg,\n  },\n  manageButtonText: {\n    ...Typography.body,\n    color: Colors.dark.textSecondary,\n  },\n});\n","size_bytes":13504},"components/AdBanner.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { View, StyleSheet, Platform } from 'react-native';\nimport { ThemedText } from './ThemedText';\nimport { Colors, Spacing, BorderRadius } from '@/constants/theme';\nimport { useAuth } from '@/hooks/useSupabaseAuth';\n\ntype AdBannerProps = {\n  style?: object;\n};\n\nexport function AdBanner({ style }: AdBannerProps) {\n  const { user } = useAuth();\n  const [adLoaded, setAdLoaded] = useState(false);\n  const [adError, setAdError] = useState(false);\n\n  if (user?.isPremium) {\n    return null;\n  }\n\n  if (Platform.OS === 'web') {\n    return null;\n  }\n\n  if (adError) {\n    return null;\n  }\n\n  return (\n    <View style={[styles.container, style]}>\n      <View style={styles.adPlaceholder}>\n        <ThemedText style={styles.adText}>Ad Space</ThemedText>\n        <ThemedText style={styles.adSubtext}>Upgrade to Premium to remove ads</ThemedText>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: '100%',\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.dark.backgroundSecondary,\n    borderRadius: BorderRadius.md,\n    overflow: 'hidden',\n  },\n  adPlaceholder: {\n    width: '100%',\n    height: 60,\n    alignItems: 'center',\n    justifyContent: 'center',\n    backgroundColor: Colors.dark.backgroundTertiary,\n    borderWidth: 1,\n    borderColor: Colors.dark.border,\n    borderStyle: 'dashed',\n  },\n  adText: {\n    fontSize: 12,\n    color: Colors.dark.textTertiary,\n    fontWeight: '600',\n  },\n  adSubtext: {\n    fontSize: 10,\n    color: Colors.dark.textTertiary,\n    marginTop: 2,\n  },\n});\n","size_bytes":1608},"lib/admob.ts":{"content":"import { Platform } from 'react-native';\n\nexport type AdConfig = {\n  appId: string;\n  bannerId: string;\n  interstitialId: string;\n};\n\nconst TEST_IDS: AdConfig = {\n  appId: 'ca-app-pub-3940256099942544~3347511713',\n  bannerId: 'ca-app-pub-3940256099942544/6300978111',\n  interstitialId: 'ca-app-pub-3940256099942544/1033173712',\n};\n\nconst PRODUCTION_IDS: AdConfig = {\n  appId: 'ca-app-pub-1302202797555633~6096137070',\n  bannerId: 'ca-app-pub-1302202797555633/4926649346',\n  interstitialId: 'ca-app-pub-1302202797555633/9328928782',\n};\n\nexport const getAdConfig = (): AdConfig => {\n  if (__DEV__) {\n    return TEST_IDS;\n  }\n  return PRODUCTION_IDS;\n};\n\nexport const isAdMobAvailable = (): boolean => {\n  return Platform.OS !== 'web';\n};\n","size_bytes":736},"lib/interstitialAd.ts":{"content":"import { Platform } from 'react-native';\n\nlet interstitialReady = false;\nlet lastAdShown = 0;\nconst AD_COOLDOWN_MS = 60000;\n\nexport async function loadInterstitialAd(): Promise<void> {\n  if (Platform.OS === 'web') return;\n  \n  try {\n    interstitialReady = true;\n  } catch (error) {\n    console.error('Failed to load interstitial ad:', error);\n    interstitialReady = false;\n  }\n}\n\nexport async function showInterstitialAd(isPremium: boolean): Promise<boolean> {\n  if (isPremium) return false;\n  if (Platform.OS === 'web') return false;\n  \n  const now = Date.now();\n  if (now - lastAdShown < AD_COOLDOWN_MS) {\n    return false;\n  }\n  \n  if (!interstitialReady) {\n    await loadInterstitialAd();\n  }\n  \n  try {\n    lastAdShown = now;\n    interstitialReady = false;\n    \n    loadInterstitialAd();\n    \n    return true;\n  } catch (error) {\n    console.error('Failed to show interstitial ad:', error);\n    return false;\n  }\n}\n\nexport function isInterstitialReady(): boolean {\n  return interstitialReady;\n}\n","size_bytes":1002},"supabase/functions/stripe-webhook/index.ts":{"content":"import { serve } from \"https://deno.land/std@0.177.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.39.0\";\nimport Stripe from \"https://esm.sh/stripe@14.0.0\";\n\nconst stripe = new Stripe(Deno.env.get(\"STRIPE_SECRET_KEY\") || \"\", {\n  apiVersion: \"2023-10-16\",\n  httpClient: Stripe.createFetchHttpClient(),\n});\n\nconst supabaseUrl = Deno.env.get(\"SUPABASE_URL\") || \"\";\nconst supabaseServiceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\") || \"\";\nconst webhookSecret = Deno.env.get(\"STRIPE_WEBHOOK_SECRET\") || \"\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type, stripe-signature\",\n};\n\nserve(async (req: Request) => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n\n  try {\n    const signature = req.headers.get(\"stripe-signature\");\n    if (!signature) {\n      console.error(\"Missing stripe-signature header\");\n      return new Response(\n        JSON.stringify({ error: \"Missing stripe-signature header\" }),\n        { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    const body = await req.text();\n    \n    let event: Stripe.Event;\n    \n    if (webhookSecret) {\n      try {\n        event = await stripe.webhooks.constructEventAsync(\n          body,\n          signature,\n          webhookSecret\n        );\n      } catch (err) {\n        console.error(\"Webhook signature verification failed:\", err);\n        return new Response(\n          JSON.stringify({ error: \"Webhook signature verification failed\" }),\n          { status: 400, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n    } else {\n      console.warn(\"STRIPE_WEBHOOK_SECRET not set - skipping signature verification (NOT RECOMMENDED FOR PRODUCTION)\");\n      event = JSON.parse(body);\n    }\n\n    console.log(\"Received Stripe event:\", event.type);\n\n    if (event.type === \"checkout.session.completed\") {\n      const session = event.data.object as Stripe.Checkout.Session;\n      const userId = session.client_reference_id;\n      const customerEmail = session.customer_email || session.customer_details?.email;\n\n      console.log(\"Checkout session completed:\", {\n        sessionId: session.id,\n        userId,\n        customerEmail,\n        paymentStatus: session.payment_status,\n      });\n\n      if (!userId) {\n        console.error(\"No client_reference_id (userId) found in session\");\n        return new Response(\n          JSON.stringify({ error: \"No userId in session\", received: true }),\n          { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n\n      if (session.payment_status !== \"paid\") {\n        console.log(\"Payment not completed yet, status:\", session.payment_status);\n        return new Response(\n          JSON.stringify({ message: \"Payment pending\", received: true }),\n          { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n\n      const supabase = createClient(supabaseUrl, supabaseServiceKey);\n\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .update({\n          is_premium: true,\n          stripe_customer_id: session.customer as string,\n          premium_since: new Date().toISOString(),\n        })\n        .eq(\"id\", userId)\n        .select();\n\n      if (error) {\n        console.error(\"Failed to update user premium status:\", error);\n        return new Response(\n          JSON.stringify({ error: \"Failed to update premium status\", details: error }),\n          { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n        );\n      }\n\n      console.log(\"Successfully activated premium for user:\", userId, data);\n\n      return new Response(\n        JSON.stringify({ success: true, userId, premiumActivated: true }),\n        { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    if (event.type === \"customer.subscription.deleted\") {\n      const subscription = event.data.object as Stripe.Subscription;\n      const customerId = subscription.customer as string;\n\n      console.log(\"Subscription cancelled for customer:\", customerId);\n\n      const supabase = createClient(supabaseUrl, supabaseServiceKey);\n\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update({ is_premium: false })\n        .eq(\"stripe_customer_id\", customerId);\n\n      if (error) {\n        console.error(\"Failed to deactivate premium:\", error);\n      } else {\n        console.log(\"Premium deactivated for customer:\", customerId);\n      }\n\n      return new Response(\n        JSON.stringify({ received: true }),\n        { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n      );\n    }\n\n    return new Response(\n      JSON.stringify({ received: true, event: event.type }),\n      { status: 200, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n\n  } catch (err) {\n    console.error(\"Webhook error:\", err);\n    return new Response(\n      JSON.stringify({ error: \"Webhook handler failed\", details: String(err) }),\n      { status: 500, headers: { ...corsHeaders, \"Content-Type\": \"application/json\" } }\n    );\n  }\n});\n","size_bytes":5306},"lib/stripe.ts":{"content":"import * as WebBrowser from 'expo-web-browser';\nimport * as Linking from 'expo-linking';\nimport Constants from 'expo-constants';\nimport { supabase } from './supabase';\n\nconst STRIPE_PAYMENT_LINK = Constants.expoConfig?.extra?.stripePaymentLink || '';\n\nexport async function openStripeCheckout(userId: string, userEmail: string): Promise<{ success: boolean; error?: string }> {\n  try {\n    if (!STRIPE_PAYMENT_LINK) {\n      return { \n        success: false, \n        error: 'Link de pagamento não configurado. Configure EXPO_PUBLIC_STRIPE_PAYMENT_LINK.' \n      };\n    }\n\n    const returnUrl = Linking.createURL('premium-success');\n    \n    const checkoutUrl = new URL(STRIPE_PAYMENT_LINK);\n    checkoutUrl.searchParams.set('prefilled_email', userEmail);\n    checkoutUrl.searchParams.set('client_reference_id', userId);\n    \n    const result = await WebBrowser.openAuthSessionAsync(\n      checkoutUrl.toString(),\n      returnUrl\n    );\n\n    if (result.type === 'success') {\n      return { success: true };\n    } else if (result.type === 'cancel') {\n      return { success: false, error: 'Pagamento cancelado' };\n    }\n\n    return { success: false, error: 'Erro ao processar pagamento' };\n  } catch (error) {\n    console.error('Stripe checkout error:', error);\n    return { success: false, error: 'Erro ao abrir checkout' };\n  }\n}\n\nexport async function checkPremiumStatus(userId: string): Promise<boolean> {\n  try {\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('is_premium')\n      .eq('id', userId)\n      .single();\n\n    if (error) {\n      console.error('Error checking premium status:', error);\n      return false;\n    }\n\n    return data?.is_premium || false;\n  } catch (error) {\n    console.error('Error checking premium status:', error);\n    return false;\n  }\n}\n\nexport async function activatePremium(userId: string): Promise<boolean> {\n  try {\n    const { error } = await supabase\n      .from('profiles')\n      .update({ is_premium: true })\n      .eq('id', userId);\n\n    if (error) {\n      console.error('Error activating premium:', error);\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    console.error('Error activating premium:', error);\n    return false;\n  }\n}\n","size_bytes":2223}},"version":2}